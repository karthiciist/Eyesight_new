<!DOCTYPE html>
<html lang="en" class="js">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <link rel="stylesheet" href="C:\Users\ET437GL\Desktop\ahmed\cropperjs-master\cropperjs-master\dist\cropper.css">

  <title>Welcome to EYESIGHT</title>

  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="lib/font-awesome/css/font-awesome.css" rel="stylesheet" />
  <link href="css/style.css" rel="stylesheet">
  <!-- <link href="css/style-responsive.css" rel="stylesheet"> -->

  <style>
    #canvas {
      width: 700x;
      height: 800px;
      border: 10px solid blue;
    }

    .rectangle {
      border: 1px solid #000000;
      position: absolute;
    }

    table,
    th,
    td {
      border: solid 1px #CCC;
    }

    table {
      width: 100%;
    }

    th,
    td {
      padding: 0;
      text-align: center;
    }
  </style>

</head>

<body>
  <script src="C:\Users\ET437GL\Desktop\ahmed\cropperjs-master\cropperjs-master\dist\cropper.js"></script>
  <section id="container">

    <header class="header black-bg">
      <div class="sidebar-toggle-box">
        <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
      </div>
      <!--logo start-->
      <a href="index.html" class="logo"><b>EY<span>ESIGHT</span></b></a>
      <!--logo end-->
      <div class="top-menu">
        <ul class="nav pull-right top-menu">
          <li><a class="logout" href="/eyesight">Logout</a></li>
        </ul>
      </div>
    </header>
    <aside>
      <div id="sidebar" class="nav-collapse ">
        <ul class="sidebar-menu" id="nav-accordion">
          <li class="mt">
            <a href="dashboard.html">
              <i class="fa fa-dashboard"></i>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="ocrsolutions.html">
              <i class="fa fa-eye"></i>
              <span>OCR Solutions</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="trainedmodels.html">
              <i class="fa fa-th"></i>
              <span>Trained models</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="createmodelwithmodal.html">
              <i class="fa fa-plus-square-o"></i>
              <span>Create a model</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="modelstoretrain.html">
              <i class="fa fa-refresh"></i>
              <span>Retrain a model</span>
            </a>
          </li>
          <li class="sub-menu">
            <a class="active" href="pdfoperations.html">
              <i class="fa fa-cogs"></i>
              <span>PDF Operations</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="trainedpdfmodels.html">
              <i class="fa fa-cogs"></i>
              <span>PDF Trained models</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="helpcenter.html">
              <i class="fa fa-book"></i>
              <span>Help center</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="javascript:;">
              <i class="fa fa-cogs"></i>
              <span>Settings</span>
            </a>
          </li>
      </div>
    </aside>

    <section id="main-content">
      <section class="wrapper">
        <div class="row">
          <div class="col-lg-9 main-chart">
            <center>
              <div class="box">
                <form method="post" enctype="multipart/form-data">
                  <input type="file" name="filename[]" id="inputId" class="inputfile inputfile-6"
                    accept="application/pdf" data-multiple-caption="{count} files selected" multiple accept="image/*"
                    onchange="sendafile(this.files[0])">
                  <label for="inputId"><span></span> <strong><svg xmlns="http://www.w3.org/2000/svg" width="20"
                        height="17" viewBox="0 0 20 17">
                        <path
                          d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z" />
                      </svg> Choose a PDF&hellip;</strong></label>
                </form>
              </div>
            </center>

            <center>
              <div id="pdfnavbtns">
                <button id="btnBack" type="button" class="btn-consumenow" onclick="backpage()"
                  style="width: 50px;">Back</button>
                <button id="btnNext" type="button" class="btn-consumenow" onclick="nextpage()"
                  style="width: 50px;">Next</button>

              </div>
            </center>

            <center>
              <object id="pdfviewer" width="700px" height="800px"></object>
            </center>
            <center>
              <div id="croppertoggle">
                <img id="pdfviewercanvas" style="border: 0px solid blue"></img>
              </div>

            </center>
            <!-- <div id="imgoutput">
              <center>
                <div>
                  <img id="output" style="width: 900px; height: 900px;" src="C:\Users\ET437GL\Documents\EYESIGHT\filename.png">
                </div>
              </center>
            </div> -->
            <div style="padding-top: 10px; display: inline; margin-top: 100px;">
              <table id="myTable" style="width:100%" align="center">
                <tr>
                  <th COLSPAN="12">
                    <h3 style="margin-top: 1000px;">Results</h3>
                  </th>
                </tr>
                <tr>
                  <th>S.no</th>
                  <th>page</th>
                  <th>flavor</th>
                  <th>bglines</th>
                  <th>cuttext</th>
                  <th>superscript</th>
                  <th>smalllines</th>
                  <th>grouprow</th>
                  <th>groupcol</th>
                  <th>edgetol</th>
                  <th>tablearea</th>
                  <th>tablename</th>
                  <th></th>
                </tr>
              </table>
            </div>
          </div>



          <div class="col-lg-3 ds">

            <div>
              <div style="margin-bottom: 10px;">
                Enter pages
                <input style="float: right; width: 100px;" id="pages" value="1">
              </div>
            </div>

            <div style="margin-bottom: 10px;">
              <p>example inputs: 1,3 or 5-8 or 1-end or all</p>
            </div>

            <div style="padding-top: 30px;">
              <label for="flavor" style="margin-right: 5px;">Select flavor</label>
              <select id="flavor" style="float: right; width: 100px;" onchange="ShowHideDiv()">
                <option value="lattice">Lattice</option>
                <option value="stream">Stream</option>
              </select>
            </div>
            <div style="margin-bottom: 10px;">
              <p>Stream - tables with whitespace between cells</p>
              <p>Lattice -tables with lines between cells</p>
            </div>

            <div id="latticeoptions">
              <div style="padding-top: 30px;">
                <label for="bglines" style="margin-right: 5px;">Process background lines</label>
                <select id="bglines" style="float: right; width: 100px;">
                  <option value="True">True</option>
                  <option value="False">False</option>
                </select>
              </div>
              <div style="padding-top: 30px;">
                <label for="cuttext" style="margin-right: 5px;">Cut text</label>
                <select id="cuttext" style="float: right; width: 100px;">
                  <option value="True">True</option>
                  <option value="False">False</option>
                </select>
              </div>
              <div style="margin-top: 10px;">
                <p>Cut text along column separators</p>
              </div>
              <div style="padding-top: 30px;">
                <label for="superscript" style="margin-right: 5px;">Detect superscripts</label>
                <select id="superscript" style="float: right; width: 100px;">
                  <option value="True">True</option>
                  <option value="False">False</option>
                </select>
              </div>
              <div style="padding-top: 30px;">
                Detect small lines
                <input style="float: right; width: 100px;" id="smalllines" value="15">
              </div>
              <div style="margin-top: 10px;">
                <p>Small lines can be detected by increasing this value. Range: 15-100</p>
              </div>
            </div>


            <div id="streamoptions">
              <div style="padding-top: 10px;">
                Group into row
                <input style="float: right; width: 100px;" id="grouprows" , value="10">
              </div>
              <div style="margin-top: 10px;">
                <p>Group vertically closer text lines together into the same row. Range: 10-50</p>
              </div>
              <div style="padding-top: 10px;">
                Group into column
                <input style="float: right; width: 100px;" id="groupcolumns" , value="10">
              </div>
              <div style="margin-top: 10px;">
                <p>Group horizontally closer text lines together into the same column. Range: 10-50</p>
              </div>
              <div style="padding-top: 10px;">
                <label for="superscript" style="margin-right: 5px;">Detect superscripts</label>
                <select id="superscript" style="float: right; width: 100px;">
                  <option value="True">True</option>
                  <option value="False">False</option>
                </select>
              </div>
              <div style="padding-top: 30px;">
                <label for="cuttext" style="margin-right: 5px;">Cut text</label>
                <select id="cuttext" style="float: right; width: 100px;">
                  <option value="True">True</option>
                  <option value="False">False</option>
                </select>
              </div>
              <div style="margin-top: 10px;">
                <p>Cut text along column separators</p>
              </div>

              <div style="padding-top: 10px;">
                Text edge tolrence
                <input style="float: right; width: 100px;" id="edgetol" value="50">
              </div>
              <div style="margin-top: 10px;">
                <p>Adjust this value to cover columns far apart. Default: 50</p>
              </div>

            </div>

            <div style="padding-top: 30px;">
              <center>
                <button id="btnTableCrop" type="button" class="btn-consumenow" onclick="showimagefield()">Crop and
                  Capture
                  Tables</button>
              </center>
              <center>
                <button id="btnviewdldata" type="button" class="btn-consumenow" onclick="sendtoscan()">View and
                  Download Data</button>
              </center>
              <!-- <center>
                <button id="btnremovecropper" type="button" class="btn-consumenow" onclick="removecropper()">Remove
                  cropper</button>
              </center> -->
              <center>
                <button id="btncreatemodel" type="button" class="btn-consumenow" onclick="showmodal2()">Create
                  model</button>
              </center>
            </div>

            <div style="padding-top: 2px;">
              <table id="myTable1" style="width:100%" align="center">
                <tr>
                  <th COLSPAN="3" style="text-align:center;">
                    <h4 style="text-align:center; margin-top: 10px;">Captured tables</h4>
                  </th>
                </tr>
                <!-- <tr>
                  <th COLSPAN="3" style="text-align:center;"><button id="btnparametercapture"
                      onclick="selectocrmode('parameter')">Capture a parameter</button></th>
                </tr> -->
                <tr>
                  <th style="text-align:center;">page</th>
                  <th style="text-align:center;">Table name</th>
                  <th></th>
                </tr>

              </table>
            </div>

          </div>
        </div>
        </div>
      </section>
    </section>

    <!-- Create Model Modal -->
    <div class="modal fade" id="myModal2" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">

          <div class="modal-header" style="padding:10px 10px;">
            <button type="button" class="close" data-dismiss="modal" id="closebtn">&times;</button>
            <center>
              <h4 style="color: white;">Enter model name</h4>
            </center>
          </div>

          <div class="modal-body" style="padding:10px 50px;">
            <form role="form">
              <div class="form-group" style="margin-top: 15px;">
                <input type="text" class="form-control" id="modelname" placeholder="Enter model name">
              </div>
            </form>
            <div>
              <center><button class="btn-cardsave" id="createmodel">Create model</button></center>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- tablename Modal -->
    <div class="modal fade" id="tablenamemodal" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">

          <div class="modal-header" style="padding:10px 10px;">
            <button type="button" class="close" data-dismiss="modal" id="closebtn">&times;</button>
            <center>
              <h4 style="color: white;">Enter a name for this table</h4>
            </center>
          </div>

          <div class="modal-body" style="padding:10px 50px;">
            <form role="form">
              <div class="form-group" style="margin-top: 15px;">
                <input type="text" class="form-control" id="tablename" placeholder="Enter table name">
              </div>
            </form>
            <div>
              <center><button class="btn-cardsave" id="done">Done</button></center>
            </div>
          </div>
        </div>
      </div>
    </div>



    <script src="lib/custom-file-input.js"></script>
    <script src="http://cdn.jsdelivr.net/g/filesaver.js"></script>
    <script src="C:\Users\ET437GL\Desktop\ahmed\cropperjs-master\cropperjs-master\dist\cropper.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="lib/canvas2image.js"></script>

    <script src="lib/jquery/jquery.min.js"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js"></script>
    <script class="include" type="text/javascript" src="lib/jquery.dcjqaccordion.2.7.js"></script>
    <script src="lib/jquery.scrollTo.min.js"></script>
    <script src="lib/jquery.nicescroll.js" type="text/javascript"></script>
    <script src="lib/jquery.sparkline.js"></script>
    <!--common script for all pages-->
    <script src="lib/common-scripts.js"></script>
    <script type="text/javascript" src="lib/gritter/js/jquery.gritter.js"></script>
    <script type="text/javascript" src="lib/gritter-conf.js"></script>

    <script>

      // var cropper;
      var xaxis;
      var yaxis;
      var x2axis;
      var y2axis;

      var cropper;

      var fullwidth;
      var fullheight;

      var pagecount = 1;

      var count = 2;

      var tablelist;

      var tablename;

      // initDraw(document.getElementById('pdfviewercanvas'));

      var flavor = document.getElementById("flavor");
      var latticeoptions = document.getElementById("latticeoptions");
      var streamoptions = document.getElementById("streamoptions");

      latticeoptions.style.display = flavor.value == "lattice" ? "block" : "none";
      streamoptions.style.display = flavor.value == "stream" ? "block" : "none";

      document.getElementById("pdfnavbtns").style.display = "none";
      document.getElementById("btnTableCrop").style.display = "none";
      document.getElementById("btnviewdldata").style.display = "none";

      var filenameinserver;

      var imageview = document.getElementById('pdfviewercanvas');
      var pdfview = document.getElementById('pdfviewer');
      imageview.style.display = "none";
      pdfview.style.display = "inline";

      // document.getElementById("btnremovecropper").style.display = "none";
      document.getElementById("btncreatemodel").style.display = "none";

      // when pdf is loaded
      function sendafile(file) {
        var formdata = new FormData();
        formdata.append('file', file);

        fetch('http://localhost:3000/receiveinitialpdf', {
          // mode: 'no-cors',
          method: 'POST',
          body: formdata
        }).then(
          function (response) {
            if (response.status !== 200) {
              console.log('Looks like there was a problem. Status Code: ' + response.status);
              return;
            } else if (response.status == 200) {
              return response.text().then(function (text) {
                console.log(text);
                filenameinserver = text;
                var path = 'C:/Users/ET437GL/Documents/ASpace/updated/model_v1/model_v1/Image-Border/ImageBorder/' + text;
                document.getElementById("pdfviewer").setAttribute('data', path);
                document.getElementById("btnviewdldata").style.display = "inline";
                document.getElementById("btncreatemodel").style.display = "inline";
              });

            }
          }
        ).catch(function (err) {
          console.log('Fetch Error :-S', err);
        });
        return;
      }

      // flavors dropdown hide and show
      function ShowHideDiv() {
        var flavor = document.getElementById("flavor");
        var latticeoptions = document.getElementById("latticeoptions");
        var streamoptions = document.getElementById("streamoptions");

        latticeoptions.style.display = flavor.value == "lattice" ? "block" : "none";
        streamoptions.style.display = flavor.value == "stream" ? "block" : "none";
      }

      // View and Download Data btn clicked
      function sendtoscan() {

        var imageview = document.getElementById('pdfviewercanvas');
        filepath = "C:/Users/ET437GL/Documents/ASpace/updated/model_v1/model_v1/Image-Border/ImageBorder/eyesightpdfvision/" + filenameinserver.substr(0, filenameinserver.indexOf('.')) + "/" + pagecount + ".jpg";
        imageview.setAttribute("src", filepath);

        var pages = document.getElementById("pages").value;

        var flavor = document.getElementById("flavor");
        var bglines = document.getElementById("bglines");
        var cuttext = document.getElementById("cuttext");
        var superscript = document.getElementById("superscript");

        var flavortxt = flavor.options[flavor.selectedIndex].value;
        var bglinestxt = bglines.options[bglines.selectedIndex].value;
        var cuttexttxt = cuttext.options[cuttext.selectedIndex].value;
        var superscripttxt = superscript.options[superscript.selectedIndex].value;

        var grouprows = document.getElementById("grouprows").value;
        var groupcolumns = document.getElementById("groupcolumns").value;

        var smalllines = document.getElementById("smalllines").value;
        var edgetol = document.getElementById("edgetol").value;

        if (cropper != null) {
          tableposition = xaxis + "," + yaxis + "," + x2axis + "," + y2axis;
          showtablenamemodal(tableposition);
          // updatetable(tableposition);
          // cropper.clear();
        } else {
          tableposition = "['" + "-" + "," + "-" + "," + "-" + "," + "-" + "']";
        }

        if (pages == "") {
          alert("Please enter pages");
        } else {
          var formdata = new FormData();
          formdata.append('filename', filenameinserver);
          formdata.append('pages', pages);

          formdata.append('flavor', flavortxt);
          formdata.append('processbglines', bglinestxt);
          formdata.append('cuttext', cuttexttxt);
          formdata.append('superscripts', superscripttxt);
          formdata.append('smalllines', smalllines);
          formdata.append('edgetol', edgetol);
          formdata.append('grouprows', grouprows);
          formdata.append('groupcolumns', groupcolumns);

          formdata.append('tableposition', tableposition);

          console.log(formdata);

          fetch('http://localhost:3000/processpdf', {
            // mode: 'no-cors',
            method: 'POST',
            body: formdata
          }).then(
            function (response) {
              if (response.status !== 200) {
                console.log('Looks like there was a problem. Status Code: ' + response.status);
                return;
              } else if (response.status == 200) {
                // cropper.destroy();
                try {
                  removecropper();
                } catch (error) {
                  console.log("no cropper found");
                }

                document.getElementById("btnTableCrop").style.display = "inline";
                return response.text().then(function (text) {
                  window.open("C:/Users/ET437GL/Documents/ASpace/updated/model_v1/model_v1/Image-Border/ImageBorder/outputtables/" + filenameinserver + ".html", '_blank');
                });

              }
            }
          ).catch(function (err) {
            console.log('Fetch Error :-S', err);
          });
        }
      }

      //Crop and Capture Tables btn clicked
      function showimagefield() {
        document.getElementById("btnTableCrop").style.display = "none";
        // document.getElementById("btnremovecropper").style.display = "inline";
        document.getElementById("pdfnavbtns").style.display = "inline";
        var imageview = document.getElementById('pdfviewercanvas');
        var pdfview = document.getElementById('pdfviewer');
        imageview.style.display = "inline";
        pdfview.style.display = "none";
        filepath = "C:/Users/ET437GL/Documents/ASpace/updated/model_v1/model_v1/Image-Border/ImageBorder/eyesightpdfvision/" + filenameinserver.substr(0, filenameinserver.indexOf('.')) + "/" + pagecount + ".jpg";
        imageview.setAttribute("src", filepath);

        // var image = document.getElementById('pdfviewercanvas');
        // fullwidth = imageview.width;
        // fullheight = imageview.height;
        // console.log(fullwidth);
        // console.log(fullheight);

        updateImageDisplay("none");

      }

      function updateImageDisplay(task) {

        if (task == "destroy") {
          cropper.destroy();
        } else {
          var image = document.getElementById('pdfviewercanvas');
          fullwidth = image.width;
          fullheight = image.height;
          console.log(fullwidth);
          console.log(fullheight);

          cropper = new Cropper(image, {
            crop(event) {
              xaxis = Math.round(event.detail.x);
              yaxiscropper = Math.round(event.detail.y);
              console.log("cropper y - " + yaxiscropper);
              yaxis = Math.abs(fullheight - yaxiscropper);
              console.log("pdf y - " + yaxis);

              width = Math.round(event.detail.width);
              height = Math.round(event.detail.height);
              console.log("width" + width);
              console.log("height" + height);

              x2axis = xaxis + width;
              y2axis = Math.round(event.detail.y) + height;
              y2axis = Math.abs(fullheight - y2axis);
              console.log("pdf y2 - " + y2axis);
            }
          });
        }


      }

      function backpage() {

        if (pagecount == 1) {

        } else {
          // cropper.destroy();
          pagecount = pagecount - 1;
          var imageview = document.getElementById('pdfviewercanvas');
          filepath = "C:/Users/ET437GL/Documents/ASpace/updated/model_v1/model_v1/Image-Border/ImageBorder/eyesightpdfvision/" + filenameinserver.substr(0, filenameinserver.indexOf('.')) + "/" + pagecount + ".jpg";
          imageview.setAttribute("src", filepath);
        }

      }

      function nextpage() {
        // cropper.destroy();
        pagecount = pagecount + 1;
        var imageview = document.getElementById('pdfviewercanvas');
        filepath = "C:/Users/ET437GL/Documents/ASpace/updated/model_v1/model_v1/Image-Border/ImageBorder/eyesightpdfvision/" + filenameinserver.substr(0, filenameinserver.indexOf('.')) + "/" + pagecount + ".jpg";
        imageview.setAttribute("src", filepath);
      }

      function removecropper() {
        // cropper.clear();
        // document.getElementById("btnremovecropper").style.display = "none";
        document.getElementById("btnTableCrop").style.display = "inline";

        var node = document.getElementById('croppertoggle');
        node.innerHTML = "";

        var img = document.createElement('img');
        filepath = "C:/Users/ET437GL/Documents/ASpace/updated/model_v1/model_v1/Image-Border/ImageBorder/eyesightpdfvision/" + filenameinserver.substr(0, filenameinserver.indexOf('.')) + "/" + pagecount + ".jpg";

        img.src = filepath;
        img.id = "pdfviewercanvas";
        document.getElementById('croppertoggle').appendChild(img);

      }

      function showmodal2() {

        $("#myModal2").modal();
        document.getElementById("createmodel").onclick = function (event) {
          var modelname = $('#modelname').val();
          if (modelname == "") {
            alert("Enter a model name");
          } else if (modelname != "") {
            createmodel(modelname);
            $("#modelname").val("");
            $('#myModal2').modal('toggle');
          }
        }
      }

      function updatetable(tablearea) {

        var pages = document.getElementById("pages").value;
        var flavor = document.getElementById("flavor");
        var bglines = document.getElementById("bglines");
        var cuttext = document.getElementById("cuttext");
        var superscript = document.getElementById("superscript");

        var flavortxt = flavor.options[flavor.selectedIndex].value;
        var bglinestxt = bglines.options[bglines.selectedIndex].value;
        var cuttexttxt = cuttext.options[cuttext.selectedIndex].value;
        var superscripttxt = superscript.options[superscript.selectedIndex].value;

        var grouprows = document.getElementById("grouprows").value;
        var groupcolumns = document.getElementById("groupcolumns").value;

        var smalllines = document.getElementById("smalllines").value;
        var edgetol = document.getElementById("edgetol").value;

        var rowcount = document.getElementById("myTable").rows.length;
        var rowcount1 = document.getElementById("myTable1").rows.length;

        createnewrow(rowcount, rowcount1);

        var myTable1 = document.getElementById('myTable1');
        myTable1.rows[rowcount1].cells[0].innerHTML = pagecount;
        myTable1.rows[rowcount1].cells[1].innerHTML = tablename;
        myTable1.rows[rowcount1].cells[2].innerHTML = "<button value='X'; onclick='removeRow(this)'>X</button>";

        var myTable = document.getElementById('myTable');

        paramArr = ["sno", pages, flavortxt, bglinestxt, cuttexttxt, superscripttxt, smalllines, grouprows, groupcolumns, edgetol, tablearea, tablename];

        for (i = 1; i < 13; i++) {

          if (i == 12) {
            myTable.rows[rowcount].cells[i].innerHTML = "<button value='Remove'; onclick='removeRow(this)'>Remove</button>";
          } else {
            myTable.rows[rowcount].cells[i].innerHTML = paramArr[i];
          }

        }

        // myTable1.rows[rowcount1].cells[1].innerHTML = "Full image OCR";
        // myTable1.rows[rowcount1].cells[2].innerHTML = "<button value='X'; onclick='removeRow(this)'>X</button>";
        count = count + 1;
      }

      function createnewrow(rowcount, rowcount1) {

        var table1 = document.getElementById("myTable1");
        var row = table1.insertRow();
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);

        // var button = document.createElement('input');

        // button.setAttribute('type', 'button');
        // button.setAttribute('value', 'X');
        // button.setAttribute('onclick', 'removeRow(this)');

        // cell3.appendChild(button);

        var table = document.getElementById("myTable");
        var row = table.insertRow(rowcount);

        for (i = 1; i < 14; i++) {
          var cell = row.insertCell(i - 1);
          if (i == 11) {
            // var button = document.createElement('input');
            // button.setAttribute('type', 'button');
            // button.setAttribute('value', 'Remove');
            // button.setAttribute('onclick', 'removeRow(this)');
            // cell.appendChild(button);
          } else if (i == 1) {
            cell.innerHTML = count - 1;
          }
        }
      }

      function createmodel(modelname) {

        var rowcount = document.getElementById("myTable").rows.length;

        if (rowcount == 2) {

          var flavor = document.getElementById("flavor");
          var bglines = document.getElementById("bglines");
          var cuttext = document.getElementById("cuttext");
          var superscript = document.getElementById("superscript");

          var pages = document.getElementById("pages").value;
          var flavortxt = flavor.options[flavor.selectedIndex].value;
          var bglinestxt = bglines.options[bglines.selectedIndex].value;
          var cuttexttxt = cuttext.options[cuttext.selectedIndex].value;
          var superscripttxt = superscript.options[superscript.selectedIndex].value;
          var smalllines = document.getElementById("smalllines").value;

          var grouprows = document.getElementById("grouprows").value;
          var groupcolumns = document.getElementById("groupcolumns").value;
          var edgetol = document.getElementById("edgetol").value;

          var formdata = new FormData();

          formdata.append('modelname', modelname);
          formdata.append('pages', pages);
          formdata.append('flavortxt', flavortxt);
          formdata.append('bglinestxt', bglinestxt);
          formdata.append('cuttexttxt', cuttexttxt);
          formdata.append('superscripttxt', superscripttxt);
          formdata.append('smalllines', smalllines);
          formdata.append('grouprows', grouprows);
          formdata.append('groupcolumns', groupcolumns);
          formdata.append('edgetol', edgetol);
          formdata.append('tables', "-");

          // console.log(formdata);

          fetch('http://localhost:3000/createpdfmodel', {
            // mode: 'no-cors',
            method: 'POST',
            body: formdata
          }).then(
            function (response) {
              if (response.status !== 200) {
                console.log('Looks like there was a problem. Status Code: ' + response.status);
                return;
              } else if (response.status == 200) {
                return response.text().then(function (text) {
                  alert("model created")
                });
              }
            }
          ).catch(function (err) {
            console.log('Fetch Error :-S', err);
          });
        } else {
          // alert ("dai");
          trainmodel(modelname);

        }

      }

      function trainmodel(modelname){
        var json = [];
        var myTab = document.getElementById('myTable');
        for (i = 2; i < myTab.rows.length; i++){
          var objCells = myTab.rows.item(i).cells;
          var sno = objCells.item(0).innerHTML;
          var page = objCells.item(1).innerHTML;
          var flavor = objCells.item(2).innerHTML;
          var bglines = objCells.item(3).innerHTML;
          var cuttext = objCells.item(4).innerHTML;
          var superscript = objCells.item(5).innerHTML;
          var smalllines = objCells.item(6).innerHTML;
          var grouprow = objCells.item(7).innerHTML;
          var groupcol = objCells.item(8).innerHTML;
          var edgetol = objCells.item(9).innerHTML;
          var tablearea = objCells.item(10).innerHTML;
          var tablename = objCells.item(11).innerHTML;
       

          // builderstring = '"' + sno + '": {"xaxis":"' + xaxisl + '", "yaxis":"' + yaxisl + '", "width":"' + widthl + '", "height":"' + heightl + '", "rotate":"' + rotatel + '", "keywidth":"' + scalexl + '", "keyheight":"' + scaleyl + '", "fullwidth":"' + fullwidthl + '", "fullheight":"' + fullheightl + '", "lable":"' + labell + '", "text":"' + textl + '", "header":"' + headerl + '", "hposition":"' + hpositionl + '", "htol":"' + htoll + '", "footer":"' + footerl + '", "fposition":"' + fpositionl + '", "isthre":"' + isthre + '", "colorcut":"' + colorcut + '", "threshold":"' + threshold + '", "textnature":"' + textnature + '", "language":"' + language + '", "iskey":"' + iskey + '", "kposition":"' + kposition + '", "ktol":"' + ktol + '", "keyval":"' + keyval + '", "ftol":"' + ftoll + '", "leftindex":"' + leftindex + '", "liposition":"' + liposition + '", "litol":"' + litol + '", "kori":"' + kori + '", "koriper":"' + koriper + '"}';
          builderstring = '"' + sno + '": {"page":"' + page + '", "flavor":"' + flavor + '", "bglines":"' + bglines + '", "cuttext":"' + cuttext + '", "superscript":"' + superscript + '", "smalllines":"' + smalllines + '", "grouprow":"' + grouprow + '", "groupcol":"' + groupcol + '", "edgetol":"' + edgetol + '", "tablearea":"' + tablearea + '", "tablename":"' + tablename + '"}';
          json.push(builderstring);
          
        }
        json = json.toString();
        json = "{" + json + "}"
        console.log(json);
        loaddata(json, modelname);
      }

      function loaddata(json, modelname) {
        var xhr = new XMLHttpRequest();
        var url = "http://localhost:3000/trainpdfmodel";
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhr.setRequestHeader("modelname", modelname);
        // xhr.send(JSON.stringify(json));
        xhr.send(json);
        console.log(json);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var json = JSON.parse(xhr.responseText);
            var output = xhr.response;
            alert (output);
            // alert("Model created successfully")
            // updatemodelstable(modelname, fullheight, fullwidth, headeravailable, footeravailable, leftindavailable);
            // if (updatestatus == "done"){
            //   window.location.href = 'file:///C:/Users/ET437GL/Documents/EYESIGHT/EYESIGHT_final/ongoing/trainedmodels.html'
            // } else {
            //   alert("Cannot create model!");
            // }
            
          }
        }
      }

      function removeRow(oButton) {

        var empTab = document.getElementById('myTable');
        empTab.deleteRow((oButton.parentNode.parentNode.rowIndex));

        var empTab1 = document.getElementById('myTable1');
        empTab1.deleteRow(oButton.parentNode.parentNode.rowIndex);

        count = count - 1;
      }

      function showtablenamemodal(tableposition){
        $("#tablenamemodal").modal();
        document.getElementById("done").onclick = function (event) {
          tablename = $('#tablename').val();
          if (tablename == "") {
            alert("Enter a table name");
          } else if (tablename != "") {            
            $("#tablename").val("");
            $('#tablenamemodal').modal('toggle');
            updatetable(tableposition);
          }
        }
      }

 // function initDraw(canvas) {
      //   function setMousePosition(e) {
      //     var ev = e || window.event; //Moz || IE
      //     if (ev.pageX) { //Moz
      //       mouse.x = ev.pageX + window.pageXOffset;
      //       mouse.y = ev.pageY + window.pageYOffset;
      //     } else if (ev.clientX) { //IE
      //       mouse.x = ev.clientX + document.body.scrollLeft;
      //       mouse.y = ev.clientY + document.body.scrollTop;
      //     }
      //   };

      //   var mouse = {
      //     x: 0,
      //     y: 0,
      //     startX: 0,
      //     startY: 0
      //   };
      //   var element = null;

      //   canvas.onmousemove = function (e) {
      //     setMousePosition(e);
      //     if (element !== null) {
      //       element.style.width = Math.abs(mouse.x - mouse.startX) + 'px';
      //       element.style.height = Math.abs(mouse.y - mouse.startY) + 'px';
      //       element.style.left = (mouse.x - mouse.startX < 0) ? mouse.x + 'px' : mouse.startX + 'px';
      //       element.style.top = (mouse.y - mouse.startY < 0) ? mouse.y + 'px' : mouse.startY + 'px';
      //       element.style.borderColor = '#FF0000';
      //       element.style.borderWidth = '1px';
      //       element.style.borderStyle = 'solid';
      //     }
      //   }

      //   canvas.onclick = function (e) {
      //     if (element !== null) {
      //       element = null;
      //       canvas.style.cursor = "default";
      //       console.log("finsihed.");
      //       console.log("startX - " + mouse.x + "startY - " + mouse.y);
      //     } else {
      //       console.log("begun.");
      //       mouse.startX = mouse.x;
      //       mouse.startY = mouse.y;
      //       console.log("startX - " + mouse.startX + "startY - " + mouse.startY);
      //       element = document.createElement('div');
      //       element.className = 'rectangle';
      //       element.style.borderStyle = 'solid';
      //       element.style.borderColor = '#FF0000';
      //       element.style.borderWidth = '1px';
      //       element.style.left = mouse.x + 'px';
      //       element.style.top = mouse.y + 'px';
      //       canvas.appendChild(element)
      //       canvas.style.cursor = "crosshair";
      //     }
      //   }
      // }
    </script>

</body>

</html>