<!DOCTYPE html>
<html lang="en" class="js">

<head>
  <link rel="stylesheet" href="C:\Users\ET437GL\Desktop\ahmed\cropperjs-master\cropperjs-master\dist\cropper.css">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="Dashboard">
  <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
  <title>Welcome to EYESIGHT</title>

  <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Bootstrap core CSS -->
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!--external css-->
  <link href="lib/font-awesome/css/font-awesome.css" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="css/zabuto_calendar.css">
  <link rel="stylesheet" type="text/css" href="lib/gritter/css/jquery.gritter.css" />
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet">
  <link href="css/style-responsive.css" rel="stylesheet">
  <script src="lib/chart-master/Chart.js"></script>

  <style>
    table,
    th,
    td {
      border: solid 1px #CCC;
    }

    table {
      width: 100%;
    }

    th,
    td {
      padding: 0;
      text-align: center;
    }
  </style>
</head>

<body>

  <script src="C:\Users\ET437GL\Desktop\ahmed\cropperjs-master\cropperjs-master\dist\cropper.js"></script>
  <!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> -->
  <script src="lib/canvas2image.js"></script>

  <section id="container">

    <header class="header black-bg">
      <div class="sidebar-toggle-box">
        <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
      </div>
      <!--logo start-->
      <a href="index.html" class="logo"><b>EY<span>ESIGHT</span></b></a>
      <!--logo end-->
      <div class="top-menu">
        <ul class="nav pull-right top-menu">
          <li><a class="logout" href="/eyesight">Logout</a></li>
        </ul>
      </div>
    </header>
    <aside>
      <div id="sidebar" class="nav-collapse ">
        <ul class="sidebar-menu" id="nav-accordion">
          <li class="mt">
            <a href="dashboard.html">
              <i class="fa fa-dashboard"></i>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="ocrsolutions.html">
              <i class="fa fa-th"></i>
              <span>OCR Solutions</span>
              </a>
          </li>
          <li class="sub-menu">
            <a href="trainedmodels.html">
              <i class="fa fa-desktop"></i>
              <span>Trained models</span>
            </a>
          </li>
          <li class="sub-menu">
            <a class="active" href="createmodelwithmodal.html">
              <i class="fa fa-th"></i>
              <span>Create a model</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="modelstoretrain.html">
              <i class="fa fa-th"></i>
              <span>Retrain a model</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="pdfoperations.html">
              <i class="fa fa-cogs"></i>
              <span>PDF Operations</span>
              </a>
          </li>
          <li class="sub-menu">
            <a href="trainedpdfmodels.html">
              <i class="fa fa-cogs"></i>
              <span>PDF Trained models</span>
              </a>
          </li>
          <li class="sub-menu">
            <a href="javascript:;">
              <i class="fa fa-book"></i>
              <span>Help center</span>
            </a>
          </li>
          <li class="sub-menu">
            <a href="javascript:;">
              <i class="fa fa-cogs"></i>
              <span>Settings</span>
            </a>
          </li>
      </div>
    </aside>

    <section id="main-content">
      <section class="wrapper">
        <div class="row">
          <div class="col-lg-9 main-chart">
            <!--CUSTOM CHART START -->
            <div class="row mt">
              <!-- SERVER STATUS PANELS -->

            </div>

            <center>
              <div class="box">
                <form method="post" enctype="multipart/form-data">
                  <input type="file" name="filename[]" id="inputId" class="inputfile inputfile-6"
                    data-multiple-caption="{count} files selected" multiple accept="image/*"
                    onchange="document.getElementById('output').src = window.URL.createObjectURL(this.files[0])">
                  <label for="inputId"><span></span> <strong><svg xmlns="http://www.w3.org/2000/svg" width="20"
                        height="17" viewBox="0 0 20 17">
                        <path
                          d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z" />
                        </svg> Choose a file&hellip;</strong></label>
                </form>
              </div>
            </center>

            <script src="lib/custom-file-input.js"></script>

            <center>
              <button id="btnCrop" type="button" style="width:100px" class="btn-consumenow">Crop & Scan</button>
              <button id="btnCreateModel" type="button" style="width:100px" class="btn-consumenow"
                onclick="showmodal2()">Create model</button>
              <button id="keycapturebtn" type="button" style="width:200px; display: none;" class="btn-consumenow">Crop &
                Scan key</button>
            </center>

            <center>
              <div>
                <img id="output">
              </div>
            </center>
            <div style="padding-top: 10px; display: none; margin-top: 100px;">
              <table id="myTable" style="width:100%" align="center">
                <tr>
                  <th COLSPAN="27">
                    <h3 style="margin-top: 1000px;">Results</h3>
                  </th>
                </tr>
                <tr>
                  <th>S.no</th>
                  <th>x-axis</th>
                  <th>y-axis</th>
                  <th>width</th>
                  <th>height</th>
                  <th>rotate</th>
                  <th>scaleX</th>
                  <th>scaleY</th>
                  <th>full width</th>
                  <th>full height</th>
                  <th>Lable</th>
                  <th>Text from OCR</th>
                  <th>header</th>
                  <th>hposition</th>
                  <th>htol</th>
                  <th>footer</th>
                  <th>fposition</th>
                  <th>ftol</th>
                  <th>ThreCol</th>
                  <th>ColVal</th>
                  <th>ThreVal</th>
                  <th>Nature</th>
                  <th>Lang</th>
                  <th>Keymapped</th>
                  <th>KeyVal</th>
                  <th>KeySide</th>
                  <th>KeyTol</th>
                  <th>leftindex</th>
                  <th>liposition</th>
                  <th>litol</th>
                  <th></th>
                </tr>
              </table>
            </div>
          </div>
          <div class="col-lg-3 ds">
            <div>
              <center>
                <label for="ocrtype" style="margin-right: 5px;">Choose OCR type</label>
                <select id="ocrtype">
                  <option value="zocr">Zonal OCR</option>
                  <option value="kocr">Key based OCR</option>
                  <option value="hocr">Hybrid OCR</option>
                </select>
              </center>
            </div>

            <div style="padding-top: 2px; padding-bottom: 5px;">
              <table id="myTable2" style="width:100%" align="center">
                <tr>
                  <th COLSPAN="3" style="text-align:center;">
                    <h4 style="text-align:center; margin-top: 10px;">Captured header</h4>
                  </th>
                </tr>
                <tr>
                  <th style="text-align:center; display: table-cell;" id="btnheadcapture"><button
                      onclick="updateImageDisplayHeader('header')">Capture header</button></th>
                  <th style="text-align:center; display: none; width: 75%;" id="capturedHead">Lable</th>
                  <th style="display: none;" id="btnHeadRecap"><button
                      onclick="updateImageDisplayHeader('header')">Recapture</button></th>
                </tr>
              </table>
            </div>

            <div style="padding-top: 2px; padding-bottom: 5px;">
              <table id="myTable3" style="width:100%" align="center">
                <tr>
                  <th COLSPAN="3" style="text-align:center;">
                    <h4 style="text-align:center; margin-top: 10px;">Captured footer</h4>
                  </th>
                </tr>
                <tr>
                  <th style="text-align:center; display: table-cell;"><button id="btnfootercapture"
                      onclick="updateImageDisplayFooter('footer')">Capture footer</button></th>
                  <th style="text-align:center; display: none; width: 75%;" id="capturedFoot">Lable</th>
                  <th style="display: none;" id="btnFootRecap"><button
                      onclick="updateImageDisplayFooter('footer')">Recapture</button></th>
                </tr>
              </table>
            </div>

            <div style="padding-top: 2px; padding-bottom: 5px;">


              <table id="myTable4" style="width:100%" align="center">
                <tr>
                  <th COLSPAN="3" style="text-align:center;">
                    <h4 style="text-align:center; margin-top: 10px;">Captured left index</h4>
                  </th>
                </tr>
                <tr>
                  <th style="text-align:center; display: table-cell;"><button id="btnleftindexcapture"
                      onclick="updateImageDisplayLeftIndex('leftindex')">Capture left index</button></th>
                  <th style="text-align:center; display: none; width: 75%;" id="capturedleftindex">Lable</th>
                  <th style="display: none;" id="btnLeftIndexRecap"><button
                      onclick="updateImageDisplayLeftIndex('leftindex')">Recapture</button></th>
                </tr>
              </table>
            </div>

            <div style="padding-top: 2px;">
              <table id="myTable1" style="width:100%" align="center">
                <tr>
                  <th COLSPAN="3" style="text-align:center;">
                    <h4 style="text-align:center; margin-top: 10px;">Captured parameters</h4>
                  </th>
                </tr>
                <tr>
                  <th COLSPAN="3" style="text-align:center;"><button id="btnparametercapture"
                      onclick="updateImageDisplay('parameter')">Capture a parameter</button></th>
                </tr>
                <tr>
                  <th style="text-align:center;">Lable</th>
                  <th style="text-align:center;">Text from OCR</th>
                  <th></th>
                </tr>

              </table>
            </div>
          </div>
          <!-- /col-lg-3 -->
        </div>
        <!-- /row -->
      </section>
    </section>

    <!-- Parameter Modal -->
    <div class="modal fade" id="myModal" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">


          <div class="modal-header" style="padding:10px 10px;">
            <button type="button" class="close" data-dismiss="modal" id="closebtn">&times;</button>
            <center>
              <h4 style="color: white;">Enter below details</h4>
            </center>
          </div>


          <div class="modal-body" style="padding:10px 50px;">
            <div>
              <h5 style="font-weight: bold;">Cropped image :</h5>
            </div>
            <center>
              <div style="margin: 10px;"><img id="croppedimg" src="logo.png" style="max-width: 400px;"></div>
            </center>


            <div id="threblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
              <div class="checkbox" id="thrediv">
                <label><input type="checkbox" value="" onchange="showthreoptions(this)" id="threcheckbox" checked>Auto
                  Thresholding and Color cut</label>
              </div>
              <div id="threoptions">

                <div style="padding-left: 10px; padding-right: 10px;">
                  <input type="range" id="colorcut" name="Color cut" min="0" max="255" value="0" step="10">
                  <label for="colorcut">Color cut</label>
                </div>

                <div style="padding-left: 10px; padding-right: 10px;">
                  <input type="range" id="threshold" name="Thresholding" min="0" max="255" value="0" step="10">
                  <label for="threshold">Thresholding</label>
                </div>

                <div>
                  <center>
                    <button class="btn-keycapture" id="previewimage" onclick="getupdatedimage()" type="button">Preview
                      image</button>
                  </center>
                </div>

              </div>
            </div>




            <div>
              <h5 style="font-weight: bold; margin-top: 20px;">Text found in this image :</h5>
            </div>
            <center>
              <div style="font-weight:bolder; font-style: italic;">
                <!-- <p id="foundtxt">Extracting text...</p> -->
                <input type="text" class="form-control" id="foundtxt" placeholder="Extracting text...">
              </div>
            </center>
            <form role="form">
              <div class="form-group" style="margin-top: 15px;">
                <input type="text" class="form-control" id="labeltxt" placeholder="Enter label for this text">
              </div>

              <div>
                <label for="textnature" style="margin-right: 5px;">Select the nature of this text</label>
                <select id="textnature">
                  <option value="letter">Single letter</option>
                  <option value="word">Single word</option>
                  <option value="line">A line</option>
                  <option value="para">A Paragraph</option>
                  <option value="num">Numeric</option>
                  <option value="date">Date</option>
                </select>
              </div>

              <div>
                <label for="language" style="margin-right: 5px;">Select the language of this text</label>
                <select id="language">
                  <option value="eng">English</option>
                  <option value="spa">Spanish</option>
                  <option value="fre">French</option>
                  <option value="chi">Chinese</option>
                  <option value="ger">German</option>
                  <option value="tam">Tamil</option>
                </select>
              </div>

              <div id="keyblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
                <div class="checkbox" id="keydiv">
                  <label><input type="checkbox" value="" onchange="showkeyoptions(this)" id="keycheckbox">Map to a
                    key</label>
                </div>
                <div id="keyoptions">

                  <div style="display: table; width: 100%;">
                    <div style="display: table-cell;"><input type="text" class="form-control" id="foundkeytxt"
                        placeholder="Enter key here"></div>
                    <div style="display: table-cell;"><button class="btn-keycapture" id="capturekey"
                        onclick="closemodal()" type="button">Capture key from image</button></div>
                  </div>

                  <div id="keyfields">
                    <div>
                      <h5 style="font-weight: bold;">Cropped key image :</h5>
                    </div>
                    <center>
                      <div style="margin: 10px;"><img id="croppedkeyimg" src="" style="max-width: 300px;"></div>
                    </center>
                  </div>

                  <label for="kposition" style="margin-right: 5px; margin-left: 50px;">This text will be found at which
                    side of the key ?</label>
                  <select id="kposition">
                    <option value="top">Top</option>
                    <option value="middle">Right</option>
                    <option value="middle">Left</option>
                    <option value="bottom">Below</option>
                  </select>

                  <label for="ktol" style="margin-right: 5px; margin-left: 50px;">Select the tolerence error percentage
                    for key</label>
                  <select id="ktol">
                    <option value="10">10 %</option>
                    <option value="20">20 %</option>
                    <option value="30">30 %</option>
                    <option value="40">40 %</option>
                    <option value="50">50 %</option>
                  </select>

                </div>
              </div>
            </form>
            <div>
              <center><button class="btn-cardsave" id="savedata">Save</button></center>
            </div>

          </div>

        </div>

      </div>
    </div>

    <!-- Header Modal -->
    <div class="modal fade" id="headerModal" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">


          <div class="modal-header" style="padding:10px 10px;">
            <button type="button" class="close" data-dismiss="modal" id="headerclosebtn">&times;</button>
            <center>
              <h4 style="color: white;">Enter below details</h4>
            </center>
          </div>


          <div class="modal-body" style="padding:10px 50px;">
            <div>
              <h5 style="font-weight: bold;">Cropped image :</h5>
            </div>
            <center>
              <div style="margin: 10px;"><img id="croppedimgheader" src="logo.png" style="max-width: 400px;"></div>
            </center>


            <div id="threblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
              <div class="checkbox" id="thredivheader">
                <label><input type="checkbox" value="" onchange="showthreoptions(this)" id="threcheckboxheader"
                    checked>Auto Thresholding and Color cut</label>
              </div>
              <div id="threoptionsheader">

                <div style="padding-left: 10px; padding-right: 10px;">
                  <input type="range" id="colorcutheader" name="Color cut" min="0" max="255" value="0" step="10">
                  <label for="colorcut">Color cut</label>
                </div>

                <div style="padding-left: 10px; padding-right: 10px;">
                  <input type="range" id="thresholdheader" name="Thresholding" min="0" max="255" value="0" step="10">
                  <label for="threshold">Thresholding</label>
                </div>

                <div>
                  <center>
                    <button class="btn-keycapture" id="previewimageheader" onclick="getupdatedimageforheader()"
                      type="button">Preview image</button>
                    <!-- <button class="btn-keycapture" id="doneenhance" onclick="getupdatedimagetext()" type="button">Done</button> -->
                  </center>
                </div>

              </div>
            </div>

            <div>
              <h5 style="font-weight: bold; margin-top: 20px;">Text found in this image :</h5>
            </div>
            <center>
              <div style="font-weight:bolder; font-style: italic;">
                <!-- <p id="foundtxtheader">Extracting text...</p> -->
                <input type="text" class="form-control" id="foundtxtheader" placeholder="Extracting text...">
              </div>
            </center>

            <div style="margin-top: 20px;">
              <form role="form">
                <div id="headeroptions">
                  <label for="textnature" style="margin-right: 5px; margin-left: 50px;">Select nature of this text</label>
                  <select id="textnatureheader">
                    <option value="letter">Single letter</option>
                    <option value="word">Single word</option>
                    <option value="line">A line</option>
                    <option value="para">A Paragraph</option>
                    <option value="num">Numeric</option>
                    <option value="date">Date</option>
                  </select>
  
                  <label for="language" style="margin-right: 5px; margin-left: 50px;">Select language of this text</label>
                  <select id="languageheader">
                    <option value="eng">English</option>
                    <option value="spa">Spanish</option>
                    <option value="fre">French</option>
                    <option value="chi">Chinese</option>
                    <option value="ger">German</option>
                    <option value="tam">Tamil</option>
                  </select>
  
                  <label for="hposition" style="margin-right: 5px; margin-left: 50px;">This header text can be found at
                    which part of the image ?</label>
                  <select id="hposition">
                    <option value="top">Top</option>
                    <option value="middle">Middle</option>
                    <option value="bottom">Bottom</option>
                  </select>
  
                  <label for="htol" style="margin-right: 5px; margin-left: 50px;">Select the tolerence error
                    percentage</label>
                  <select id="htol">
                    <option value="10">10 %</option>
                    <option value="20">20 %</option>
                    <option value="30">30 %</option>
                    <option value="40">40 %</option>
                    <option value="50">50 %</option>
                  </select>
                </div>
              </form>
            </div>
            
            <div>
              <center><button class="btn-cardsave" id="savedataheader">Save</button></center>
            </div>

          </div>

        </div>

      </div>
    </div>

    <!-- Footer Modal -->
    <div class="modal fade" id="footerModal" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">


          <div class="modal-header" style="padding:10px 10px;">
            <button type="button" class="close" data-dismiss="modal" id="footerclosebtn">&times;</button>
            <center>
              <h4 style="color: white;">Enter below details</h4>
            </center>
          </div>


          <div class="modal-body" style="padding:10px 50px;">
            <div>
              <h5 style="font-weight: bold;">Cropped image :</h5>
            </div>
            <center>
              <div style="margin: 10px;"><img id="croppedimgfooter" src="logo.png" style="max-width: 400px;"></div>
            </center>


            <div id="threblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
              <div class="checkbox" id="thredivfooter">
                <label><input type="checkbox" value="" onchange="showthreoptions(this)" id="threcheckboxfooter"
                    checked>Auto Thresholding and Color cut</label>
              </div>
              <div id="threoptionsfooter">

                <div style="padding-left: 10px; padding-right: 10px;">
                  <input type="range" id="colorcutfooter" name="Color cut" min="0" max="255" value="0" step="10">
                  <label for="colorcut">Color cut</label>
                </div>

                <div style="padding-left: 10px; padding-right: 10px;">
                  <input type="range" id="thresholdfooter" name="Thresholding" min="0" max="255" value="0" step="10">
                  <label for="threshold">Thresholding</label>
                </div>

                <div>
                  <center>
                    <button class="btn-keycapture" id="previewimagefooter" onclick="getupdatedimageforfooter()"
                      type="button">Preview image</button>
                    <!-- <button class="btn-keycapture" id="doneenhance" onclick="getupdatedimagetext()" type="button">Done</button> -->
                  </center>
                </div>

              </div>
            </div>

            <div>
              <h5 style="font-weight: bold; margin-top: 20px;">Text found in this image :</h5>
            </div>
            <center>
              <div style="font-weight:bolder; font-style: italic;">
                <!-- <p id="foundtxtfooter">Extracting text...</p> -->
                <input type="text" class="form-control" id="foundtxtfooter" placeholder="Extracting text...">
              </div>
            </center>
            <div style="margin-top: 20px;">
              <form role="form">
                <div id="footeroptions">
                  <label for="textnature" style="margin-right: 5px; margin-left: 50px;">Select nature of this text</label>
                  <select id="textnaturefooter">
                    <option value="letter">Single letter</option>
                    <option value="word">Single word</option>
                    <option value="line">A line</option>
                    <option value="para">A Paragraph</option>
                    <option value="num">Numeric</option>
                    <option value="date">Date</option>
                  </select>
  
                  <label for="language" style="margin-right: 5px; margin-left: 50px;">Select language of this text</label>
                  <select id="languagefooter">
                    <option value="eng">English</option>
                    <option value="spa">Spanish</option>
                    <option value="fre">French</option>
                    <option value="chi">Chinese</option>
                    <option value="ger">German</option>
                    <option value="tam">Tamil</option>
                  </select>
  
                  <label for="fposition" style="margin-right: 5px; margin-left: 50px;">This footer text can be found at
                    which part of the image ?</label>
                  <select id="fposition">
                    <option value="top">Top</option>
                    <option value="middle">Middle</option>
                    <option value="bottom">Bottom</option>
                  </select>
  
                  <label for="ftol" style="margin-right: 5px; margin-left: 50px;">Select the tolerence error
                    percentage</label>
                  <select id="ftol">
                    <option value="10">10 %</option>
                    <option value="20">20 %</option>
                    <option value="30">30 %</option>
                    <option value="40">40 %</option>
                    <option value="50">50 %</option>
                  </select>
                </div>
              </form>
            </div>
            <div>
              <center><button class="btn-cardsave" id="savedatafooter">Save</button></center>
            </div>

          </div>

        </div>

      </div>
    </div>

    <!-- Left Index Modal -->
    <div class="modal fade" id="leftindexModal" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">


          <div class="modal-header" style="padding:10px 10px;">
            <button type="button" class="close" data-dismiss="modal" id="leftindexclosebtn">&times;</button>
            <center>
              <h4 style="color: white;">Enter below details</h4>
            </center>
          </div>


          <div class="modal-body" style="padding:10px 50px;">
            <div>
              <h5 style="font-weight: bold;">Cropped image :</h5>
            </div>
            <center>
              <div style="margin: 10px;"><img id="croppedimgleftindex" src="logo.png" style="max-width: 400px;"></div>
            </center>


            <div id="threblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
              <div class="checkbox" id="thredivleftindex">
                <label><input type="checkbox" value="" onchange="showthreoptions(this)" id="threcheckboxleftindex"
                    checked>Auto Thresholding and Color cut</label>
              </div>
              <div id="threoptionsleftindex">

                <div style="padding-left: 10px; padding-right: 10px;">
                  <input type="range" id="colorcutleftindex" name="Color cut" min="0" max="255" value="0" step="10">
                  <label for="colorcut">Color cut</label>
                </div>

                <div style="padding-left: 10px; padding-right: 10px;">
                  <input type="range" id="thresholdleftindex" name="Thresholding" min="0" max="255" value="0" step="10">
                  <label for="threshold">Thresholding</label>
                </div>

                <div>
                  <center>
                    <button class="btn-keycapture" id="previewimageleftindex" onclick="getupdatedimageforleftindex()"
                      type="button">Preview image</button>
                    <!-- <button class="btn-keycapture" id="doneenhance" onclick="getupdatedimagetext()" type="button">Done</button> -->
                  </center>
                </div>

              </div>
            </div>

            <div>
              <h5 style="font-weight: bold; margin-top: 20px;">Text found in this image :</h5>
            </div>
            <center>
              <div style="font-weight:bolder; font-style: italic;">
                <!-- <p id="foundtxtleftindex">Extracting text...</p> -->
                <input type="text" class="form-control" id="foundtxtleftindex" placeholder="Extracting text...">
              </div>
            </center>
            <div style="margin-top: 20px;">
              <form role="form">
                <div id="leftindexoptions">
                  <label for="textnature" style="margin-right: 5px; margin-left: 50px;">Select nature of this text</label>
                  <select id="textnatureleftindex">
                    <option value="letter">Single letter</option>
                    <option value="word">Single word</option>
                    <option value="line">A line</option>
                    <option value="para">A Paragraph</option>
                    <option value="num">Numeric</option>
                    <option value="date">Date</option>
                  </select>
  
                  <label for="language" style="margin-right: 5px; margin-left: 50px;">Select language of this text</label>
                  <select id="languageleftindex">
                    <option value="eng">English</option>
                    <option value="spa">Spanish</option>
                    <option value="fre">French</option>
                    <option value="chi">Chinese</option>
                    <option value="ger">German</option>
                    <option value="tam">Tamil</option>
                  </select>
  
                  <label for="liposition" style="margin-right: 5px; margin-left: 50px;">This Left index text can be found
                    at which part of the image ?</label>
                  <select id="liposition">
                    <option value="top">Top</option>
                    <option value="middle">Middle</option>
                    <option value="bottom">Bottom</option>
                  </select>
  
                  <label for="litol" style="margin-right: 5px; margin-left: 50px;">Select the tolerence error
                    percentage</label>
                  <select id="litol">
                    <option value="10">10 %</option>
                    <option value="20">20 %</option>
                    <option value="30">30 %</option>
                    <option value="40">40 %</option>
                    <option value="50">50 %</option>
                  </select>
                </div>
              </form>
            </div>
            <div>
              <center><button class="btn-cardsave" id="savedataleftindex">Save</button></center>
            </div>

          </div>

        </div>

      </div>
    </div>

    <!-- Modal2 -->
    <div class="modal fade" id="myModal2" role="dialog">
      <div class="modal-dialog">

        <!-- Modal2 content-->
        <div class="modal-content">


          <div class="modal-header" style="padding:10px 10px;">
            <button type="button" class="close" data-dismiss="modal" id="closebtn">&times;</button>
            <center>
              <h4 style="color: white;">Enter model name</h4>
            </center>
          </div>


          <div class="modal-body" style="padding:10px 50px;">

            <form role="form">
              <div class="form-group" style="margin-top: 15px;">
                <input type="text" class="form-control" id="modelname" placeholder="Enter model name">
              </div>
            </form>
            <div>
              <center><button class="btn-cardsave" id="createmodel">Create model</button></center>
            </div>

          </div>


          <!-- <div class="modal-footer">
            <button type="submit" class="btn btn-danger btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
            <p>Not a member? <a href="#">Sign Up</a></p>
            <p>Forgot <a href="#">Password?</a></p>
          </div> -->


        </div>

      </div>
    </div>

    <script src="lib/jquery/jquery.min.js"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js"></script>
    <script class="include" type="text/javascript" src="lib/jquery.dcjqaccordion.2.7.js"></script>
    <script src="lib/jquery.scrollTo.min.js"></script>
    <script src="lib/jquery.nicescroll.js" type="text/javascript"></script>
    <script src="lib/jquery.sparkline.js"></script>
    <!--common script for all pages-->
    <script src="lib/common-scripts.js"></script>
    <script type="text/javascript" src="lib/gritter/js/jquery.gritter.js"></script>
    <script type="text/javascript" src="lib/gritter-conf.js"></script>
    <!--script for this page-->
    <!-- <script src="lib/sparkline-chart.js"></script>
    <script src="lib/zabuto_calendar.js"></script> -->
    <script type="application/javascript">

      var count = 2;
      var xaxis;
      var yaxis;
      var width;
      var heigth;
      var rotate;
      var scaleX;
      var scaleY;
      var fullheight;
      var fullwidth;
      var imgfilemain;
      var cropper;
      var cropper1;
      var cropperforenhance;
      var paramcount = 1
      var headerRowId = "null";
      var footerRowId = "null";
      var leftindexRowId = "null";

      var headerxaxis = 0;
      var headeryaxis = 0;

      var leftindexxaxis = 0;
      var leftindexyaxis = 0;

      function fillkeydata(croppedkeyimg) {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'http://localhost:3000/extracttext', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedkeyimg }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            console.log(xhr.responseText);
            response = xhr.responseText;
            str = response.substring(response.indexOf("string\":"));
            str1 = str.substring(str.indexOf(":") + 3);
            str2 = str1.slice(0, -4);
            console.log(str2);
            // foundstr = str2;
            if (str2 == "") {
              // $('#foundkeytxt').text("Cannot extract text from this image");
              document.getElementById("foundkeytxt").value = "Cannot extract text from this image";
            } else {
              // $('#foundkeytxt').text(str2);
              document.getElementById("foundkeytxt").value = str2;
            }

          }
        };
      }

      function closemodal() {
        // console.log(cropperfull);
        $('#myModal').modal('hide');
        $("#keycapturebtn").css("display", "block");
        $("#btnCrop").css("display", "none");
        $("#btnCreateModel").css("display", "none");

        var image = document.getElementById('output');

        document.getElementById("keycapturebtn").onclick = function (event) {
          $("#keycapturebtn").css("display", "none");
          $("#btnCrop").css("display", "inline");
          $("#btnCreateModel").css("display", "inline");
          $('#myModal').modal('show');
          $("#keyfields").css("display", "inline");

          var keyimageData = cropper.getCroppedCanvas();
          var croppedkeyimg = keyimageData.toDataURL("image/png");
          $("#croppedkeyimg").attr("src", croppedkeyimg);
          fillkeydata(croppedkeyimg);
        }
      }

      function updateImageDisplay(indent) {

        // alert(indent);

        var image = document.getElementById('output');
        cropper = new Cropper(image, {
          crop(event) {
            xaxis = event.detail.x;
            yaxis = event.detail.y;
            width = event.detail.width;
            height = event.detail.height;
            rotate = event.detail.rotate;
            scaleX = event.detail.scaleX;
            scaleY = event.detail.scaleY;
          }
        });

        document.getElementById("btnCrop").onclick = function (event) {

          // alert("x-axis - " + xaxis + "\n" + "y-axis - " + yaxis + "\n" + "width - " + width + "\n" + "height - " + height + "\n" + "rotate - " + rotate + "\n" + "scaleX - " + scaleX + "\n" + "scaleY - " + scaleY + "\n" + "full height - " + fullheight  + "\n" + "full width - " + fullwidth);

          fullwidth = image.width;
          fullheight = image.height;
          cropperforenhance = cropper;
          // showmodal(cropper, fullheight, fullwidth);
          getcroppedpicenhanced(cropper, fullheight, fullwidth, indent);
        }

      }

      function updateImageDisplayHeader(indent) {

        // alert(indent);

        var image = document.getElementById('output');
        cropper1 = new Cropper(image, {
          crop(event) {
            xaxis = event.detail.x;
            yaxis = event.detail.y;
            width = event.detail.width;
            height = event.detail.height;
            rotate = event.detail.rotate;
            scaleX = event.detail.scaleX;
            scaleY = event.detail.scaleY;
          }
        });

        var image = document.getElementById('output');
        document.getElementById("btnCrop").onclick = function (event) {

          // alert("x-axis - " + xaxis + "\n" + "y-axis - " + yaxis + "\n" + "width - " + width + "\n" + "height - " + height + "\n" + "rotate - " + rotate + "\n" + "scaleX - " + scaleX + "\n" + "scaleY - " + scaleY + "\n" + "full height - " + fullheight  + "\n" + "full width - " + fullwidth);

          fullwidth = image.width;
          fullheight = image.height;
          getcroppedpicenhanced(cropper1, fullheight, fullwidth, "header");
        }
      }

      function updateImageDisplayFooter(indent) {

        // alert(indent);

        var image = document.getElementById('output');
        cropper2 = new Cropper(image, {
          crop(event) {
            xaxis = event.detail.x;
            yaxis = event.detail.y;
            width = event.detail.width;
            height = event.detail.height;
            rotate = event.detail.rotate;
            scaleX = event.detail.scaleX;
            scaleY = event.detail.scaleY;
          }
        });

        var image = document.getElementById('output');
        document.getElementById("btnCrop").onclick = function (event) {

          // alert("x-axis - " + xaxis + "\n" + "y-axis - " + yaxis + "\n" + "width - " + width + "\n" + "height - " + height + "\n" + "rotate - " + rotate + "\n" + "scaleX - " + scaleX + "\n" + "scaleY - " + scaleY + "\n" + "full height - " + fullheight  + "\n" + "full width - " + fullwidth);

          fullwidth = image.width;
          fullheight = image.height;
          getcroppedpicenhanced(cropper2, fullheight, fullwidth, "footer");
        }
      }

      function updateImageDisplayLeftIndex(indent) {

        // alert(indent);

        var image = document.getElementById('output');
        cropper3 = new Cropper(image, {
          crop(event) {
            xaxis = event.detail.x;
            yaxis = event.detail.y;
            width = event.detail.width;
            height = event.detail.height;
            rotate = event.detail.rotate;
            scaleX = event.detail.scaleX;
            scaleY = event.detail.scaleY;
          }
        });

        var image = document.getElementById('output');
        document.getElementById("btnCrop").onclick = function (event) {

          // alert("x-axis - " + xaxis + "\n" + "y-axis - " + yaxis + "\n" + "width - " + width + "\n" + "height - " + height + "\n" + "rotate - " + rotate + "\n" + "scaleX - " + scaleX + "\n" + "scaleY - " + scaleY + "\n" + "full height - " + fullheight  + "\n" + "full width - " + fullwidth);

          fullwidth = image.width;
          fullheight = image.height;
          getcroppedpicenhanced(cropper3, fullheight, fullwidth, "leftindex");
        }
      }

      function getcroppedpicenhanced(cropper, fullheight, fullwidth, indent) {

        var imageData = cropper.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");

        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'http://localhost:3000/processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": 125, "colorcut": 100 }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            // console.log(xhr.responseText);
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            // console.log(imagestr);
            if (indent == "header") {
              showheadermodal(imagestr, fullheight, fullwidth, cropper);
            } else if (indent == "footer") {
              showfootermodal(imagestr, fullheight, fullwidth, cropper);
            } else if (indent == "leftindex") {
              showleftindexmodal(imagestr, fullheight, fullwidth, cropper);
            } else if (indent == "parameter") {
              showmodal(imagestr, fullheight, fullwidth, cropper);
            }
          }
        };

      }

      function showheadermodal(enhancedpic, fullheight, fullwidth, cropper) {
        document.getElementById("threcheckboxheader").checked = "true";
        $("#threoptionsheader").css("display", "none");
        cropper = cropperforenhance;
        $("#headerModal").modal();
        $("headerModal").ready(function () {

          // $("#keyfields").css("display", "none");
          $("#croppedimgheader").attr("src", "data:image/jpg;base64," + enhancedpic);
          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'http://localhost:3000/extracttext', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": enhancedpic }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              console.log(xhr.responseText);
              response = xhr.responseText;
              str = response.substring(response.indexOf("string\":"));
              str1 = str.substring(str.indexOf(":") + 3);
              str2 = str1.slice(0, -4);
              console.log(str2);
              foundstr = str2;
              if (str2 == "") {
                // $('#foundtxtheader').text("Cannot extract text from this image");
                document.getElementById("foundtxtheader").value = "Cannot extract text from this image";
              } else {
                // $('#foundtxtheader').text(str2);
                document.getElementById("foundtxtheader").value = str2;
              }

            }
          };

        });

        document.getElementById("savedataheader").onclick = function (event) {
          var label = "-";
          // var foundstring = $("#foundtxtheader").html();
          var foundstring = $('#foundtxtheader').val();
          var ishead = "true";
          var isfoot = "-";
          var selhposition = "-";
          var selhtol = "-";
          var selfposition = "-";
          var selftol = "-";
          var textnature;
          var language;
          var iskey = "-";
          var keyval = "-";
          var isthre;
          var isleftindex = "-";
          var selliposition = "-";
          var sellitol = "-";
          var kposition = "-";
          var ktol = "-";

          if ($("#threcheckboxheader").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcutheader").value;
            var threshold = document.getElementById("thresholdheader").value;
          }

          textnature = $("#textnatureheader option:selected").val();
          language = $("#languageheader option:selected").val();
          selhposition = $("#hposition option:selected").val();
          selhtol = $("#htol option:selected").val();

          if (headerRowId != "null") {
            document.getElementById("myTable").deleteRow(headerRowId);
            count = count - 1;
          }

          updateTableTwo("head", cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval);
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
          $('#headerModal').modal('toggle');
          $("#btnCrop").css("display", "inline");
          $("#btnCreateModel").css("display", "inline");
          document.getElementById("threcheckboxheader").checked = "true";
          $("#threoptionsheader").css("display", "none");
          cropper1.destroy();

        }
      }

      function showfootermodal(enhancedpic, fullheight, fullwidth, cropper) {
        document.getElementById("threcheckboxfooter").checked = "true";
        $("#threoptionsfooter").css("display", "none");
        cropper = cropperforenhance;
        $("#footerModal").modal();
        $("footerModal").ready(function () {

          $("#croppedimgfooter").attr("src", "data:image/jpg;base64," + enhancedpic);
          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'http://localhost:3000/extracttext', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": enhancedpic }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              console.log(xhr.responseText);
              response = xhr.responseText;
              str = response.substring(response.indexOf("string\":"));
              str1 = str.substring(str.indexOf(":") + 3);
              str2 = str1.slice(0, -4);
              console.log(str2);
              foundstr = str2;
              if (str2 == "") {
                $('#foundtxtfooter').val("Cannot extract text from this image");
              } else {
                $('#foundtxtfooter').val(str2);
              }

            }
          };

        });

        document.getElementById("savedatafooter").onclick = function (event) {
          var label = "-";
          var foundstring = $("#foundtxtfooter").val();
          var ishead = "-";
          var isfoot = "true";
          var selhposition = "-";
          var selhtol = "-";
          var selfposition = "-";
          var selftol = "-";
          var textnature;
          var language;
          var iskey = "-";
          var keyval = "-";
          var isthre;
          var isleftindex = "-";
          var selliposition = "-";
          var sellitol = "-";
          var kposition = "-";
          var ktol = "-";

          if ($("#threcheckboxfooter").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcutfooter").value;
            var threshold = document.getElementById("thresholdfooter").value;
          }

          textnature = $("#textnaturefooter option:selected").val();
          language = $("#languagefooter option:selected").val();
          selfposition = $("#fposition option:selected").val();
          selftol = $("#ftol option:selected").val();

          // alert(headerRowId);

          if (footerRowId != "null") {
            document.getElementById("myTable").deleteRow(footerRowId);
            count = count - 1;
          }

          updateTableTwo("foot", cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval);
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
          $('#footerModal').modal('toggle');
          $("#btnCrop").css("display", "inline");
          $("#btnCreateModel").css("display", "inline");
          document.getElementById("threcheckboxfooter").checked = "true";
          $("#threoptionsfooter").css("display", "none");
          cropper2.destroy();
        }
      }

      function showleftindexmodal(enhancedpic, fullheight, fullwidth, cropper) {
        document.getElementById("threcheckboxleftindex").checked = "true";
        $("#threoptionsleftindex").css("display", "none");
        cropper = cropperforenhance;
        $("#leftindexModal").modal();
        $("leftindexModal").ready(function () {

          $("#croppedimgleftindex").attr("src", "data:image/jpg;base64," + enhancedpic);
          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'http://localhost:3000/extracttext', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": enhancedpic }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              console.log(xhr.responseText);
              response = xhr.responseText;
              str = response.substring(response.indexOf("string\":"));
              str1 = str.substring(str.indexOf(":") + 3);
              str2 = str1.slice(0, -4);
              console.log(str2);
              foundstr = str2;
              if (str2 == "") {
                $('#foundtxtleftindex').val("Cannot extract text from this image");
              } else {
                $('#foundtxtleftindex').val(str2);
              }

            }
          };

        });

        document.getElementById("savedataleftindex").onclick = function (event) {
          var label = "-";
          var foundstring = $("#foundtxtleftindex").val();
          var ishead = "-";
          var isfoot = "-";
          var selhposition = "-";
          var selhtol = "-";
          var selfposition = "-";
          var selftol = "-";
          var textnature;
          var language;
          var iskey = "-";
          var keyval = "-";
          var isthre;
          var isleftindex = "true";
          var selliposition;
          var sellitol;
          var kposition = "-";
          var ktol = "-";

          if ($("#threcheckboxleftindex").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcutleftindex").value;
            var threshold = document.getElementById("colorcutleftindex").value;
          }

          textnature = $("#textnatureleftindex option:selected").val();
          language = $("#languageleftindex option:selected").val();

          selliposition = $("#liposition option:selected").val();
          sellitol = $("#litol option:selected").val();

          if (leftindexRowId != "null") {
            document.getElementById("myTable").deleteRow(leftindexRowId);
            count = count - 1;
          }

          updateTableTwo("left", cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval);
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
          $('#leftindexModal').modal('toggle');
          $("#btnCrop").css("display", "inline");
          $("#btnCreateModel").css("display", "inline");
          document.getElementById("threcheckboxleftindex").checked = "true";
          $("#threoptionsleftindex").css("display", "none");
          cropper3.destroy();

        }
      }

      function showmodal(enhancedpic, fullheight, fullwidth, cropper) {
        // alert("here");
        document.getElementById("threcheckbox").checked = "true";
        cropper = cropperforenhance;
        $("#myModal").modal();
        $("myModal").ready(function () {

          $("#keyfields").css("display", "none");
          $("#croppedimg").attr("src", "data:image/jpg;base64," + enhancedpic);
          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'http://localhost:3000/extracttext', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": enhancedpic }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              console.log(xhr.responseText);
              response = xhr.responseText;
              str = response.substring(response.indexOf("string\":"));
              str1 = str.substring(str.indexOf(":") + 3);
              str2 = str1.slice(0, -4);
              console.log(str2);
              foundstr = str2;
              if (str2 == "") {
                $('#foundtxt').val("Cannot extract text from this image");
              } else {
                $('#foundtxt').val(str2);
              }

            }
          };

        });
        document.getElementById("savedata").onclick = function (event) {
          var label = $('#labeltxt').val();
          var foundstring = $("#foundtxt").val();
          var ishead;
          var isfoot;
          var selhposition;
          var selhtol;
          var selfposition;
          var selftol;
          var textnature;
          var language;
          var iskey;
          var isleftindex = "-";
          var selliposition = "-";
          var sellitol = "-";

          if ($("#headercheckbox").prop('checked') == true) {
            ishead = true;
            selhposition = $("#hposition option:selected").val();
            selhtol = $("#htol option:selected").val();
          }
          if ($("#footercheckbox").prop('checked') == true) {
            isfoot = true;
            selfposition = $("#fposition option:selected").val();
            selftol = $("#ftol option:selected").val();
          }

          if ($("#threcheckbox").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcut").value;
            var threshold = document.getElementById("threshold").value;
          }

          textnature = $("#textnature option:selected").val();
          language = $("#language option:selected").val();

          if ($("#keycheckbox").prop('checked') == true) {
            iskey = true;
            var keyval = $('#foundkeytxt').val();

            var kpositionDropDown = document.getElementById("kposition");
            var kposition = kpositionDropDown.options[kpositionDropDown.selectedIndex].value;

            var ktolDropDown = document.getElementById("ktol");
            var ktol = ktolDropDown.options[ktolDropDown.selectedIndex].value;
          } else {
            iskey = false;
          }

          if (label == "") {
            alert("Enter a label");
          } else if (label != "") {
            updateTable(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval);
            $('.checkbox').prop("checked", false);
            $("input:checkbox").prop("checked", false);
            $("p").text("Extracting text...");
            $("input:text").val("");
            $("#keyoptions").css("display", "none");
            $('#myModal').modal('toggle');
            $("#keycapturebtn").css("display", "none");
            $("#btnCrop").css("display", "inline");
            $("#btnCreateModel").css("display", "inline");
            document.getElementById("threcheckbox").checked = "true";
            $("#threoptions").css("display", "none");
            cropper.destroy();
          }
        }
      }

      function showmodal2() {

        $("#myModal2").modal();
        document.getElementById("createmodel").onclick = function (event) {
          var modelname = $('#modelname').val();
          if (modelname == "") {
            alert("Enter a model name");
          } else if (modelname != "") {
            createmodel(modelname);
            $("input:text").val("");
            $('#myModal2').modal('toggle');
          }
        }
      }

      function updateTable(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval) {

        var rowcount = document.getElementById("myTable").rows.length;
        var rowcount1 = document.getElementById("myTable1").rows.length;

        createnewrow(rowcount, rowcount1);

        var myTable1 = document.getElementById('myTable1');
        myTable1.rows[rowcount1].cells[0].innerHTML = label;

        var myTable = document.getElementById('myTable');

        xaxis = Math.round(xaxis);
        yaxis = Math.round(yaxis);
        width = Math.round(width);
        height = Math.round(height);

        paramArr = ["sno", xaxis, yaxis, width, height, rotate, scaleX, scaleY, fullwidth, fullheight, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval, isleftindex, selliposition, sellitol];

        for (i = 1; i < 28; i++) {
          myTable.rows[rowcount].cells[i].innerHTML = paramArr[i];
        }

        myTable1.rows[rowcount1].cells[1].innerHTML = foundstring;
        count = count + 1;
      }

      function updateTableTwo(intent, cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval) {

        if (intent == "head") {
          createNewRowTwo("head");
          $("#btnheadcapture").css("display", "none");
          $("#capturedHead").css("display", "table-cell");
          $("#btnHeadRecap").css("display", "table-cell");
          document.getElementById("capturedHead").innerHTML = foundstring;
        } else if (intent == "foot") {
          createNewRowTwo("foot");
          $("#btnfootercapture").css("display", "none");
          $("#capturedFoot").css("display", "table-cell");
          $("#btnFootRecap").css("display", "table-cell");
          document.getElementById("capturedFoot").innerHTML = foundstring;
        } else if (intent == "left") {
          createNewRowTwo("left");
          $("#btnleftindexcapture").css("display", "none");
          $("#capturedleftindex").css("display", "table-cell");
          $("#btnLeftIndexRecap").css("display", "table-cell");
          document.getElementById("capturedleftindex").innerHTML = foundstring;
        }

        var myTable = document.getElementById('myTable');

        xaxis = Math.round(xaxis);
        yaxis = Math.round(yaxis);
        width = Math.round(width);
        height = Math.round(height);

        paramArr = ["sno", xaxis, yaxis, width, height, rotate, scaleX, scaleY, fullwidth, fullheight, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval, isleftindex, selliposition, sellitol];

        for (i = 1; i < 30; i++) {
          // console.log("myTable.rows[count].cells[" + i + "].innerHTML = " + paramArr[i] + ";")
          myTable.rows[count].cells[i].innerHTML = paramArr[i];
        }

        count = count + 1;
      }

      function createNewRowTwo(intent){
        var table = document.getElementById("myTable");
        var row = table.insertRow(count);

        for (i=1;i<32;i++){
          var cell = row.insertCell(i-1);
          if (i == 31){
            var button = document.createElement('input');
            button.setAttribute('type', 'button');
            button.setAttribute('value', 'Remove');
            button.setAttribute('onclick', 'removeRow(this)');
            cell.appendChild(button);
          } else if (i == 1){
            cell.innerHTML = count - 1;
          }
        }
        if (intent == "head"){
          headerRowId = count;
        } else if (intent == "foot"){
          footerRowId = count;
        } else if (intent == "left"){
          leftindexRowId = count;
        }
      }

      function createmodel(modelname) {

        if (modelname == "") {
          alert("Please enter the model name");
        }
        else {

          var http = new XMLHttpRequest();
          var url = 'http://localhost:3000/createmodel';
          var params = 'modelname=' + modelname;
          http.open('POST', url, true);

          http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

          http.onreadystatechange = function () {
            if(http.readyState == 4 && http.status == 200) {
              if (http.status == 200){
                trainmodel(modelname);
              } else {
                alert("failed to create a model")
              }
            }
          }
          http.send(params);
        }

      }

      function trainmodel(modelname) {
        var modelname = modelname;
        var json = [];
        var myTab = document.getElementById('myTable');
        for (i = 2; i < myTab.rows.length; i++) {
          var objCells = myTab.rows.item(i).cells;
          var xaxisl = objCells.item(1).innerHTML;
          var yaxisl = objCells.item(2).innerHTML;
          var headerl = objCells.item(12).innerHTML;
          var leftindex = objCells.item(27).innerHTML;
          if (headerl == "true"){
            headerxaxis = xaxisl;
            headeryaxis = yaxisl;
          } else if (leftindex == "true") {
            leftindexxaxis = xaxisl;
            leftindexyaxis = yaxisl;
          }
        }

        for (i = 2; i < myTab.rows.length; i++){
          var objCells = myTab.rows.item(i).cells;
          var sno = objCells.item(0).innerHTML;
          var xaxisl = objCells.item(1).innerHTML;
          var yaxisl = objCells.item(2).innerHTML;
          var widthl = objCells.item(3).innerHTML;
          var heightl = objCells.item(4).innerHTML;
          var rotatel = objCells.item(5).innerHTML;
          var scalexl = objCells.item(6).innerHTML;
          var scaleyl = objCells.item(7).innerHTML;
          var fullwidthl = objCells.item(8).innerHTML;
          var fullheightl = objCells.item(9).innerHTML;
          var labell = objCells.item(10).innerHTML;
          var textl = objCells.item(11).innerHTML;
          var headerl = objCells.item(12).innerHTML;
          var hpositionl = objCells.item(13).innerHTML;
          var htoll = objCells.item(14).innerHTML;
          var footerl = objCells.item(15).innerHTML;
          var fpositionl = objCells.item(16).innerHTML;
          var ftoll = objCells.item(17).innerHTML;

          var isthre = objCells.item(18).innerHTML;
          var colorcut = objCells.item(19).innerHTML;
          var threshold = objCells.item(20).innerHTML;
          var textnature = objCells.item(21).innerHTML;
          var language = objCells.item(22).innerHTML;
          var iskey = objCells.item(23).innerHTML;
          var kposition = objCells.item(24).innerHTML;
          var ktol = objCells.item(25).innerHTML;
          var keyval = objCells.item(26).innerHTML;

          var leftindex = objCells.item(27).innerHTML;
          var liposition = objCells.item(28).innerHTML;
          var litol = objCells.item(29).innerHTML;


          if (headerl == "undefined") {
            headerl = "-";
          }
          if (hpositionl == "undefined") {
            hpositionl = "-";
          }
          if (htoll == "undefined") {
            htoll = "-";
          }
          if (footerl == "undefined") {
            footerl = "-";
          }
          if (fpositionl == "undefined") {
            fpositionl = "-";
          }
          if (ftoll == "undefined") {
            ftoll = "-";
          }
          if (kposition == "undefined") {
            kposition = "-";
          }
          if (ktol == "undefined") {
            ktol = "-";
          }
          if (keyval == "undefined") {
            keyval = "-";
          }
          
          console.log(headeryaxis);
          console.log(leftindexxaxis);

          if (headeryaxis != 0){
            if ((headerl != "true") & (footerl != "true") & (leftindex != "true")){
              console.log("first yaxis - " + yaxisl.toString());
              yaxisl = parseInt(yaxisl) - parseInt(headeryaxis);
              console.log("second yaxis - " + yaxisl.toString());
            }
          }

          if (leftindexxaxis != 0){
            if ((headerl != "true") & (footerl != "true") & (leftindex != "true")){
              console.log("second xaxis - " + xaxisl.toString());
              xaxisl = parseInt(xaxisl) - parseInt(leftindexxaxis);
              console.log("second xaxis - " + xaxisl.toString());
            }
          }

          builderstring = '"' + sno + '": {"xaxis":"' + xaxisl + '", "yaxis":"' + yaxisl + '", "width":"' + widthl + '", "height":"' + heightl + '", "rotate":"' + rotatel + '", "scalex":"' + scalexl + '", "scaley":"' + scaleyl + '", "fullwidth":"' + fullwidthl + '", "fullheight":"' + fullheightl + '", "lable":"' + labell + '", "text":"' + textl + '", "header":"' + headerl + '", "hposition":"' + hpositionl + '", "htol":"' + htoll + '", "footer":"' + footerl + '", "fposition":"' + fpositionl + '", "isthre":"' + isthre + '", "colorcut":"' + colorcut + '", "threshold":"' + threshold + '", "textnature":"' + textnature + '", "language":"' + language + '", "iskey":"' + iskey + '", "kposition":"' + kposition + '", "ktol":"' + ktol + '", "keyval":"' + keyval + '", "ftol":"' + ftoll + '", "leftindex":"' + leftindex + '", "liposition":"' + liposition + '", "litol":"' + litol + '"}';
          json.push(builderstring);
        }
        json = json.toString();
        json = "{" + json + "}"
        console.log(json);
        loaddata(json, modelname);
      }

      function loaddata(json, modelname) {
        var xhr = new XMLHttpRequest();
        var url = "http://localhost:3000/trainmodel";
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhr.setRequestHeader("modelname", modelname);
        // xhr.send(JSON.stringify(json));
        xhr.send(json);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var json = JSON.parse(xhr.responseText);
            var output = xhr.response;
            alert("Model created successfully")
            window.location.href = 'file:///C:/Users/ET437GL/Documents/EYESIGHT/EYESIGHT_final/ongoing/trainedmodels.html'
          }
        }
      }

      function createnewrow(rowcount, rowcount1) {

        var table1 = document.getElementById("myTable1");
        var row = table1.insertRow();
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);

        var button = document.createElement('input');

        button.setAttribute('type', 'button');
        button.setAttribute('value', 'X');
        button.setAttribute('onclick', 'removeRow(this)');

        cell3.appendChild(button);

        var table = document.getElementById("myTable");
        var row = table.insertRow(rowcount);

        for (i=1;i<32;i++){
          var cell = row.insertCell(i-1);
          if (i == 31){
            var button = document.createElement('input');
            button.setAttribute('type', 'button');
            button.setAttribute('value', 'Remove');
            button.setAttribute('onclick', 'removeRow(this)');
            cell.appendChild(button);
          } else if (i == 1){
            cell.innerHTML = count - 1;
          }
        }
      }

      function removeRow(oButton) {

        var empTab = document.getElementById('myTable');
        empTab.deleteRow(oButton.parentNode.parentNode.rowIndex);

        var empTab1 = document.getElementById('myTable1');
        empTab1.deleteRow(oButton.parentNode.parentNode.rowIndex);

        count = count - 1;
      }

      $(document).ready(function () {
        $("#keyoptions").css("display", "none");
        $("#threoptions").css("display", "none");
        $("#thrediv").css("display", "block");
      });

      function showkeyoptions(obj) {
        if ($(obj).is(":checked")) {
          $("#keyoptions").css("display", "inline");
        } else {
          $("#keyoptions").css("display", "none");
          $("#keydiv").css("display", "block");
        }
      }

      function showthreoptions(obj) {
        if ($(obj).is(":checked")) {
          $("#threoptions").css("display", "none");
          $("#thrediv").css("display", "block");
          $("#threoptionsheader").css("display", "none");
          $("#thredivheader").css("display", "block");
          $("#threoptionsfooter").css("display", "none");
          $("#thredivfooter").css("display", "block");
          $("#threoptionsleftindex").css("display", "none");
          $("#thredivleftindex").css("display", "block");
        } else {
          $("#threoptions").css("display", "inline");
          $("#threoptionsheader").css("display", "inline");
          $("#threoptionsfooter").css("display", "inline");
          $("#threoptionsleftindex").css("display", "inline");
        }
      }

      function getupdatedimage() {
        $('#foundtxt').val("Extracting updated text...");
        var inputthreshold = document.getElementById("colorcut").value;
        var inputcolorcut = document.getElementById("threshold").value;
        var imageData = cropperforenhance.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");
        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'http://localhost:3000/processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": inputthreshold, "colorcut": inputcolorcut }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            updatedstr = responseobj.updatedresultstring;
            $("#croppedimg").attr("src", "data:image/jpg;base64," + imagestr);
            $('#foundtxt').val(updatedstr);
          }
        };
      }

      function getupdatedimageforheader() {
        // $('#foundtxtheader').text("Extracting updated text...");
        document.getElementById("foundtxtheader").value = "Extracting updated text...";
        var inputthreshold = document.getElementById("colorcutheader").value;
        var inputcolorcut = document.getElementById("thresholdheader").value;
        var imageData = cropper1.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");

        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'http://localhost:3000/processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": inputthreshold, "colorcut": inputcolorcut }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            updatedstr = responseobj.updatedresultstring;
            $("#croppedimgheader").attr("src", "data:image/jpg;base64," + imagestr);
            // $('#foundtxtheader').text(updatedstr);
            document.getElementById("foundtxtheader").value = updatedstr;
          }
        };
      }

      function getupdatedimageforfooter() {
        $('#foundtxtfooter').val("Extracting updated text...");
        var inputthreshold = document.getElementById("colorcutfooter").value;
        var inputcolorcut = document.getElementById("thresholdfooter").value;
        var imageData = cropper2.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");

        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'http://localhost:3000/processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": inputthreshold, "colorcut": inputcolorcut }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            updatedstr = responseobj.updatedresultstring;
            $("#croppedimgfooter").attr("src", "data:image/jpg;base64," + imagestr);
            $('#foundtxtfooter').val(updatedstr);
          }
        };
      }

      function getupdatedimageforleftindex() {
        $('#foundtxtleftindex').val("Extracting updated text...");
        var inputthreshold = document.getElementById("colorcutleftindex").value;
        var inputcolorcut = document.getElementById("thresholdleftindex").value;
        var imageData = cropper3.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");
        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'http://localhost:3000/processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": inputthreshold, "colorcut": inputcolorcut }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            updatedstr = responseobj.updatedresultstring;
            $("#croppedimgleftindex").attr("src", "data:image/jpg;base64," + imagestr);
            $('#foundtxtleftindex').val(updatedstr);
          }
        };
      }

      $(function () {
        $('#closebtn').click(function () {
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
          $("#keydiv").css("display", "block");
          $("#keyoptions").css("display", "none");
          document.getElementById("threcheckbox").checked = "true";
          cropper.destroy();
        });

        $('#headerclosebtn').click(function () {
          cropper1.destroy();
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
        });

        $('#footerclosebtn').click(function () {
          cropper2.destroy();
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
        });

        $('#leftindexclosebtn').click(function () {
          cropper3.destroy();
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
        });
      });

    </script>

</body>

</html>