{% extends "layout.html" %}

{% block head %}
<link rel="stylesheet" href="static/styles/cropper.css">
<link rel="stylesheet" type="text/css" href="static/styles/zabuto_calendar.css">
<link rel="stylesheet" type="text/css" href="static/lib/gritter/css/jquery.gritter.css" />
{{ super() }}
<style>
  table,
  th,
  td {
    border: solid 1px #CCC;
  }

  table {
    width: 100%;
  }

  th,
  td {
    padding: 0;
    text-align: center;
  }
</style>
{% endblock %}

{% block body %}
<div class="row js flex-fill">
  <div class="col-lg-9 main-chart">
    <center>
      <div class="box">
        <form method="post" enctype="multipart/form-data">
          <!-- <input type="file" name="filename[]" id="inputId" class="inputfile inputfile-6"
            data-multiple-caption="{count} files selected" multiple accept="image/*"
            onchange="document.getElementById('output').src = window.URL.createObjectURL(this.files[0]), resize()"> -->
          <input type="file" name="filename[]" id="inputId" class="inputfile inputfile-6"
            data-multiple-caption="{count} files selected" multiple accept="image/*"
            onchange="sendtoinitialimageprocess(this.files[0])">
          <label for="inputId"><span></span> <strong><svg xmlns="http://www.w3.org/2000/svg" width="20" height="17"
                viewBox="0 0 20 17">
                <path
                  d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z" />
              </svg> Choose a file&hellip;</strong></label>
        </form>
      </div>
    </center>
    <script src="static/lib/custom-file-input.js"></script>

    <center style="margin-bottom: 10px;">
      <button id="btnCrop" type="button" style="width:100px" class="btn-consumenow">Crop & Scan</button>
      <button id="btnCreateModel" type="button" style="width:100px" class="btn-consumenow"
        onclick="getnewtable()">Retrain model</button>
      <button id="btnCloseCropper" type="button" style="width:100px" class="btn-consumenow"
        onclick="closecropper()">Close cropper</button>
    </center>

    <!-- <center>
      <div>
        <img id="output">
      </div>
    </center> -->
    <div>
      <div id="imgoutput" >
        <center>
          <div>
            <img id="output" style="max-width: 900px;">
          </div>
        </center>
      </div>

      <div id="imgoutput2" >
        <center>
          <div>
            <img id="output2" style="max-width: 900px;">
          </div>
        </center>
      </div>
    </div>

    <div style="padding-top: 10px; font-family: Arial, Helvetica, sans-serif; display: none;">
      <table id="myTable" style="width:100%" align="center">
        <tr>
          <th COLSPAN="30">
            <h3 style="margin-top: 1000px;">Results</h3>
          </th>
        </tr>
        <tr>
          <th>S.no</th>
          <th>x-axis</th>
          <th>y-axis</th>
          <th>width</th>
          <th>height</th>
          <th>rotate</th>
          <th>keywidth</th>
          <th>keyheight</th>
          <th>full width</th>
          <th>full height</th>
          <th>Lable</th>
          <th>Text from OCR</th>
          <th>header</th>
          <th>hposition</th>
          <th>htol</th>
          <th>footer</th>
          <th>fposition</th>
          <th>ftol</th>
          <th>ThreCol</th>
          <th>ColVal</th>
          <th>ThreVal</th>
          <th>Nature</th>
          <th>Lang</th>
          <th>Keymapped</th>
          <th>KeyVal</th>
          <th>KeySide</th>
          <th>KeyTol</th>
          <th>leftindex</th>
          <th>liposition</th>
          <th>litol</th>
          <th>kori</th>
          <th>koriper</th>
          <th>regex</th>
          <th></th>
        </tr>
      </table>
    </div>
  </div>
  <div class="col-lg-3 ds">
    <div>
      <center>
        <label for="ocrtype" style="margin-right: 5px;">Choose OCR type</label>
        <select id="ocrtype">
          <option value="zocr">Zonal OCR</option>
          <option value="kocr">Key based OCR</option>
          <option value="hocr">Hybrid OCR</option>
        </select>
      </center>
    </div>

    <div>
      <div style="display: inline-flex; margin: 3px;">
        Default Threshold
        <input style="float: right; margin-left: 100px; width: 50px;" value="100" id="defthreinput">
      </div>
      <div style="display: inline-flex; margin: 3px;">
        Default Colorcut
        <input style="float: right; margin-left: 109px; width: 50px;" value="120" id="defcolcutinput">
      </div>
      <div style="display: inline-flex; margin: 3px;">
        Dilate iterations
        <input style="float: right; margin-left: 109px; width: 50px;" value="10" id="defdilatecutinput">
      </div>
      <div style="display: inline-flex; margin: 3px;">
        Erode iterations
        <input style="float: right; margin-left: 109px; width: 50px;" value="10" id="deferodeinput">
      </div>

      <center>
        <button onclick="imageupdatebtn()" style="margin: 5px;" id="updateimgbtn">Update image</button>
      </center>

      <center>
        <div class="checkbox" id="toggleboxes">
          <label><input type="checkbox" value="" onchange="toggleboxes()" id="toggleboxescheckbox">Show detected text
            boxes</label>
        </div>
      </center>

      <div style="display: inline-flex; margin: 3px;">
        Default Eyesight range (X)
        <input style="float: right; margin-left: 55px; width: 50px;" value="30" id="defeyerangex">
      </div>
      <div style="display: inline-flex; margin: 3px;">
        Default Eyesight range (Y)
        <input style="float: right; margin-left: 55px; width: 50px;" value="30" id="defeyerangey">
      </div>
    </div>

    <div style="padding-top: 2px; padding-bottom: 5px;">
      <table id="myTable2" style="width:100%" align="center">
        <tr>
          <th COLSPAN="3" style="text-align:center;">
            <h4 style="text-align:center; margin-top: 10px;">Captured header</h4>
          </th>
        </tr>
        <tr>
          <th style="text-align:center; display: table-cell;" id="btnheadcapture"><button
              onclick="updateImageDisplayHeader('header')">Capture header</button></th>
          <th style="text-align:center; display: none; width: 85%;" id="capturedHead">Lable</th>
          <th style="display: none;" id="btnHeadRecap"><button onclick="updateImageDisplayHeader('header')"><i
                class="fa fa-refresh"></i></button></th>
        </tr>
      </table>
    </div>

    <div style="padding-top: 2px; padding-bottom: 5px;">
      <table id="myTable3" style="width:100%" align="center">
        <tr>
          <th COLSPAN="3" style="text-align:center;">
            <h4 style="text-align:center; margin-top: 10px;">Captured footer</h4>
          </th>
        </tr>
        <tr>
          <th style="text-align:center; display: table-cell;"><button id="btnfootercapture"
              onclick="updateImageDisplayFooter('footer')">Capture footer</button></th>
          <th style="text-align:center; display: none; width: 85%;" id="capturedFoot">Lable</th>
          <th style="display: none;" id="btnFootRecap"><button onclick="updateImageDisplayFooter('footer')"><i
                class="fa fa-refresh"></i></button></th>
        </tr>
      </table>
    </div>

    <div style="padding-top: 2px; padding-bottom: 5px;">


      <table id="myTable4" style="width:100%" align="center">
        <tr>
          <th COLSPAN="3" style="text-align:center;">
            <h4 style="text-align:center; margin-top: 10px;">Captured left index</h4>
          </th>
        </tr>
        <tr>
          <th style="text-align:center; display: table-cell;"><button id="btnleftindexcapture"
              onclick="updateImageDisplayLeftIndex('leftindex')">Capture left index</button></th>
          <th style="text-align:center; display: none; width: 85%;" id="capturedleftindex">Lable</th>
          <th style="display: none;" id="btnLeftIndexRecap"><button
              onclick="updateImageDisplayLeftIndex('leftindex')"><i class="fa fa-refresh"></i></button></th>
        </tr>
      </table>
    </div>

    <div style="padding-top: 2px;">
      <table id="myTable1" style="width:100%" align="center">
        <tr>
          <th COLSPAN="3" style="text-align:center;">
            <h4 style="text-align:center; margin-top: 10px;">Captured parameters</h4>
          </th>
        </tr>
        <tr>
          <th COLSPAN="3" style="text-align:center;"><button id="btnparametercapture"
              onclick="updateImageDisplay('parameter')">Capture a parameter</button></th>
        </tr>
        <tr>
          <th style="text-align:center;">Lable</th>
          <th style="text-align:center;">Text from OCR</th>
          <th></th>
        </tr>

      </table>
    </div>
  </div>
  <!-- /col-lg-3 -->
</div>

<!-- Parameter Modal -->
<div class="modal fade" id="myModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">


      <div class="modal-header" style="padding:10px 10px;">
        <button type="button" class="close" data-dismiss="modal" id="closebtn">&times;</button>
        <center>
          <h4 style="color: white;">Enter below details</h4>
        </center>
      </div>


      <div class="modal-body" style="padding:10px 50px;">
        <div>
          <h5 style="font-weight: bold;">Cropped image :</h5>
        </div>
        <center>
          <div style="margin: 10px;"><img id="croppedimg" src="static/images/logo.png" style="max-width: 400px;"></div>
        </center>


        <div id="threblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
          <div class="checkbox" id="thrediv">
            <label><input type="checkbox" value="" onchange="showthreoptions(this)" id="threcheckbox" checked>Auto
              Thresholding and Color cut</label>
          </div>
          <div id="threoptions">

            <div style="padding-left: 10px; padding-right: 10px;">
              <input type="range" id="colorcut" name="Color cut" min="0" max="255" value="0" step="10">
              <label for="colorcut">Color cut</label>
            </div>

            <div style="padding-left: 10px; padding-right: 10px;">
              <input type="range" id="threshold" name="Thresholding" min="0" max="255" value="0" step="10">
              <label for="threshold">Thresholding</label>
            </div>

            <div>
              <center>
                <button class="btn-keycapture" id="previewimage" onclick="getupdatedimage()" type="button">Preview
                  image</button>
              </center>
            </div>

          </div>
        </div>




        <div>
          <h5 style="font-weight: bold; margin-top: 20px;">Text found in this image :</h5>
        </div>
        <!-- <center>
          <div style="font-weight:bolder; font-style: italic;">
            <p id="foundtxt">Extracting text...</p>
          </div>
        </center> -->
        <center>
          <div style="font-weight:bolder; font-style: italic;">
            <!-- <p id="foundtxt">Extracting text...</p> -->
            <input type="text" class="form-control" id="foundtxt" placeholder="Extracting text...">
          </div>
        </center>
        <form role="form">
          <div class="form-group" style="margin-top: 15px;">
            <input type="text" class="form-control" id="labeltxt" placeholder="Enter label for this text">
          </div>

          <div>
            <label for="textnature" style="margin-right: 5px;">Select the nature of this text</label>
            <select id="textnature">
              <option value="letter">Single letter</option>
              <option value="word">Single word</option>
              <option value="line">A line</option>
              <option value="para">A Paragraph</option>
              <option value="num">Numeric</option>
              <option value="date">Date</option>
            </select>
          </div>

          <div>
            <label for="language" style="margin-right: 5px;">Select the language of this text</label>
            <select id="language">
              <option value="eng">English</option>
              <option value="spa">Spanish</option>
              <option value="fre">French</option>
              <option value="chi">Chinese</option>
              <option value="ger">German</option>
              <option value="tam">Tamil</option>
            </select>
          </div>

          <div id="keyblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
            <div class="checkbox" id="keydiv">
              <label><input type="checkbox" value="" onchange="showkeyoptions(this)" id="keycheckbox">Map to a
                key</label>
            </div>
            <div id="keyoptions">

              <div style="display: table; width: 100%;">
                <div style="display: table-cell;"><input type="text" class="form-control" id="foundkeytxt"
                    placeholder="Enter key here"></div>
                <div style="display: table-cell;"><button class="btn-keycapture" id="capturekey" onclick="closemodal()"
                    type="button">Capture key from image</button></div>
              </div>

              <div id="keyfields">
                <div>
                  <h5 style="font-weight: bold;">Cropped key image :</h5>
                </div>
                <center>
                  <div style="margin: 10px;"><img id="croppedkeyimg" src="" style="max-width: 300px;"></div>
                </center>
              </div>

              <label for="kposition" style="margin-right: 5px; margin-left: 50px;">This text will be found at which
                side of the key ?</label>
              <select id="kposition">
                <option value="top">Top</option>
                <option value="right">Right</option>
                <option value="left">Left</option>
                <option value="below">Below</option>
              </select>

              <label for="ktol" style="margin-right: 5px; margin-left: 50px;">Select the tolerence error percentage
                for key</label>
              <select id="ktol">
                <option value="10">10 %</option>
                <option value="20">20 %</option>
                <option value="30">30 %</option>
                <option value="40">40 %</option>
                <option value="50">50 %</option>
              </select>

            </div>
          </div>
        </form>
        <div>
          <center><button class="btn-cardsave" id="savedata">Save</button></center>
        </div>

      </div>

    </div>

  </div>
</div>

<!-- Header Modal -->
<div class="modal fade" id="headerModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">


      <div class="modal-header" style="padding:10px 10px;">
        <button type="button" class="close" data-dismiss="modal" id="headerclosebtn">&times;</button>
        <center>
          <h4 style="color: white;">Enter below details</h4>
        </center>
      </div>


      <div class="modal-body" style="padding:10px 50px;">
        <div>
          <h5 style="font-weight: bold;">Cropped image :</h5>
        </div>
        <center>
          <div style="margin: 10px;"><img id="croppedimgheader" src="static/images/logo.png" style="max-width: 400px;">
          </div>
        </center>


        <div id="threblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
          <div class="checkbox" id="thredivheader">
            <label><input type="checkbox" value="" onchange="showthreoptions(this)" id="threcheckboxheader" checked>Auto
              Thresholding and Color cut</label>
          </div>
          <div id="threoptionsheader">

            <div style="padding-left: 10px; padding-right: 10px;">
              <input type="range" id="colorcutheader" name="Color cut" min="0" max="255" value="0" step="10">
              <label for="colorcut">Color cut</label>
            </div>

            <div style="padding-left: 10px; padding-right: 10px;">
              <input type="range" id="thresholdheader" name="Thresholding" min="0" max="255" value="0" step="10">
              <label for="threshold">Thresholding</label>
            </div>

            <div>
              <center>
                <button class="btn-keycapture" id="previewimageheader" onclick="getupdatedimageforheader()"
                  type="button">Preview image</button>
              </center>
            </div>

          </div>
        </div>

        <div>
          <h5 style="font-weight: bold; margin-top: 20px;">Text found in this image :</h5>
        </div>
        <!-- <center>
          <div style="font-weight:bolder; font-style: italic;">
            <p id="foundtxtheader">Extracting text...</p>
          </div>
        </center> -->
        <center>
          <div style="font-weight:bolder; font-style: italic;">
            <!-- <p id="foundtxtheader">Extracting text...</p> -->
            <input type="text" class="form-control" id="foundtxtheader" placeholder="Extracting text...">
          </div>
        </center>
        <form role="form">
          <div>

          </div>

          <div>

          </div>

          <div id="headeroptions">
            <label for="textnature" style="margin-right: 5px; margin-left: 50px;">Select nature of this text</label>
            <select id="textnatureheader">
              <option value="letter">Single letter</option>
              <option value="word">Single word</option>
              <option value="line">A line</option>
              <option value="para">A Paragraph</option>
              <option value="num">Numeric</option>
              <option value="date">Date</option>
            </select>

            <label for="language" style="margin-right: 5px; margin-left: 50px;">Select language of this text</label>
            <select id="languageheader">
              <option value="eng">English</option>
              <option value="spa">Spanish</option>
              <option value="fre">French</option>
              <option value="chi">Chinese</option>
              <option value="ger">German</option>
              <option value="tam">Tamil</option>
            </select>

            <label for="hposition" style="margin-right: 5px; margin-left: 50px;">This header text can be found at
              which part of the image ?</label>
            <select id="hposition">
              <option value="top">Top</option>
              <option value="middle">Middle</option>
              <option value="bottom">Bottom</option>
            </select>

            <label for="htol" style="margin-right: 5px; margin-left: 50px;">Select the tolerence error
              percentage</label>
            <select id="htol">
              <option value="10">10 %</option>
              <option value="20">20 %</option>
              <option value="30">30 %</option>
              <option value="40">40 %</option>
              <option value="50">50 %</option>
            </select>
          </div>
        </form>
        <div>
          <center><button class="btn-cardsave" id="savedataheader">Save</button></center>
        </div>

      </div>

    </div>

  </div>
</div>

<!-- Footer Modal -->
<div class="modal fade" id="footerModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">


      <div class="modal-header" style="padding:10px 10px;">
        <button type="button" class="close" data-dismiss="modal" id="footerclosebtn">&times;</button>
        <center>
          <h4 style="color: white;">Enter below details</h4>
        </center>
      </div>


      <div class="modal-body" style="padding:10px 50px;">
        <div>
          <h5 style="font-weight: bold;">Cropped image :</h5>
        </div>
        <center>
          <div style="margin: 10px;"><img id="croppedimgfooter" src="static/images/logo.png" style="max-width: 400px;">
          </div>
        </center>


        <div id="threblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
          <div class="checkbox" id="thredivfooter">
            <label><input type="checkbox" value="" onchange="showthreoptions(this)" id="threcheckboxfooter" checked>Auto
              Thresholding and Color cut</label>
          </div>
          <div id="threoptionsfooter">

            <div style="padding-left: 10px; padding-right: 10px;">
              <input type="range" id="colorcutfooter" name="Color cut" min="0" max="255" value="0" step="10">
              <label for="colorcut">Color cut</label>
            </div>

            <div style="padding-left: 10px; padding-right: 10px;">
              <input type="range" id="thresholdfooter" name="Thresholding" min="0" max="255" value="0" step="10">
              <label for="threshold">Thresholding</label>
            </div>

            <div>
              <center>
                <button class="btn-keycapture" id="previewimagefooter" onclick="getupdatedimageforfooter()"
                  type="button">Preview image</button>
              </center>
            </div>

          </div>
        </div>

        <div>
          <h5 style="font-weight: bold; margin-top: 20px;">Text found in this image :</h5>
        </div>
        <!-- <center>
          <div style="font-weight:bolder; font-style: italic;">
            <p id="foundtxtfooter">Extracting text...</p>
          </div>
        </center> -->
        <center>
          <div style="font-weight:bolder; font-style: italic;">
            <!-- <p id="foundtxtfooter">Extracting text...</p> -->
            <input type="text" class="form-control" id="foundtxtfooter" placeholder="Extracting text...">
          </div>
        </center>
        <form role="form">
          <div id="footeroptions">
            <label for="textnature" style="margin-right: 5px; margin-left: 50px;">Select nature of this text</label>
            <select id="textnaturefooter">
              <option value="letter">Single letter</option>
              <option value="word">Single word</option>
              <option value="line">A line</option>
              <option value="para">A Paragraph</option>
              <option value="num">Numeric</option>
              <option value="date">Date</option>
            </select>

            <label for="language" style="margin-right: 5px; margin-left: 50px;">Select language of this text</label>
            <select id="languagefooter">
              <option value="eng">English</option>
              <option value="spa">Spanish</option>
              <option value="fre">French</option>
              <option value="chi">Chinese</option>
              <option value="ger">German</option>
              <option value="tam">Tamil</option>
            </select>

            <label for="fposition" style="margin-right: 5px; margin-left: 50px;">This footer text can be found at
              which part of the image ?</label>
            <select id="fposition">
              <option value="top">Top</option>
              <option value="middle">Middle</option>
              <option value="bottom">Bottom</option>
            </select>

            <label for="ftol" style="margin-right: 5px; margin-left: 50px;">Select the tolerence error
              percentage</label>
            <select id="ftol">
              <option value="10">10 %</option>
              <option value="20">20 %</option>
              <option value="30">30 %</option>
              <option value="40">40 %</option>
              <option value="50">50 %</option>
            </select>
          </div>
        </form>
        <div>
          <center><button class="btn-cardsave" id="savedatafooter">Save</button></center>
        </div>

      </div>

    </div>

  </div>
</div>

<!-- Left Index Modal -->
<div class="modal fade" id="leftindexModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">


      <div class="modal-header" style="padding:10px 10px;">
        <button type="button" class="close" data-dismiss="modal" id="leftindexclosebtn">&times;</button>
        <center>
          <h4 style="color: white;">Enter below details</h4>
        </center>
      </div>


      <div class="modal-body" style="padding:10px 50px;">
        <div>
          <h5 style="font-weight: bold;">Cropped image :</h5>
        </div>
        <center>
          <div style="margin: 10px;"><img id="croppedimgleftindex" src="static/images/logo.png"
              style="max-width: 400px;"></div>
        </center>


        <div id="threblock" style="border:1px solid gray; padding-left: 5px; margin-top: 5px;">
          <div class="checkbox" id="thredivleftindex">
            <label><input type="checkbox" value="" onchange="showthreoptions(this)" id="threcheckboxleftindex"
                checked>Auto Thresholding and Color cut</label>
          </div>
          <div id="threoptionsleftindex">

            <div style="padding-left: 10px; padding-right: 10px;">
              <input type="range" id="colorcutleftindex" name="Color cut" min="0" max="255" value="0" step="10">
              <label for="colorcut">Color cut</label>
            </div>

            <div style="padding-left: 10px; padding-right: 10px;">
              <input type="range" id="thresholdleftindex" name="Thresholding" min="0" max="255" value="0" step="10">
              <label for="threshold">Thresholding</label>
            </div>

            <div>
              <center>
                <button class="btn-keycapture" id="previewimageleftindex" onclick="getupdatedimageforleftindex()"
                  type="button">Preview image</button>
              </center>
            </div>

          </div>
        </div>

        <div>
          <h5 style="font-weight: bold; margin-top: 20px;">Text found in this image :</h5>
        </div>
        <!-- <center>
          <div style="font-weight:bolder; font-style: italic;">
            <p id="foundtxtleftindex">Extracting text...</p>
          </div>
        </center> -->
        <center>
          <div style="font-weight:bolder; font-style: italic;">
            <!-- <p id="foundtxtleftindex">Extracting text...</p> -->
            <input type="text" class="form-control" id="foundtxtleftindex" placeholder="Extracting text...">
          </div>
        </center>
        <form role="form">
          <div id="leftindexoptions">
            <label for="textnature" style="margin-right: 5px; margin-left: 50px;">Select nature of this text</label>
            <select id="textnatureleftindex">
              <option value="letter">Single letter</option>
              <option value="word">Single word</option>
              <option value="line">A line</option>
              <option value="para">A Paragraph</option>
              <option value="num">Numeric</option>
              <option value="date">Date</option>
            </select>

            <label for="language" style="margin-right: 5px; margin-left: 50px;">Select language of this text</label>
            <select id="languageleftindex">
              <option value="eng">English</option>
              <option value="spa">Spanish</option>
              <option value="fre">French</option>
              <option value="chi">Chinese</option>
              <option value="ger">German</option>
              <option value="tam">Tamil</option>
            </select>

            <label for="liposition" style="margin-right: 5px; margin-left: 50px;">This Left index text can be found
              at which part of the image ?</label>
            <select id="liposition">
              <option value="top">Top</option>
              <option value="middle">Middle</option>
              <option value="bottom">Bottom</option>
            </select>

            <label for="litol" style="margin-right: 5px; margin-left: 50px;">Select the tolerence error
              percentage</label>
            <select id="litol">
              <option value="10">10 %</option>
              <option value="20">20 %</option>
              <option value="30">30 %</option>
              <option value="40">40 %</option>
              <option value="50">50 %</option>
            </select>
          </div>
        </form>
        <div>
          <center><button class="btn-cardsave" id="savedataleftindex">Save</button></center>
        </div>

      </div>

    </div>

  </div>
</div>
{% endblock %}

{% block scripts%}
{{ super() }}
<script src="static/lib/custom-file-input.js"></script>
<script src="static/lib/chart-master/Chart.js"></script>
<script src="static/lib/cropper.js"></script>
<script src="static/lib/canvas2image.js"></script>
<script class="include" type="text/javascript" src="static/lib/jquery.dcjqaccordion.2.7.js"></script>
<script src="static/lib/jquery.scrollTo.min.js"></script>
<script src="static/lib/jquery.nicescroll.js" type="text/javascript"></script>
<script src="static/lib/jquery.sparkline.js"></script>
<!--common script for all pages-->
<script src="static/lib/common-scripts.js"></script>
<script type="text/javascript" src="static/lib/gritter/js/jquery.gritter.js"></script>
<script type="text/javascript" src="static/lib/gritter-conf.js"></script>
<!--script for this page-->
<script src="static/lib/sparkline-chart.js"></script>
<script src="static/lib/zabuto_calendar.js"></script>
<script type="application/javascript">

   var count = 2;
      var xaxis;
      var yaxis;
      var width;
      var heigth;
      var rotate;
      var scaleX;
      var scaleY;
      var fullheight;
      var fullwidth;
      var cropper;
      var cropper1;
      var cropperforenhance;
      var paramcount = 1
      var headerRowId = "null";
      var footerRowId = "null";
      var leftindexRowId = "null";

      var originalwidth;
      var originalheight;

      var rownumarray = [];
      var indexcount = 1;

      var headerxaxis = 0;
      var headeryaxis = 0;

      var leftindexxaxis = 0;
      var leftindexyaxis = 0;

      var modelname = localStorage.getItem("modelname");


      var thre;
      var cocut;
      var dil;
      var ero;
      var rangex;
      var rangey;



      // load image      
      loadlastimageusedtotrain();

      // initial executions
      getimagedimensions(modelname);

      // getoldheadandleft(modelname);

      function getimagedimensions(modelname) {

        if (modelname == "") {
          alert("Model name not found");
        }
        else {

          var http = new XMLHttpRequest();
          var url = 'getimagedimensions';
          var params = 'modelname=' + modelname;
          http.open('POST', url, true);

          http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

          http.onreadystatechange = function () {
            if (http.readyState == 4 && http.status == 200) {
              // alert(http.status);
              if (http.status == 200) {
                // console.log(http.response);
                var array = JSON.parse(http.response);
                originalwidth = array[0];
                originalheight = array[1];
                console.log(originalwidth + " " + originalheight);
              } else {
                alert("failed to get original image size")
              }
            }
          }
          http.send(params);
        }
      }

      function resize() {
        //define the width to resize e.g 600px
        var resize_width = originalwidth;//without px

        //get the image selected
        var item = document.querySelector('#inputId').files[0];

        //create a FileReader
        var reader = new FileReader();

        //image turned to base64-encoded Data URI.
        reader.readAsDataURL(item);
        reader.name = item.name;//get the image's name
        reader.size = item.size; //get the image's size
        reader.onload = function (event) {
          var img = new Image();//create a image
          img.src = event.target.result;//result is base64-encoded Data URI
          img.name = event.target.name;//set name (optional)
          img.size = event.target.size;//set size (optional)
          img.onload = function (el) {
            var elem = document.createElement('canvas');//create a canvas

            //scale the image to 600 (width) and keep aspect ratio
            var scaleFactor = resize_width / el.target.width;
            elem.width = resize_width;
            elem.height = originalheight;

            //draw in canvas
            var ctx = elem.getContext('2d');
            ctx.drawImage(el.target, 0, 0, elem.width, elem.height);

            //get the base64-encoded Data URI from the resize image
            var srcEncoded = ctx.canvas.toDataURL(el.target, 'image/jpeg', 0);

            //assign it to thumb src
            document.querySelector('#output').src = srcEncoded;

            // updateImageDisplay();

          }
        }
      }

      $(document).ready(function () {
        getoldheadandleft(modelname);

        var output2 = document.getElementById('imgoutput2');
        output2.style.display = "none";

        $("#btnCrop").css("display", "none");
        $("#btnCloseCropper").css("display", "none");

        $("#headeroptions").css("display", "none");
        $("#footeroptions").css("display", "none");
        $("#keyoptions").css("display", "none");
        $("#threoptions").css("display", "none");
        $("#thrediv").css("display", "block");
        $("#headeroptions").css("display", "none");
        $("#footeroptions").css("display", "none");

        var http = new XMLHttpRequest();
        var url = 'fetchexistingmodel';
        var params = 'modelname=' + modelname;
        http.open('POST', url, true);

        http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

        http.onreadystatechange = function () {
          if (http.readyState == 4 && http.status == 200) {
            if (http.status == 200) {
              responselist = http.response;
              console.log(responselist);
              initialtableupdate(responselist);
              initialtableupdate1(modelname); 
            } else {
              alert("failed to get original image size")
            }
          }
        }
        http.send(params);
     
      });

      function initialtableupdate(array) {

      var rowcount;
      var rowcount1;

      var array = responselist.split(")");
      // console.log(array[0]);

        for (i in array) {

          row = array[i];
          row = row.toString();

          row = row.replace("[", "");
          row = row.replace("]", "");
          row = row.replace(", (", "");
          row = row.replace("(", "");

          var rowarray = row.split(",");
          // console.log(rowarray);
          // console.log(rowarray[12]);

          rowcount = document.getElementById("myTable").rows.length;
          rowcount1 = document.getElementById("myTable1").rows.length;

          if (rowarray.length != 1) {
            // console.log(rowcount + rowcount1);

            if (rowarray[12] == " 'true'") {
              $("#btnheadcapture").css("display", "none");
              $("#capturedHead").css("display", "table-cell");
              $("#btnHeadRecap").css("display", "table-cell");
              document.getElementById("capturedHead").innerHTML = rowarray[11].replace(/\'/g, "", 2);
            }

            if (rowarray[15] == " 'true'") {
              $("#btnfootercapture").css("display", "none");
              $("#capturedFoot").css("display", "table-cell");
              $("#btnFootRecap").css("display", "table-cell");
              document.getElementById("capturedFoot").innerHTML = rowarray[11].replace(/\'/g, "", 2);
            }

            if (rowarray[27] == " 'true'") {
              $("#btnleftindexcapture").css("display", "none");
              $("#capturedleftindex").css("display", "table-cell");
              $("#btnLeftIndexRecap").css("display", "table-cell");
              document.getElementById("capturedleftindex").innerHTML = rowarray[11].replace(/\'/g, "", 2);
            }
            initialcreatenewrow(rowarray, rowcount, rowcount1);
            initialtableupdatewithvalues(rowarray, rowcount, rowcount1);
          }
        }
      }

      function initialcreatenewrow(rowarray, rowcount, rowcount1) {

        if (rowarray[10] != " '-'") {
          var table1 = document.getElementById("myTable1");
          var row = table1.insertRow();
          var cell1 = row.insertCell(0);
          var cell2 = row.insertCell(1);
          var cell3 = row.insertCell(2);
          var btnhtml = '<button onclick = "showcropper(this)"><i class="fa fa-refresh"></i></button>';
          cell3.innerHTML = btnhtml;
        }

        var table = document.getElementById("myTable");
        var row = table.insertRow(rowcount);

        for (i=1;i<35;i++){
          var cell = row.insertCell(i-1);
          if (i == 34){
            var button = document.createElement('input');
            button.setAttribute('type', 'button');
            button.setAttribute('value', 'Remove');
            button.setAttribute('onclick', 'removeRow(this)');
            cell.appendChild(button);
          } else if (i == 1){
            cell.innerHTML = count - 1;
          }
        }

      }

      function initialtableupdatewithvalues(rowarray, rowcount, rowcount1) {

        // console.log(rowarray);

        if (rowarray[10] != " '-'") {
          var myTable1 = document.getElementById('myTable1');
          myTable1.rows[rowcount1].cells[0].innerHTML = rowarray[10].replace(/\'/g, "", 2);;
        }

        var myTable = document.getElementById('myTable');

        myTable.rows[rowcount].cells[0].innerHTML = rowarray[0].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[1].innerHTML = rowarray[1].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[2].innerHTML = rowarray[2].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[3].innerHTML = rowarray[3].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[4].innerHTML = rowarray[4].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[5].innerHTML = rowarray[5].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[6].innerHTML = rowarray[6].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[7].innerHTML = rowarray[7].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[8].innerHTML = rowarray[8].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[9].innerHTML = rowarray[9].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[10].innerHTML = rowarray[10].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[11].innerHTML = rowarray[11].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[12].innerHTML = rowarray[12].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[13].innerHTML = rowarray[13].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[14].innerHTML = rowarray[14].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[15].innerHTML = rowarray[15].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[16].innerHTML = rowarray[16].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[17].innerHTML = rowarray[17].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[18].innerHTML = rowarray[18].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[19].innerHTML = rowarray[19].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[20].innerHTML = rowarray[20].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[21].innerHTML = rowarray[21].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[22].innerHTML = rowarray[22].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[23].innerHTML = rowarray[23].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[24].innerHTML = rowarray[24].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[25].innerHTML = rowarray[25].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[26].innerHTML = rowarray[26].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[27].innerHTML = rowarray[27].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[28].innerHTML = rowarray[28].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[29].innerHTML = rowarray[29].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[30].innerHTML = rowarray[30].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[31].innerHTML = rowarray[31].replace(/\'/g, "", 2);
        myTable.rows[rowcount].cells[32].innerHTML = rowarray[32].replace(/\'/g, "", 2);

        if (rowarray[12].replace(/\'/g, "", 2) == " true") {
          var bulidstr = "( header : " + indexcount + ")";
          rownumarray.push(bulidstr);
          indexcount = indexcount + 1;
        } else if (rowarray[15].replace(/\'/g, "", 2) == " true") {
          var bulidstr = "( footer : " + indexcount + ")";
          rownumarray.push(bulidstr);
          indexcount = indexcount + 1;
        } else if (rowarray[27].replace(/\'/g, "", 2) == " true") {
          var bulidstr = "( leftindex : " + indexcount + ")";
          rownumarray.push(bulidstr);
          indexcount = indexcount + 1;
        } else {
          var bulidstr = "(" + rowarray[10].replace(/\'/g, "", 2) + " : " + indexcount + ")";
          rownumarray.push(bulidstr);
          indexcount = indexcount + 1;
        }

      }



      function initialtableupdate1(modelname){
        var http1 = new XMLHttpRequest();
        var url1 = 'fetchexistingmodelmetadata';
        var params1 = 'modelname=' + modelname;
        http1.open('POST', url1, true);

        http1.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

        http1.onreadystatechange = function () {
          if (http1.readyState == 4 && http1.status == 200) {
            if (http1.status == 200) {
              modelsresponse = http1.response;
              console.log(modelsresponse);

              var array = modelsresponse.split(")");
              console.log(array[0]);

              row = array[0];
              row = row.toString();

              row = row.replace("[", "");
              row = row.replace("]", "");
              row = row.replace(", (", "");
              row = row.replace("(", "");

              var rowarray = row.split(",");
              console.log(rowarray);

              var defthre = document.getElementById("defthreinput");
              var defcolcut = document.getElementById("defcolcutinput");
              var defdilate = document.getElementById("defdilatecutinput");
              var deferode = document.getElementById("deferodeinput");
              var defeyerangex = document.getElementById("defeyerangex");
              var defeyerangey = document.getElementById("defeyerangey");

              thre = rowarray[8].replace(/ |'/g,"");
              cocut = rowarray[9].replace(/ |'/g,"");
              dil = rowarray[15].replace(/ |'/g,"");
              ero = rowarray[16].replace(/ |'/g,"");
              rangex = rowarray[10].replace(/ |'/g,"");
              rangey = rowarray[11].replace(/ |'/g,"");

              defthre.value = thre; 
              defcolcut.value = cocut;
              defdilate.value = dil;
              deferode.value = ero;
              defeyerangex.value = rangex;
              defeyerangey.value = rangey;
              
            } else {
              alert("failed to get original image size")
            }
          }
        }
        http1.send(params1);
      }


      $(function () {
        $('#closebtn').click(function () {
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
          $("#headerdiv").css("display", "block");
          $("#footerdiv").css("display", "block");
          $("#footeroptions").css("display", "none");
          $("#headeroptions").css("display", "none");
        });
      });



      // retrain button clicked
      function getnewtable() {

        var myTab = document.getElementById('myTable');

        // for (i = 2; i < myTab.rows.length; i++) {
        //   var objCells = myTab.rows.item(i).cells;
        //   var xaxisl = objCells.item(1).innerHTML;
        //   var yaxisl = objCells.item(2).innerHTML;
        //   var headerl = objCells.item(12).innerHTML;
        //   var leftindex = objCells.item(27).innerHTML;
        //   if (headerl == " true"){
        //     headerxaxis = xaxisl;
        //     headeryaxis = yaxisl;
        //     console.log(headerxaxis);
        //     console.log(headeryaxis);
        //   } else if (leftindex == " true") {
        //     leftindexxaxis = xaxisl;
        //     leftindexyaxis = yaxisl;
        //     console.log(leftindexxaxis);
        //     console.log(leftindexyaxis);
        //   }
        // }

        // if ((headeryaxis == 0) || (leftindexxaxis == 0)){
        //   headleftlist = getoldheadandleft(model);
        //   headeryaxis = headleftlist[0];
        //   leftindexxaxis = headleftlist[1];
        // }

        for (i = 2; i < myTab.rows.length; i++) {
          var objCells = myTab.rows.item(i).cells;

          var sno = objCells.item(0).innerHTML;
          var xaxisl = objCells.item(1).innerHTML;
          var yaxisl = objCells.item(2).innerHTML;
          var widthl = objCells.item(3).innerHTML;
          var heightl = objCells.item(4).innerHTML;
          var rotatel = objCells.item(5).innerHTML;
          var keywidthl = objCells.item(6).innerHTML;
          var keyheightl = objCells.item(7).innerHTML;
          var fullwidthl = objCells.item(8).innerHTML;
          var fullheightl = objCells.item(9).innerHTML;
          var labell = objCells.item(10).innerHTML;
          var textl = objCells.item(11).innerHTML;
          var headerl = objCells.item(12).innerHTML;
          var hpositionl = objCells.item(13).innerHTML;
          var htoll = objCells.item(14).innerHTML;
          var footerl = objCells.item(15).innerHTML;
          var fpositionl = objCells.item(16).innerHTML;
          var ftoll = objCells.item(17).innerHTML;
          var isthre = objCells.item(18).innerHTML;
          var colorcut = objCells.item(19).innerHTML;
          var threshold = objCells.item(20).innerHTML;
          var textnature = objCells.item(21).innerHTML;
          var language = objCells.item(22).innerHTML;
          var iskey = objCells.item(23).innerHTML;
          var kposition = objCells.item(24).innerHTML;
          var ktol = objCells.item(25).innerHTML;
          var keyval = objCells.item(26).innerHTML;
          var leftindex = objCells.item(27).innerHTML;
          var liposition = objCells.item(28).innerHTML;
          var litol = objCells.item(29).innerHTML;
          var kori = objCells.item(30).innerHTML;
          var koriper = objCells.item(31).innerHTML;
          var regex = objCells.item(32).innerHTML;

          if (headerl == "undefined") {
            headerl = "-";
          }
          if (hpositionl == "undefined") {
            hpositionl = "-";
          }
          if (htoll == "undefined") {
            htoll = "-";
          }
          if (footerl == "undefined") {
            footerl = "-";
          }
          if (fpositionl == "undefined") {
            fpositionl = "-";
          }
          if (ftoll == "undefined") {
            ftoll = "-";
          }
          if (colorcut == "undefined") {
            colorcut = "-";
          }
          if (threshold == "undefined") {
            threshold = "-";
          }
          if (liposition == "undefined") {
            liposition = "-";
          }
          if (litol == "undefined") {
            litol = "-";
          }
          if (kposition == "undefined") {
            kposition = "-";
          }
          if (ktol == "undefined") {
            ktol = "-";
          }
          if (keyval == "undefined") {
            keyval = "-";
          }
          if (kori == "undefined") {
            kori = "-";
          }
          if (koriper == "undefined") {
            koriper = "-";
          }
          if (regex == "undefined") {
            regex = "-";
          }

          if (keywidthl == NaN) {
            keywidthl = 0;
          }
          if (keyheightl == NaN) {
            keyheightl = 0;
          }

          // console.log(headeryaxis);
          // console.log(leftindexxaxis);

          // if (headeryaxis != 0){
          //   if ((headerl != "true") & (footerl != "true") & (leftindex != "true")){
          //     console.log("first yaxis - " + yaxisl.toString());
          //     yaxisl = parseInt(yaxisl) - parseInt(headeryaxis);
          //     console.log("second yaxis - " + yaxisl.toString());
          //   }
          // }

          // if (leftindexxaxis != 0){
          //   if ((headerl != "true") & (footerl != "true") & (leftindex != "true")){
          //     console.log("second xaxis - " + xaxisl.toString());
          //     xaxisl = parseInt(xaxisl) - parseInt(leftindexxaxis);
          //     console.log("second xaxis - " + xaxisl.toString());
          //   }
          // }

          console.log(xaxisl + " " + yaxisl + " " + widthl + " " + heightl + " " + labell);

          sendnewdata(xaxisl, yaxisl, widthl, heightl, rotatel, keywidthl, keyheightl, fullwidthl, fullheightl, labell, textl, headerl, hpositionl, htoll, footerl, fpositionl, ftoll, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval, leftindex, liposition, litol, kori, koriper, regex);

        }
      }

      function getoldheadandleft(model){
        // console.log("here");

        // var myTab = document.getElementById('myTable');
        // console.log(myTab);
        // console.log(myTab.rows.length);

        // var x = document.getElementById("myTable").rows.length;
        // console.log(x);

        // for (i = 2; i < myTab.rows.length; i++) {
        //   console.log("here0");
        //   var objCells = myTab.rows.item(i).cells;
        //   var xaxisl = objCells.item(1).innerHTML;
        //   var yaxisl = objCells.item(2).innerHTML;
        //   var headerl = objCells.item(12).innerHTML;
        //   var leftindex = objCells.item(27).innerHTML;
        //   if (headerl == " true"){
        //     console.log("here1");
        //     headerxaxis = xaxisl;
        //     headeryaxis = yaxisl;
        //     console.log(headerxaxis);
        //     console.log(headeryaxis);
        //   } else if (leftindex == " true") {
        //     console.log("here1");
        //     leftindexxaxis = xaxisl;
        //     leftindexyaxis = yaxisl;
        //     console.log(leftindexxaxis);
        //     console.log(leftindexyaxis);
        //   }
        // }

        var http = new XMLHttpRequest();
        var url = 'getoldheadleft';
        var params = 'model=' + model;
        http.open('POST', url, true);

        http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

        http.onreadystatechange = function () {
          if(http.readyState == 4 && http.status == 200) {
            if (http.status == 200){
              response = http.responseText;
              console.log(response);
              // response = http.responseText;
              var responseobj = JSON.parse(response);
              axes = responseobj.string;
              axes = axes.replace("[", "");
              axes = axes.replace("]", "");
              axes = axes.replace(/'/g, "");
              axes = axes.replace(" ", "");
              axes = axes.split(",");
              headeryaxis = parseInt(axes[0]);
              leftindexxaxis = parseInt(axes[1]);
              console.log(headeryaxis);
              console.log(leftindexxaxis);
            } else {
              alert("failed to get data")
            }
          }
        }
        http.send(params);
        // return response;
      }

      function sendnewdata(xaxisl, yaxisl, widthl, heightl, rotatel, keywidthl, keyheightl, fullwidthl, fullheightl, labell, textl, headerl, hpositionl, htoll, footerl, fpositionl, ftoll, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval, leftindex, liposition, litol, kori, koriper, regex) {
        if (labell != " -") {
          var formdata = new FormData();
          formdata.append('label', labell);
          formdata.append('xaxis', xaxisl);
          formdata.append('yaxis', yaxisl);
          formdata.append('width', widthl);
          formdata.append('height', heightl);

          formdata.append('rotate', rotatel);
          formdata.append('keywidthl', keywidthl);
          formdata.append('keyheightl', keyheightl);
          formdata.append('fullwidth', fullwidthl);
          formdata.append('fullheight', fullheightl);

          formdata.append('label', labell);
          formdata.append('text', textl);
          formdata.append('header', headerl);
          formdata.append('hposition', hpositionl);
          formdata.append('htol', htoll);
          formdata.append('footer', footerl);

          formdata.append('fposition', fpositionl);
          formdata.append('ftol', ftoll);
          formdata.append('isthre', isthre);
          formdata.append('colorcut', colorcut);
          formdata.append('threshold', threshold);

          formdata.append('textnature', textnature);
          formdata.append('language', language);
          formdata.append('iskey', iskey);
          formdata.append('kposition', kposition);
          formdata.append('ktol', ktol);

          formdata.append('keyval', keyval);
          formdata.append('leftindex', leftindex);
          formdata.append('liposition', liposition);
          formdata.append('litol', litol);

          formdata.append('kori', kori);
          formdata.append('koriper', koriper);
          formdata.append('regex', regex);

          formdata.append('model', modelname);

          fetch('retrain', {
            // mode: 'no-cors',
            method: 'POST',
            body: formdata
          }).then(
            function (response) {
              if (response.status !== 200) {
                console.log('Looks like there was a problem. Status Code: ' + response.status);
                return;
              } else if (response.status == 200) {
                return response.text().then(function (text) {
                  alert("Model retrained");
                });
              }
            }
          ).catch(function (err) {
            console.log('Fetch Error :-S', err);
          });
        } else if (headerl == " true") {
          var formdata = new FormData();
          formdata.append('label', labell);
          formdata.append('xaxis', xaxisl);
          formdata.append('yaxis', yaxisl);
          formdata.append('width', widthl);
          formdata.append('height', heightl);

          formdata.append('rotate', rotatel);
          formdata.append('scalex', scalexl);
          formdata.append('scaley', scaleyl);
          formdata.append('fullwidth', fullwidthl);
          formdata.append('fullheight', fullheightl);

          formdata.append('text', textl);
          formdata.append('header', headerl);
          formdata.append('hposition', hpositionl);
          formdata.append('htol', htoll);
          formdata.append('footer', footerl);

          formdata.append('fposition', fpositionl);
          formdata.append('ftol', ftoll);
          formdata.append('isthre', isthre);
          formdata.append('colorcut', colorcut);
          formdata.append('threshold', threshold);

          formdata.append('textnature', textnature);
          formdata.append('language', language);
          formdata.append('iskey', iskey);
          formdata.append('kposition', kposition);
          formdata.append('ktol', ktol);

          formdata.append('keyval', keyval);
          formdata.append('leftindex', leftindex);
          formdata.append('liposition', liposition);
          formdata.append('litol', litol);
          formdata.append('model', modelname);

          fetch('retrainheader', {
            // mode: 'no-cors',
            method: 'POST',
            body: formdata
          }).then(
            function (response) {
              if (response.status !== 200) {
                console.log('Looks like there was a problem. Status Code: ' + response.status);
                return;
              } else if (response.status == 200) {
                return response.text().then(function (text) {
                  // alert("Model retrained");
                  console.log("model retrained")
                });
              }
            }
          ).catch(function (err) {
            console.log('Fetch Error :-S', err);
          });
        } else if (footerl == " true") {
          var formdata = new FormData();
          formdata.append('label', labell);
          formdata.append('xaxis', xaxisl);
          formdata.append('yaxis', yaxisl);
          formdata.append('width', widthl);
          formdata.append('height', heightl);

          formdata.append('rotate', rotatel);
          formdata.append('scalex', scalexl);
          formdata.append('scaley', scaleyl);
          formdata.append('fullwidth', fullwidthl);
          formdata.append('fullheight', fullheightl);

          formdata.append('text', textl);
          formdata.append('header', headerl);
          formdata.append('hposition', hpositionl);
          formdata.append('htol', htoll);
          formdata.append('footer', footerl);

          formdata.append('fposition', fpositionl);
          formdata.append('ftol', ftoll);
          formdata.append('isthre', isthre);
          formdata.append('colorcut', colorcut);
          formdata.append('threshold', threshold);

          formdata.append('textnature', textnature);
          formdata.append('language', language);
          formdata.append('iskey', iskey);
          formdata.append('kposition', kposition);
          formdata.append('ktol', ktol);

          formdata.append('keyval', keyval);
          formdata.append('leftindex', leftindex);
          formdata.append('liposition', liposition);
          formdata.append('litol', litol);
          formdata.append('model', modelname);

          fetch('retrainfooter', {
            // mode: 'no-cors',
            method: 'POST',
            body: formdata
          }).then(
            function (response) {
              if (response.status !== 200) {
                console.log('Looks like there was a problem. Status Code: ' + response.status);
                return;
              } else if (response.status == 200) {
                return response.text().then(function (text) {
                  // alert(text);
                  console.log("model retrained")
                });
              }
            }
          ).catch(function (err) {
            console.log('Fetch Error :-S', err);
          });
        } else if (leftindex == " true") {
          var formdata = new FormData();
          formdata.append('label', labell);
          formdata.append('xaxis', xaxisl);
          formdata.append('yaxis', yaxisl);
          formdata.append('width', widthl);
          formdata.append('height', heightl);

          formdata.append('rotate', rotatel);
          formdata.append('scalex', scalexl);
          formdata.append('scaley', scaleyl);
          formdata.append('fullwidth', fullwidthl);
          formdata.append('fullheight', fullheightl);

          formdata.append('text', textl);
          formdata.append('header', headerl);
          formdata.append('hposition', hpositionl);
          formdata.append('htol', htoll);
          formdata.append('footer', footerl);

          formdata.append('fposition', fpositionl);
          formdata.append('ftol', ftoll);
          formdata.append('isthre', isthre);
          formdata.append('colorcut', colorcut);
          formdata.append('threshold', threshold);

          formdata.append('textnature', textnature);
          formdata.append('language', language);
          formdata.append('iskey', iskey);
          formdata.append('kposition', kposition);
          formdata.append('ktol', ktol);

          formdata.append('keyval', keyval);
          formdata.append('leftindex', leftindex);
          formdata.append('liposition', liposition);
          formdata.append('litol', litol);
          formdata.append('model', modelname);

          fetch('retrainleftindex', {
            // mode: 'no-cors',
            method: 'POST',
            body: formdata
          }).then(
            function (response) {
              if (response.status !== 200) {
                console.log('Looks like there was a problem. Status Code: ' + response.status);
                return;
              } else if (response.status == 200) {
                return response.text().then(function (text) {
                  // alert(text);
                  console.log("model retrained")
                });
              }
            }
          ).catch(function (err) {
            console.log('Fetch Error :-S', err);
          });
        }
      }

      // toggle options
      function showheaderoptions(obj) {
        if ($(obj).is(":checked")) {
          $("#headeroptions").css("display", "inline");
          $("#footerdiv").css("display", "none");
          $("#page-header-inner").addClass("sticky");
        } else {
          $("#headeroptions").css("display", "none");
          $("#footerdiv").css("display", "block");
        }
      }

      function showfooteroptions(obj) {
        if ($(obj).is(":checked")) {
          $("#footeroptions").css("display", "inline");
          $("#page-header-inner").addClass("sticky");
          $("#headerdiv").css("display", "none");
        } else {
          $("#footeroptions").css("display", "none");
          $("#headerdiv").css("display", "block");
        }
      }

      function showkeyoptions(obj) {
        if ($(obj).is(":checked")) {
          $("#keyoptions").css("display", "inline");
        } else {
          $("#keyoptions").css("display", "none");
          $("#keydiv").css("display", "block");
        }
      }

      function showthreoptions(obj) {
        if ($(obj).is(":checked")) {
          $("#threoptions").css("display", "none");
          $("#thrediv").css("display", "block");

          $("#threoptionsheader").css("display", "none");
          $("#thredivheader").css("display", "block");

          $("#threoptionsfooter").css("display", "none");
          $("#thredivfooter").css("display", "block");

          $("#threoptionsleftindex").css("display", "none");
          $("#thredivleftindex").css("display", "block");
        } else {
          $("#threoptions").css("display", "inline");
          $("#threoptionsheader").css("display", "inline");
          $("#threoptionsfooter").css("display", "inline");
          $("#threoptionsleftindex").css("display", "inline");
        }
      }

      

      

      
      // recapture button clicked
      function showcropper(fullrow) {

        try {
          closecropper();
        } catch (error) {
          console.log("no cropper to close");
        }

        $("#btnCrop").css("display", "inline");
        $("#btnCloseCropper").css("display", "inline");
        $("#btnCreateModel").css("display", "none");

        row = fullrow.parentNode.parentNode.rowIndex;
        if (row > 2) {
          var label = document.getElementById("myTable1").rows[row].cells.item(0).innerHTML;
          updateImageDisplay("parameter", label, row)
        }
      }

      function updateImageDisplay(indent, label, row) {
        var image = new Image();
        image.width = originalwidth;
        image.height = originalheight;

        image = document.getElementById('output');

        console.log(row);
        row = parseInt(row)-1;
        console.log(row);

        var mainTable = document.getElementById('myTable');
        // label = mainTable.rows[parseInt(row)];

        originalx = parseInt($('#myTable tr:eq(' + row + ') td:eq(1)').text());
        originaly = parseInt($('#myTable tr:eq(' + row + ') td:eq(2)').text());
        originalw = parseInt($('#myTable tr:eq(' + row + ') td:eq(3)').text());
        originalh = parseInt($('#myTable tr:eq(' + row + ') td:eq(4)').text());

        // var val1 =$(t).find('tr:eq(2) td:eq(4)').text();
        // alert(val1);

        // console.log(label);

        cropper = new Cropper(image, {
          data:{
            x: originalx,
            y: originaly,
            width: originalw,
            height: originalh,
          },
          crop(event) {
            cropper.width = originalwidth;
            cropper.height = originalheight;
            xaxis = event.detail.x;
            yaxis = event.detail.y;
            width = event.detail.width;
            height = event.detail.height;
            rotate = event.detail.rotate;
            scaleX = event.detail.scaleX;
            scaleY = event.detail.scaleY;
          }
        });

        // data = {"left":100,"top":50,"width":200,"height":20};

        // data:{width : 240, height : 507, },

        // cropper.setCropBoxData({width : 100, height : 100, });

        document.getElementById("btnCrop").onclick = function (event) {
          fullwidth = image.width;
          fullheight = image.height;
          cropperforenhance = cropper;
          getcroppedpicenhanced(cropper, fullheight, fullwidth, indent, label, row);
        }

      }

      function getcroppedpicenhanced(cropper, fullheight, fullwidth, indent, label, row) {

        var imageData = cropper.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");
        var file = dataURItoBlob(croppedimg);
        console.log(file);

        base64(file, function(data){
          var imagestring = data.base64;
          // console.log(imagestring);

          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'processcroppedimg', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": imagestring, "threshold": 125, "colorcut": 100 }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              // console.log(xhr.responseText);
              response = xhr.responseText;
              var responseobj = JSON.parse(response);
              imagestr = responseobj.imagestring;
              // console.log(imagestr);
              if (indent == "header") {
                showheadermodal(imagestr, fullheight, fullwidth, cropper);
              } else if (indent == "footer") {
                showfootermodal(imagestr, fullheight, fullwidth, cropper);
              } else if (indent == "leftindex") {
                showleftindexmodal(imagestr, fullheight, fullwidth, cropper);
              } else if (indent == "parameter") {
                showmodal(imagestr, fullheight, fullwidth, cropper, label, row);
              }
            }
          };
        })

      }

      // recapturing a parameter
      function showmodal(enhancedpic, fullheight, fullwidth, cropper, label, row) {
        // alert("here");
        document.getElementById("threcheckbox").checked = "true";
        cropper = cropperforenhance;
        $("#myModal").modal();
        $("myModal").ready(function () {

          $("#keyfields").css("display", "none");
          $("#croppedimg").attr("src", "data:image/jpg;base64," + enhancedpic);
          $("#labeltxt").val(label);
          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'extracttext', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": enhancedpic }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              // console.log(xhr.responseText);
              response = xhr.responseText;
              str = response.substring(response.indexOf("string\":"));
              str1 = str.substring(str.indexOf(":") + 3);
              str2 = str1.slice(0, -4);
              // console.log(str2);
              foundstr = str2;
              if (str2 == "") {
                $('#foundtxt').val("Cannot extract text from this image");
              } else {
                $('#foundtxt').val(str2);
              }

            }
          };

        });
        document.getElementById("savedata").onclick = function (event) {
          // var label = $('#labeltxt').val();
          // var foundstring = $("#foundtxt").val();
          // var ishead;
          // var isfoot;
          // var selhposition;
          // var selhtol;
          // var selfposition;
          // var selftol;
          // var textnature;
          // var language;
          // var iskey;
          // var isleftindex = "-";
          // var selliposition = "-";
          // var sellitol = "-";

          // if ($("#headercheckbox").prop('checked') == true) {
          //   ishead = true;
          //   selhposition = $("#hposition option:selected").val();
          //   selhtol = $("#htol option:selected").val();
          // }
          // if ($("#footercheckbox").prop('checked') == true) {
          //   isfoot = true;
          //   selfposition = $("#fposition option:selected").val();
          //   selftol = $("#ftol option:selected").val();
          // }

          // if ($("#threcheckbox").prop('checked') == true) {
          //   isthre = true;
          //   var colorcut = "-";
          //   var threshold = "-";
          // } else {
          //   isthre = false;
          //   var colorcut = document.getElementById("colorcut").value;
          //   var threshold = document.getElementById("threshold").value;
          // }

          // textnature = $("#textnature option:selected").val();
          // language = $("#language option:selected").val();

          // if ($("#keycheckbox").prop('checked') == true) {
          //   iskey = true;
          //   var keyval = $('#foundkeytxt').val();

          //   var kpositionDropDown = document.getElementById("kposition");
          //   var kposition = kpositionDropDown.options[kpositionDropDown.selectedIndex].value;

          //   var ktolDropDown = document.getElementById("ktol");
          //   var ktol = ktolDropDown.options[ktolDropDown.selectedIndex].value;
          // } else {
          //   iskey = false;
          // }

          var label = $('#labeltxt').val();
          var foundstring = $("#foundtxt").val();
          var foundstring2 = $("#foundtxt2").val();
          var ishead;
          var isfoot;
          var selhposition;
          var selhtol;
          var selfposition;
          var selftol;
          var textnature;
          var language;
          var iskey;
          var isleftindex = "-";
          var selliposition = "-";
          var sellitol = "-";
          var regex = "-";

          if ($("#headercheckbox").prop('checked') == true) {
            ishead = true;
            selhposition = $("#hposition option:selected").val();
            selhtol = $("#htol option:selected").val();
          }
          if ($("#footercheckbox").prop('checked') == true) {
            isfoot = true;
            selfposition = $("#fposition option:selected").val();
            selftol = $("#ftol option:selected").val();
          }

          if ($("#threcheckbox").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcut").value;
            var threshold = document.getElementById("threshold").value;
          }

          textnature = $("#textnature option:selected").val();
          language = $("#language option:selected").val();

          if ($("#keycheckbox").prop('checked') == true) {
            iskey = true;
            var keyval = $('#foundkeytxt').val();

            var kpositionDropDown = document.getElementById("kposition");
            var kposition = kpositionDropDown.options[kpositionDropDown.selectedIndex].value;

            var koriDropDown = document.getElementById("korientation");
            var kori = koriDropDown.options[koriDropDown.selectedIndex].value;

            var koriperDropDown = document.getElementById("koriper");
            var koriper = koriperDropDown.options[koriperDropDown.selectedIndex].value;

            var ktolDropDown = document.getElementById("ktol");
            var ktol = ktolDropDown.options[ktolDropDown.selectedIndex].value;
          } else {
            iskey = false;
          }

          // if (todb != "") {
          //   var regex = todb.toString();
          // } else {
          //   var regex = "-";
          // }

          var defdilate = document.getElementById("defdilatecutinput").value;
          var deferode = document.getElementById("deferodeinput").value;

          // var a = "-";
          // var b = "-";
          var c = "-";
          var d = "-";
          var e = "-";
          var f = "-";
          var g = "-";
          var h = "-";
          var i = "-";

          if (label == "") {
            alert("Enter a label");
          } else if (label != "") {
            // updateTable(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval, row);
            updateTable(cropper, fullheight, fullwidth, label, foundstring, foundstring2, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval, kori, koriper, regex, defdilate, deferode, c, d, e, f, g, h, i);
            $('.checkbox').prop("checked", false);
            $("input:checkbox").prop("checked", false);
            $("p").text("Extracting text...");
            $("input:text").val("");
            $("#headerdiv").css("display", "block");
            $("#footerdiv").css("display", "block");
            $("#keyoptions").css("display", "none");
            $("#footeroptions").css("display", "none");
            $("#headeroptions").css("display", "none");
            $('#myModal').modal('toggle');
            $("#keycapturebtn").css("display", "none");
            $("#btnCrop").css("display", "inline");
            $("#btnCreateModel").css("display", "inline");
            document.getElementById("threcheckbox").checked = "true";
            $("#threoptions").css("display", "none");
            cropper.destroy();

            var defthre = document.getElementById("defthreinput");
            var defcolcut = document.getElementById("defcolcutinput");
            var defdilate = document.getElementById("defdilatecutinput");
            var deferode = document.getElementById("deferodeinput");
            var defeyerangex = document.getElementById("defeyerangex");
            var defeyerangey = document.getElementById("defeyerangey");

            defthre.value = thre; 
            defcolcut.value = cocut;
            defdilate.value = dil;
            deferode.value = ero;
            defeyerangex.value = rangex;
            defeyerangey.value = rangey;

          }
        }
      }

      function updateTable(cropper, fullheight, fullwidth, label, foundstring, foundstring2, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval, kori, koriper, regex, a, b, c, d, e, f, g, h, i) {

        var rowcount = document.getElementById("myTable").rows.length;
        var rowcount1 = document.getElementById("myTable1").rows.length;

        console.log(row);

        // createnewrow(rowcount, rowcount1);

        for (i = 2; i < rowcount1; i++){
          var myTab1 = document.getElementById('myTable1');
          var objCells1 = myTab1.rows.item(i).cells;
          var labelold = objCells1.item(0).innerHTML;
          console.log(labelold);

          if (labelold == label){
            objCells1.item(1).innerHTML = foundstring;
          }

        }

        // var myTable1 = document.getElementById('myTable1');
        // myTable1.rows[rowcount1].cells[0].innerHTML = label;

        for (i in rownumarray) {
          var keylist = rownumarray[i];

          keyind = keylist.substring(keylist.indexOf(":") + 1);
          keyind = keyind.replace(")", "");
          keyind = parseInt(keyind) + 1;

          keyvalue = keylist.substring(keylist.indexOf("(") + 1);
          keyvalue = keyvalue.substring(0, keyvalue.indexOf(' :'));

          if (keyvalue == label) {
            console.log(keyind);
            var myTab = document.getElementById('myTable');
            var objCells = myTab.rows.item(keyind).cells;
            var sno = objCells.item(0).innerHTML;
            var xaxisl = objCells.item(1).innerHTML;
            var yaxisl = objCells.item(2).innerHTML;
            var widthl = objCells.item(3).innerHTML;
            var heightl = objCells.item(4).innerHTML;
            var rotatel = objCells.item(5).innerHTML;
            var scalexl = objCells.item(6).innerHTML;
            var scaleyl = objCells.item(7).innerHTML;
            var fullwidthl = objCells.item(8).innerHTML;
            var fullheightl = objCells.item(9).innerHTML;
            var labell = objCells.item(10).innerHTML;
            var textl = objCells.item(11).innerHTML;
            var headerl = objCells.item(12).innerHTML;
            var hpositionl = objCells.item(13).innerHTML;
            var htoll = objCells.item(14).innerHTML;
            var footerl = objCells.item(15).innerHTML;
            var fpositionl = objCells.item(16).innerHTML;
            var ftoll = objCells.item(17).innerHTML;
            var ThreColl = objCells.item(18).innerHTML;
            var ColVall = objCells.item(19).innerHTML;
            var ThreVall = objCells.item(20).innerHTML;
            var Naturel = objCells.item(21).innerHTML;
            var Langl = objCells.item(22).innerHTML;
            var Keymappedl = objCells.item(23).innerHTML;
            var KeyVall = objCells.item(24).innerHTML;
            var KeySidel = objCells.item(25).innerHTML;
            var KeyToll = objCells.item(26).innerHTML;
            var leftindexl = objCells.item(27).innerHTML;
            var lipositionl = objCells.item(28).innerHTML;
            var litoll = objCells.item(29).innerHTML;

            var xaxisc = Math.round(xaxis);
            var yaxisc = Math.round(yaxis);
            var widthc = Math.round(width);
            var heightc = Math.round(height);



            console.log(headeryaxis);
            console.log(leftindexxaxis);

            if (headeryaxis != 0){
              console.log("first yaxis - " + yaxisc.toString());
              yaxisc = parseInt(yaxisc) - parseInt(headeryaxis);
              console.log("second yaxis - " + yaxisc.toString());
            }

            if (leftindexxaxis != 0){
              console.log("second xaxis - " + xaxisc.toString());
              xaxisc = parseInt(xaxisc) - parseInt(leftindexxaxis);
              console.log("second xaxis - " + xaxisc.toString());
            }

            if (yaxisc < 0){
              yaxisc = 0
            }

            if (xaxisc < 0){
              xaxisc = 0
            }



            var xaxisupdated = (parseInt(xaxisl) + parseInt(xaxisc)) / 2;
            var yaxisupdated = (parseInt(yaxisl) + parseInt(yaxisc)) / 2;
            var widthupdated = (parseInt(widthl) + parseInt(widthc)) / 2;
            var heightupdated = (parseInt(heightl) + parseInt(heightc)) / 2;

            ThreColl = ThreColl.replace(/^\s+|\s+$/g, '');

            if (isthre == false) {
              console.log("here");
              console.log(ThreColl);
              if (ThreColl == "false") {
                console.log("thre unchecked")
                var thresholdupdated = (parseInt(threshold) + parseInt(ThreVall)) / 2;
                var colorcutupdated = (parseInt(colorcut) + parseInt(ColVall)) / 2;
              } else if (ThreColl == "true") {
                console.log("thre checked")
                var thresholdupdated = threshold;
                var colorcutupdated = colorcut;
              }
            }      
            updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring, isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
          }
        }
        // myTable1.rows[rowcount1].cells[1].innerHTML = foundstring2;
        // myTable1.rows[rowcount1].cells[2].innerHTML = "<button value='X'; onclick='removeRow(this)'>X</button>";
        count = count + 1;
      }

      function updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring, isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval) {
        
        keyind = parseInt(keyind);
        var myTable = document.getElementById('myTable');

        myTable.rows[keyind].cells[1].innerHTML = xaxisupdated;
        myTable.rows[keyind].cells[2].innerHTML = yaxisupdated;
        myTable.rows[keyind].cells[3].innerHTML = widthupdated;
        myTable.rows[keyind].cells[4].innerHTML = heightupdated;
        myTable.rows[keyind].cells[10].innerHTML = label;
        myTable.rows[keyind].cells[11].innerHTML = foundstring;
        myTable.rows[keyind].cells[18].innerHTML = isthre;
        myTable.rows[keyind].cells[19].innerHTML = colorcutupdated;
        myTable.rows[keyind].cells[20].innerHTML = thresholdupdated;
        myTable.rows[keyind].cells[21].innerHTML = textnature;
        myTable.rows[keyind].cells[22].innerHTML = language;
        myTable.rows[keyind].cells[23].innerHTML = iskey;
        myTable.rows[keyind].cells[25].innerHTML = kposition;
        myTable.rows[keyind].cells[26].innerHTML = ktol;
        myTable.rows[keyind].cells[24].innerHTML = keyval;
      }

      // recapturing header
      function updateImageDisplayHeader(indent) {
        var image = document.getElementById('output');
        cropper1 = new Cropper(image, {
          crop(event) {
            xaxis = event.detail.x;
            yaxis = event.detail.y;
            width = event.detail.width;
            height = event.detail.height;
            rotate = event.detail.rotate;
            scaleX = event.detail.scaleX;
            scaleY = event.detail.scaleY;
          }
        });

        var image = document.getElementById('output');
        document.getElementById("btnCrop").onclick = function (event) {
          fullwidth = image.width;
          fullheight = image.height;
          getcroppedpicenhanced(cropper1, fullheight, fullwidth, "header", "label", "row");
        }
      }

      function showheadermodal(enhancedpic, fullheight, fullwidth, cropper) {
        document.getElementById("threcheckboxheader").checked = "true";
        $("#threoptionsheader").css("display", "none");
        cropper = cropperforenhance;
        $("#headerModal").modal();
        $("headerModal").ready(function () {
          $("#croppedimgheader").attr("src", "data:image/jpg;base64," + enhancedpic);
          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'extracttext', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": enhancedpic }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              console.log(xhr.responseText);
              response = xhr.responseText;
              str = response.substring(response.indexOf("string\":"));
              str1 = str.substring(str.indexOf(":") + 3);
              str2 = str1.slice(0, -4);
              console.log(str2);
              foundstr = str2;
              if (str2 == "") {
                $('#foundtxtheader').val("Cannot extract text from this image");
              } else {
                $('#foundtxtheader').val(str2);
              }

            }
          };

        });

        document.getElementById("savedataheader").onclick = function (event) {
          var label = "-";
          var foundstring = $("#foundtxtheader").val();
          var ishead = "true";
          var isfoot = "-";
          var selhposition = "-";
          var selhtol = "-";
          var selfposition = "-";
          var selftol = "-";
          var textnature;
          var language;
          var iskey = "-";
          var keyval = "-";
          var isthre;
          var isleftindex = "-";
          var selliposition = "-";
          var sellitol = "-";
          var kposition = "-";
          var ktol = "-";

          if ($("#threcheckboxheader").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcutheader").value;
            var threshold = document.getElementById("thresholdheader").value;
          }

          textnature = $("#textnatureheader option:selected").val();
          language = $("#languageheader option:selected").val();

          selhposition = $("#hposition option:selected").val();
          selhtol = $("#htol option:selected").val();

          updateTableforheader(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval);
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
          $('#headerModal').modal('toggle');
          $("#btnCrop").css("display", "inline");
          $("#btnCreateModel").css("display", "inline");
          document.getElementById("threcheckboxheader").checked = "true";
          $("#threoptionsheader").css("display", "none");
          cropper1.destroy();

          var defthre = document.getElementById("defthreinput");
          var defcolcut = document.getElementById("defcolcutinput");
          var defdilate = document.getElementById("defdilatecutinput");
          var deferode = document.getElementById("deferodeinput");
          var defeyerangex = document.getElementById("defeyerangex");
          var defeyerangey = document.getElementById("defeyerangey");

          defthre.value = thre; 
          defcolcut.value = cocut;
          defdilate.value = dil;
          deferode.value = ero;
          defeyerangex.value = rangex;
          defeyerangey.value = rangey;

        }
      }

      function updateTableforheader(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval) {

        document.getElementById("capturedHead").innerHTML = foundstring;

        console.log(rownumarray);

        var headerdone = false;

        for (i in rownumarray) {
          var keylist = rownumarray[i];

          keyvalue = keylist.substring(keylist.indexOf("(") + 1);
          keyvalue = keyvalue.substring(0, keyvalue.indexOf(' :'));

          keyind = keylist.substring(keylist.indexOf(":") + 1);
          keyind = keyind.replace(")", "");
          keyind = parseInt(keyind) + 1;

          console.log(keyind);

          if (keyvalue == " header") {
            console.log(keyind);
            var myTab = document.getElementById('myTable');
            var objCells = myTab.rows.item(keyind).cells;
            var sno = objCells.item(0).innerHTML;
            var xaxisl = objCells.item(1).innerHTML;
            var yaxisl = objCells.item(2).innerHTML;
            var widthl = objCells.item(3).innerHTML;
            var heightl = objCells.item(4).innerHTML;
            var rotatel = objCells.item(5).innerHTML;
            var scalexl = objCells.item(6).innerHTML;
            var scaleyl = objCells.item(7).innerHTML;
            var fullwidthl = objCells.item(8).innerHTML;
            var fullheightl = objCells.item(9).innerHTML;
            var labell = objCells.item(10).innerHTML;
            var textl = objCells.item(11).innerHTML;
            var headerl = objCells.item(12).innerHTML;
            var hpositionl = objCells.item(13).innerHTML;
            var htoll = objCells.item(14).innerHTML;
            var footerl = objCells.item(15).innerHTML;
            var fpositionl = objCells.item(16).innerHTML;
            var ftoll = objCells.item(17).innerHTML;
            var ThreColl = objCells.item(18).innerHTML;
            var ColVall = objCells.item(19).innerHTML;
            var ThreVall = objCells.item(20).innerHTML;
            var Naturel = objCells.item(21).innerHTML;
            var Langl = objCells.item(22).innerHTML;
            var Keymappedl = objCells.item(23).innerHTML;
            var KeyVall = objCells.item(24).innerHTML;
            var KeySidel = objCells.item(25).innerHTML;
            var KeyToll = objCells.item(26).innerHTML;
            var leftindexl = objCells.item(27).innerHTML;
            var lipositionl = objCells.item(28).innerHTML;
            var litoll = objCells.item(29).innerHTML;

            var xaxisc = Math.round(xaxis);
            var yaxisc = Math.round(yaxis);
            var widthc = Math.round(width);
            var heightc = Math.round(height);

            var xaxisupdated = (parseInt(xaxisl) + parseInt(xaxisc)) / 2;
            var yaxisupdated = (parseInt(yaxisl) + parseInt(yaxisc)) / 2;
            var widthupdated = (parseInt(widthl) + parseInt(widthc)) / 2;
            var heightupdated = (parseInt(heightl) + parseInt(heightc)) / 2;

            ThreColl = ThreColl.replace(/^\s+|\s+$/g, '');

            if (isthre == false) {
              console.log("here");
              console.log(ThreColl);
              if (ThreColl == "false") {
                console.log("thre unchecked")
                var thresholdupdated = (parseInt(threshold) + parseInt(ThreVall)) / 2;
                var colorcutupdated = (parseInt(colorcut) + parseInt(ColVall)) / 2;
              } else if (ThreColl == "true") {
                console.log("thre checked")
                var thresholdupdated = threshold;
                var colorcutupdated = colorcut;
              }
            }
            updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring, isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
            headerdone = true;
          }
                    
        }
        if (headerdone = false){
          var label = "-";
          // var foundstring = $("#foundtxtheader").html();
          var foundstring = $('#foundtxtheader').val();
          var ishead = "true";
          var isfoot = "-";
          var selhposition = "-";
          var selhtol = "-";
          var selfposition = "-";
          var selftol = "-";
          var textnature;
          var language;
          var iskey = "-";
          var keyval = "-";
          var isthre;
          var isleftindex = "-";
          var selliposition = "-";
          var sellitol = "-";
          var kposition = "-";
          var ktol = "-";
          var kori = "-";
          var koriper = "-";

          if ($("#threcheckboxheader").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcutheader").value;
            var threshold = document.getElementById("thresholdheader").value;
          }

          textnature = $("#textnatureheader option:selected").val();
          language = $("#languageheader option:selected").val();
          selhposition = $("#hposition option:selected").val();
          selhtol = $("#htol option:selected").val();

          if (headerRowId != "null") {
            document.getElementById("myTable").deleteRow(headerRowId);
            count = count - 1;
          }

          var rowcount = parseInt(document.getElementById("myTable").rows.length);

          updatenewvaluestotable(rowcount+1, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring, isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("#foundtxtheader").val("");
          $('#headerModal').modal('toggle');
          $("#btnCrop").css("display", "inline");
          $("#btnCreateModel").css("display", "inline");
          document.getElementById("threcheckboxheader").checked = "true";
          $("#threoptionsheader").css("display", "none");
          cropper1.destroy();
          }
      }

      // recapturing footer
      function updateImageDisplayFooter(indent) {
        var image = document.getElementById('output');
        cropper2 = new Cropper(image, {
          crop(event) {
            xaxis = event.detail.x;
            yaxis = event.detail.y;
            width = event.detail.width;
            height = event.detail.height;
            rotate = event.detail.rotate;
            scaleX = event.detail.scaleX;
            scaleY = event.detail.scaleY;
          }
        });

        var image = document.getElementById('output');
        document.getElementById("btnCrop").onclick = function (event) {
          fullwidth = image.width;
          fullheight = image.height;
          getcroppedpicenhanced(cropper2, fullheight, fullwidth, "footer", "label", "row");
        }
      }

      function showfootermodal(enhancedpic, fullheight, fullwidth, cropper) {
        document.getElementById("threcheckboxfooter").checked = "true";
        $("#threoptionsfooter").css("display", "none");
        cropper = cropperforenhance;
        $("#footerModal").modal();
        $("footerModal").ready(function () {

          $("#croppedimgfooter").attr("src", "data:image/jpg;base64," + enhancedpic);
          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'extracttext', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": enhancedpic }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              console.log(xhr.responseText);
              response = xhr.responseText;
              str = response.substring(response.indexOf("string\":"));
              str1 = str.substring(str.indexOf(":") + 3);
              str2 = str1.slice(0, -4);
              console.log(str2);
              foundstr = str2;
              if (str2 == "") {
                $('#foundtxtfooter').val("Cannot extract text from this image");
              } else {
                $('#foundtxtfooter').val(str2);
              }

            }
          };

        });

        document.getElementById("savedatafooter").onclick = function (event) {
          var label = "-";
          var foundstring = $("#foundtxtfooter").val();
          var ishead = "-";
          var isfoot = "true";
          var selhposition = "-";
          var selhtol = "-";
          var selfposition = "-";
          var selftol = "-";
          var textnature;
          var language;
          var iskey = "-";
          var keyval = "-";
          var isthre;
          var isleftindex = "-";
          var selliposition = "-";
          var sellitol = "-";
          var kposition = "-";
          var ktol = "-";

          if ($("#threcheckboxfooter").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcutfooter").value;
            var threshold = document.getElementById("thresholdfooter").value;
          }

          textnature = $("#textnaturefooter option:selected").val();
          language = $("#languagefooter option:selected").val();

          selfposition = $("#fposition option:selected").val();
          selftol = $("#ftol option:selected").val();

          updateTableforfooter(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval);
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
          $('#footerModal').modal('toggle');
          $("#btnCrop").css("display", "inline");
          $("#btnCreateModel").css("display", "inline");
          document.getElementById("threcheckboxfooter").checked = "true";
          $("#threoptionsfooter").css("display", "none");
          cropper2.destroy();

          var defthre = document.getElementById("defthreinput");
          var defcolcut = document.getElementById("defcolcutinput");
          var defdilate = document.getElementById("defdilatecutinput");
          var deferode = document.getElementById("deferodeinput");
          var defeyerangex = document.getElementById("defeyerangex");
          var defeyerangey = document.getElementById("defeyerangey");

          defthre.value = thre; 
          defcolcut.value = cocut;
          defdilate.value = dil;
          deferode.value = ero;
          defeyerangex.value = rangex;
          defeyerangey.value = rangey;

        }
      }

      function updateTableforfooter(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval) {

        document.getElementById("capturedFoot").innerHTML = foundstring;

        console.log(rownumarray);
        for (i in rownumarray) {
          var keylist = rownumarray[i];

          keyvalue = keylist.substring(keylist.indexOf("(") + 1);
          keyvalue = keyvalue.substring(0, keyvalue.indexOf(' :'));
          keyind = keylist.substring(keylist.indexOf(":") + 1);
          keyind = keyind.replace(")", "");
          keyind = parseInt(keyind) + 1;

          if (keyvalue == " footer") {
            console.log(keyind);
            var myTab = document.getElementById('myTable');
            var objCells = myTab.rows.item(keyind).cells;
            var sno = objCells.item(0).innerHTML;
            var xaxisl = objCells.item(1).innerHTML;
            var yaxisl = objCells.item(2).innerHTML;
            var widthl = objCells.item(3).innerHTML;
            var heightl = objCells.item(4).innerHTML;
            var rotatel = objCells.item(5).innerHTML;
            var scalexl = objCells.item(6).innerHTML;
            var scaleyl = objCells.item(7).innerHTML;
            var fullwidthl = objCells.item(8).innerHTML;
            var fullheightl = objCells.item(9).innerHTML;
            var labell = objCells.item(10).innerHTML;
            var textl = objCells.item(11).innerHTML;
            var headerl = objCells.item(12).innerHTML;
            var hpositionl = objCells.item(13).innerHTML;
            var htoll = objCells.item(14).innerHTML;
            var footerl = objCells.item(15).innerHTML;
            var fpositionl = objCells.item(16).innerHTML;
            var ftoll = objCells.item(17).innerHTML;
            var ThreColl = objCells.item(18).innerHTML;
            var ColVall = objCells.item(19).innerHTML;
            var ThreVall = objCells.item(20).innerHTML;
            var Naturel = objCells.item(21).innerHTML;
            var Langl = objCells.item(22).innerHTML;
            var Keymappedl = objCells.item(23).innerHTML;
            var KeyVall = objCells.item(24).innerHTML;
            var KeySidel = objCells.item(25).innerHTML;
            var KeyToll = objCells.item(26).innerHTML;
            var leftindexl = objCells.item(27).innerHTML;
            var lipositionl = objCells.item(28).innerHTML;
            var litoll = objCells.item(29).innerHTML;

            var xaxisc = Math.round(xaxis);
            var yaxisc = Math.round(yaxis);
            var widthc = Math.round(width);
            var heightc = Math.round(height);

            var xaxisupdated = (parseInt(xaxisl) + parseInt(xaxisc)) / 2;
            var yaxisupdated = (parseInt(yaxisl) + parseInt(yaxisc)) / 2;
            var widthupdated = (parseInt(widthl) + parseInt(widthc)) / 2;
            var heightupdated = (parseInt(heightl) + parseInt(heightc)) / 2;

            ThreColl = ThreColl.replace(/^\s+|\s+$/g, '');

            if (isthre == false) {
              console.log("here");
              console.log(ThreColl);
              if (ThreColl == "false") {
                console.log("thre unchecked")
                var thresholdupdated = (parseInt(threshold) + parseInt(ThreVall)) / 2;
                var colorcutupdated = (parseInt(colorcut) + parseInt(ColVall)) / 2;
              } else if (ThreColl == "true") {
                console.log("thre checked")
                var thresholdupdated = threshold;
                var colorcutupdated = colorcut;
              }
            }
            updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring, isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
          }
        }
      }

      // recapturing left index
      function updateImageDisplayLeftIndex(indent) {
        var image = document.getElementById('output');
        cropper3 = new Cropper(image, {
          crop(event) {
            xaxis = event.detail.x;
            yaxis = event.detail.y;
            width = event.detail.width;
            height = event.detail.height;
            rotate = event.detail.rotate;
            scaleX = event.detail.scaleX;
            scaleY = event.detail.scaleY;
          }
        });

        var image = document.getElementById('output');
        document.getElementById("btnCrop").onclick = function (event) {
          fullwidth = image.width;
          fullheight = image.height;
          getcroppedpicenhanced(cropper3, fullheight, fullwidth, "leftindex", "label", "row");
        }
      }

      function showleftindexmodal(enhancedpic, fullheight, fullwidth, cropper) {
        document.getElementById("threcheckboxleftindex").checked = "true";
        $("#threoptionsleftindex").css("display", "none");
        cropper = cropperforenhance;
        $("#leftindexModal").modal();
        $("leftindexModal").ready(function () {

          $("#croppedimgleftindex").attr("src", "data:image/jpg;base64," + enhancedpic);
          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'extracttext', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "thumbnail": enhancedpic }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log("Status: " + xhr.status);
            } else {
              console.log(xhr.responseText);
              response = xhr.responseText;
              str = response.substring(response.indexOf("string\":"));
              str1 = str.substring(str.indexOf(":") + 3);
              str2 = str1.slice(0, -4);
              console.log(str2);
              foundstr = str2;
              if (str2 == "") {
                $('#foundtxtleftindex').val("Cannot extract text from this image");
              } else {
                $('#foundtxtleftindex').val(str2);
              }

            }
          };

        });

        document.getElementById("savedataleftindex").onclick = function (event) {
          var label = "-";
          var foundstring = $("#foundtxtleftindex").val();
          var ishead = "-";
          var isfoot = "-";
          var selhposition = "-";
          var selhtol = "-";
          var selfposition = "-";
          var selftol = "-";
          var textnature;
          var language;
          var iskey = "-";
          var keyval = "-";
          var isthre;
          var isleftindex = "true";
          var selliposition;
          var sellitol;
          var kposition = "-";
          var ktol = "-";

          if ($("#threcheckboxleftindex").prop('checked') == true) {
            isthre = true;
            var colorcut = "-";
            var threshold = "-";
          } else {
            isthre = false;
            var colorcut = document.getElementById("colorcutleftindex").value;
            var threshold = document.getElementById("colorcutleftindex").value;
          }

          textnature = $("#textnatureleftindex option:selected").val();
          language = $("#languageleftindex option:selected").val();

          selliposition = $("#liposition option:selected").val();
          sellitol = $("#litol option:selected").val();

          // alert(headerRowId);

          if (leftindexRowId != "null") {
            document.getElementById("myTable").deleteRow(leftindexRowId);
            count = count - 1;
          }


          updateTableforleftindex(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval);
          $('.checkbox').prop("checked", false);
          $("input:checkbox").prop("checked", false);
          $("p").text("Extracting text...");
          $("input:text").val("");
          $('#leftindexModal').modal('toggle');
          $("#btnCrop").css("display", "inline");
          $("#btnCreateModel").css("display", "inline");
          document.getElementById("threcheckboxleftindex").checked = "true";
          $("#threoptionsleftindex").css("display", "none");
          cropper3.destroy();

          var defthre = document.getElementById("defthreinput");
          var defcolcut = document.getElementById("defcolcutinput");
          var defdilate = document.getElementById("defdilatecutinput");
          var deferode = document.getElementById("deferodeinput");
          var defeyerangex = document.getElementById("defeyerangex");
          var defeyerangey = document.getElementById("defeyerangey");

          defthre.value = thre; 
          defcolcut.value = cocut;
          defdilate.value = dil;
          deferode.value = ero;
          defeyerangex.value = rangex;
          defeyerangey.value = rangey;

        }
      }

      function updateTableforleftindex(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language, iskey, kposition, ktol, keyval) {
        document.getElementById("capturedleftindex").innerHTML = foundstring;

        console.log(rownumarray);
        for (i in rownumarray) {
          var keylist = rownumarray[i];
          // console.log(label);

          keyvalue = keylist.substring(keylist.indexOf("(") + 1);
          keyvalue = keyvalue.substring(0, keyvalue.indexOf(' :'));

          keyind = keylist.substring(keylist.indexOf(":") + 1);
          keyind = keyind.replace(")", "");
          keyind = parseInt(keyind) + 1;

          if (keyvalue == " leftindex") {
            console.log(keyind);
            var myTab = document.getElementById('myTable');
            var objCells = myTab.rows.item(keyind).cells;
            var sno = objCells.item(0).innerHTML;
            var xaxisl = objCells.item(1).innerHTML;
            var yaxisl = objCells.item(2).innerHTML;
            var widthl = objCells.item(3).innerHTML;
            var heightl = objCells.item(4).innerHTML;
            var rotatel = objCells.item(5).innerHTML;
            var scalexl = objCells.item(6).innerHTML;
            var scaleyl = objCells.item(7).innerHTML;
            var fullwidthl = objCells.item(8).innerHTML;
            var fullheightl = objCells.item(9).innerHTML;
            var labell = objCells.item(10).innerHTML;
            var textl = objCells.item(11).innerHTML;
            var headerl = objCells.item(12).innerHTML;
            var hpositionl = objCells.item(13).innerHTML;
            var htoll = objCells.item(14).innerHTML;
            var footerl = objCells.item(15).innerHTML;
            var fpositionl = objCells.item(16).innerHTML;
            var ftoll = objCells.item(17).innerHTML;
            var ThreColl = objCells.item(18).innerHTML;
            var ColVall = objCells.item(19).innerHTML;
            var ThreVall = objCells.item(20).innerHTML;
            var Naturel = objCells.item(21).innerHTML;
            var Langl = objCells.item(22).innerHTML;
            var Keymappedl = objCells.item(23).innerHTML;
            var KeyVall = objCells.item(24).innerHTML;
            var KeySidel = objCells.item(25).innerHTML;
            var KeyToll = objCells.item(26).innerHTML;
            var leftindexl = objCells.item(27).innerHTML;
            var lipositionl = objCells.item(28).innerHTML;
            var litoll = objCells.item(29).innerHTML;

            var xaxisc = Math.round(xaxis);
            var yaxisc = Math.round(yaxis);
            var widthc = Math.round(width);
            var heightc = Math.round(height);

            var xaxisupdated = (parseInt(xaxisl) + parseInt(xaxisc)) / 2;
            var yaxisupdated = (parseInt(yaxisl) + parseInt(yaxisc)) / 2;
            var widthupdated = (parseInt(widthl) + parseInt(widthc)) / 2;
            var heightupdated = (parseInt(heightl) + parseInt(heightc)) / 2;

            ThreColl = ThreColl.replace(/^\s+|\s+$/g, '');

            if (isthre == false) {
              console.log("here");
              console.log(ThreColl);
              if (ThreColl == "false") {
                console.log("thre unchecked")
                var thresholdupdated = (parseInt(threshold) + parseInt(ThreVall)) / 2;
                var colorcutupdated = (parseInt(colorcut) + parseInt(ColVall)) / 2;
              } else if (ThreColl == "true") {
                console.log("thre checked")
                var thresholdupdated = threshold;
                var colorcutupdated = colorcut;
              }
            }
            updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring, isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
          }
        }
      }


      // preview image button clicked
      function getupdatedimage() {
        $('#foundtxt').val("Extracting updated text...");
        var inputthreshold = document.getElementById("colorcut").value;
        var inputcolorcut = document.getElementById("threshold").value;
        var imageData = cropperforenhance.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");
        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": inputthreshold, "colorcut": inputcolorcut }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            updatedstr = responseobj.updatedresultstring;
            $("#croppedimg").attr("src", "data:image/jpg;base64," + imagestr);
            $('#foundtxt').val(updatedstr);
          }
        };
      }

      function getupdatedimageforheader() {
        $('#foundtxtheader').val("Extracting updated text...");
        var inputthreshold = document.getElementById("colorcutheader").value;
        var inputcolorcut = document.getElementById("thresholdheader").value;
        var imageData = cropper1.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");
        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": inputthreshold, "colorcut": inputcolorcut }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            updatedstr = responseobj.updatedresultstring;
            $("#croppedimgheader").attr("src", "data:image/jpg;base64," + imagestr);
            $('#foundtxtheader').val(updatedstr);
          }
        };
      }

      function getupdatedimageforfooter() {
        $('#foundtxtfooter').val("Extracting updated text...");
        var inputthreshold = document.getElementById("colorcutfooter").value;
        var inputcolorcut = document.getElementById("thresholdfooter").value;
        var imageData = cropper2.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");
        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": inputthreshold, "colorcut": inputcolorcut }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            updatedstr = responseobj.updatedresultstring;
            $("#croppedimgfooter").attr("src", "data:image/jpg;base64," + imagestr);
            $('#foundtxtfooter').val(updatedstr);
          }
        };
      }

      function getupdatedimageforleftindex() {
        $('#foundtxtleftindex').val("Extracting updated text...");
        var inputthreshold = document.getElementById("colorcutleftindex").value;
        var inputcolorcut = document.getElementById("thresholdleftindex").value;
        // alert(inputcolorcut + "-------" + inputthreshold);
        var imageData = cropper3.getCroppedCanvas();
        var croppedimg = imageData.toDataURL("image/png");
        // console.log(croppedimg);

        var foundstr;
        var xhr = new XMLHttpRequest();

        xhr.open('POST', 'processcroppedimg', true);
        xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({ "thumbnail": croppedimg, "threshold": inputthreshold, "colorcut": inputcolorcut }));
        xhr.onreadystatechange = function () {
          if (xhr.readyState != 4) return;
          if (xhr.status != 200) {
            console.log("Status: " + xhr.status);
          } else {
            response = xhr.responseText;
            var responseobj = JSON.parse(response);
            imagestr = responseobj.imagestring;
            updatedstr = responseobj.updatedresultstring;
            $("#croppedimgleftindex").attr("src", "data:image/jpg;base64," + imagestr);
            $('#foundtxtleftindex').val(updatedstr);
          }
        };
      }

      
      function removeRow(oButton) {

        var empTab = document.getElementById('myTable');
        empTab.deleteRow(oButton.parentNode.parentNode.rowIndex);

        var empTab1 = document.getElementById('myTable1');
        empTab1.deleteRow(oButton.parentNode.parentNode.rowIndex);

        count = count - 1;
      }

      function sendtoinitialimageprocess(file){

        // resize()

        var threshold = parseInt(document.getElementById("defthreinput").value);
        var colorcut = parseInt(document.getElementById("defcolcutinput").value);

        var dilate = parseInt(document.getElementById("defdilatecutinput").value);
        var erode = parseInt(document.getElementById("deferodeinput").value);

        var indent = "retrain" 

        // var defeyerangex = document.getElementById("defeyerangex");
        // var defeyerangey = document.getElementById("defeyerangey");

        imagefile = file;

        base64(file, function(data){
          var imagestring = data.base64;
          // console.log(imagestring);

          var foundstr;
          var xhr = new XMLHttpRequest();

          xhr.open('POST', 'initialimageprocess', true);
          xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
          xhr.send(JSON.stringify({ "originalwidth": originalwidth, "originalheight": originalheight, "indent": indent, "thumbnail": imagestring, "threshold": threshold, "colorcut": colorcut, "dilate": dilate, "erode": erode }));
          xhr.onreadystatechange = function () {
            if (xhr.readyState != 4) return;
            if (xhr.status != 200) {
              console.log(xhr.responseText);
              console.log("Status: " + xhr.status);
            } else {
              // console.log(xhr.responseText);
              response = xhr.responseText;
              var responseobj = JSON.parse(response);
              imagestr = responseobj.imagestring;
              withboxesimagestr = responseobj.withboxes;
            
              // console.log(imagestr);
              $("#output").attr("src", "data:image/jpg;base64," + imagestr);
              $("#output2").attr("src", "data:image/jpg;base64," + withboxesimagestr);
              $("#output").attr("width", originalwidth);
              $("#output").attr("height", originalheight);
              $("#output2").attr("width", originalwidth);
              $("#output2").attr("height", originalheight);
              // resize()
            }
          };
        })
      }

      function base64(file, callback){
        var coolFile = {};
        function readerOnload(e){
          var base64 = btoa(e.target.result);
          coolFile.base64 = base64;
          callback(coolFile)
        };

        var reader = new FileReader();
        reader.onload = readerOnload;

        coolFile.filetype = file.type;
        coolFile.size = file.size;
        coolFile.filename = file.name;
        reader.readAsBinaryString(file);
      }

      function toggleboxes(){
        if ($("#toggleboxescheckbox").prop('checked') == true) {
          console.log("show")
          var output = document.getElementById('imgoutput');
          var output2 = document.getElementById('imgoutput2');
          output2.style.display = "inline";
          output.style.display = "none";
          // $("#imgoutput2").css("display", "inline");
          // $("#imgoutput").css("display", "block");
        } else {
          console.log("hide")
          var output = document.getElementById('imgoutput');
          var output2 = document.getElementById('imgoutput2');
          output2.style.display = "none";
          output.style.display = "inline";
          // $("#imgoutput").css("display", "inline");
          // $("#imgoutput2").css("display", "block");
        }
      }

      function imageupdatebtn(){
        // console.log(imagefile);
        // threshold = document.getElementById("defthreinput").value;
        // colorcut = document.getElementById("defcolcutinput").value;

        // dialte = document.getElementById("defdilatecutinput").value;
        // erode = document.getElementById("deferodeinput").value;

        sendtoinitialimageprocess(imagefile)
      }
      

      // load last image used to train model
      function loadlastimageusedtotrain(){
        $("#output").attr("src", "static/imagesusedfortraining/" + modelname + "/withoutboxes.jpg");
        $("#output2").attr("src", "static/imagesusedfortraining/" + modelname + "/withboxes.jpg");
      }
    
      function dataURItoBlob(dataURI) {
        // convert base64/URLEncoded data component to raw binary data held in a string
        var byteString;
        if (dataURI.split(',')[0].indexOf('base64') >= 0)
            byteString = atob(dataURI.split(',')[1]);
        else
            byteString = unescape(dataURI.split(',')[1]);
        // separate out the mime component
        var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
        // write the bytes of the string to a typed array
        var ia = new Uint8Array(byteString.length);
        for (var i = 0; i < byteString.length; i++) {
            ia[i] = byteString.charCodeAt(i);
        }
        return new Blob([ia], {type:mimeString});
      }
    
      function createnewrow(rowcount, rowcount1) {

        // var table1 = document.getElementById("myTable1");
        // var row = table1.insertRow();
        // var cell1 = row.insertCell(0);
        // var cell2 = row.insertCell(1);
        // var cell3 = row.insertCell(2);

        // var button = document.createElement('input');

        // button.setAttribute('type', 'button');
        // button.setAttribute('value', 'X');
        // button.setAttribute('onclick', 'removeRow(this)');

        // cell3.appendChild(button);

        var table = document.getElementById("myTable");
        var row = table.insertRow(rowcount);

        for (i=1;i<44;i++){
          var cell = row.insertCell(i-1);
          if (i == 43){
            // var button = document.createElement('input');
            // button.setAttribute('type', 'button');
            // button.setAttribute('value', 'Remove');
            // button.setAttribute('onclick', 'removeRow(this)');
            // cell.appendChild(button);
          } else if (i == 1){
            cell.innerHTML = count - 1;
          }
        }
      }
    
      function closecropper(){
        try {
          $("#btnCrop").css("display", "none");
          $("#btnCloseCropper").css("display", "none");
          $("#btnCreateModel").css("display", "inline");

          cropper.destroy();
          cropper1.destroy();
          cropper2.destroy();
          cropper3.destroy();
        } catch (error) {
          console.log(error);
        }
        
      }
    
  // var count = 2;
  // var xaxis;
  // var yaxis;
  // var width;
  // var heigth;
  // var rotate;
  // var scaleX;
  // var scaleY;
  // var fullheight;
  // var fullwidth;
  // var cropper;
  // var cropper1;
  // var cropperforenhance;
  // var paramcount = 1
  // var headerRowId = "null";
  // var footerRowId = "null";
  // var leftindexRowId = "null";
  // var originalwidth;
  // var originalheight;
  // var rownumarray = [];
  // var indexcount = 1;
  // var headerxaxis = 0;
  // var headeryaxis = 0;
  // var leftindexxaxis = 0;
  // var leftindexyaxis = 0;
  // var modelname = localStorage.getItem("modelname");
  // var thre;
  // var cocut;
  // var dil;
  // var ero;
  // var rangex;
  // var rangey;

  // // load image      
  // loadlastimageusedtotrain();

  // // initial executions
  // getimagedimensions(modelname);

  // function getimagedimensions(modelname) {
  //   if (modelname == "") {
  //     alert("Model name not found");
  //   } else {
  //     var http = new XMLHttpRequest();
  //     var url = 'getimagedimensions';
  //     var params = 'modelname=' + modelname;
  //     http.open('POST', url, true);
  //     http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
  //     http.onreadystatechange = function () {
  //       if (http.readyState == 4 && http.status == 200) {
  //         if (http.status == 200) {
  //           var array = JSON.parse(http.response);
  //           originalwidth = array[0];
  //           originalheight = array[1];
  //           console.log(originalwidth + " " + originalheight);
  //         } else {
  //           alert("failed to get original image size")
  //         }
  //       }
  //     }
  //     http.send(params);
  //   }
  // }

  // function resize() {
  //   //define the width to resize e.g 600px
  //   var resize_width = originalwidth; //without px

  //   //get the image selected
  //   var item = document.querySelector('#inputId').files[0];

  //   //create a FileReader
  //   var reader = new FileReader();

  //   //image turned to base64-encoded Data URI.
  //   reader.readAsDataURL(item);
  //   reader.name = item.name; //get the image's name
  //   reader.size = item.size; //get the image's size
  //   reader.onload = function (event) {
  //     var img = new Image(); //create a image
  //     img.src = event.target.result; //result is base64-encoded Data URI
  //     img.name = event.target.name; //set name (optional)
  //     img.size = event.target.size; //set size (optional)
  //     img.onload = function (el) {
  //       var elem = document.createElement('canvas'); //create a canvas

  //       //scale the image to 600 (width) and keep aspect ratio
  //       var scaleFactor = resize_width / el.target.width;
  //       elem.width = resize_width;
  //       elem.height = originalheight;

  //       //draw in canvas
  //       var ctx = elem.getContext('2d');
  //       ctx.drawImage(el.target, 0, 0, elem.width, elem.height);

  //       //get the base64-encoded Data URI from the resize image
  //       var srcEncoded = ctx.canvas.toDataURL(el.target, 'image/jpeg', 0);

  //       //assign it to thumb src
  //       document.querySelector('#output').src = srcEncoded;
  //     }
  //   }
  // }

  // $(document).ready(function () {
  //   getoldheadandleft(modelname);

  //   var output2 = document.getElementById('imgoutput2');
  //   output2.style.display = "none";

  //   $("#headeroptions").css("display", "none");
  //   $("#footeroptions").css("display", "none");
  //   $("#keyoptions").css("display", "none");
  //   $("#threoptions").css("display", "none");
  //   $("#thrediv").css("display", "block");
  //   $("#headeroptions").css("display", "none");
  //   $("#footeroptions").css("display", "none");

  //   var http = new XMLHttpRequest();
  //   var url = 'fetchexistingmodel';
  //   var params = 'modelname=' + modelname;
  //   http.open('POST', url, true);

  //   http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

  //   http.onreadystatechange = function () {
  //     if (http.readyState == 4 && http.status == 200) {
  //       if (http.status == 200) {
  //         responselist = http.response;
  //         console.log(responselist);
  //         initialtableupdate(responselist);
  //         initialtableupdate1(modelname);
  //       } else {
  //         alert("failed to get original image size")
  //       }
  //     }
  //   }
  //   http.send(params);

  // });

  // function initialtableupdate(array) {
  //   var rowcount;
  //   var rowcount1;
  //   var array = responselist.split(")");

  //   for (i in array) {
  //     row = array[i];
  //     row = row.toString();
  //     row = row.replace("[", "");
  //     row = row.replace("]", "");
  //     row = row.replace(", (", "");
  //     row = row.replace("(", "");

  //     var rowarray = row.split(",");
  //     rowcount = document.getElementById("myTable").rows.length;
  //     rowcount1 = document.getElementById("myTable1").rows.length;

  //     if (rowarray.length != 1) {
  //       if (rowarray[12] == " 'true'") {
  //         $("#btnheadcapture").css("display", "none");
  //         $("#capturedHead").css("display", "table-cell");
  //         $("#btnHeadRecap").css("display", "table-cell");
  //         document.getElementById("capturedHead").innerHTML = rowarray[11].replace(/\'/g, "", 2);
  //       }

  //       if (rowarray[15] == " 'true'") {
  //         $("#btnfootercapture").css("display", "none");
  //         $("#capturedFoot").css("display", "table-cell");
  //         $("#btnFootRecap").css("display", "table-cell");
  //         document.getElementById("capturedFoot").innerHTML = rowarray[11].replace(/\'/g, "", 2);
  //       }

  //       if (rowarray[27] == " 'true'") {
  //         $("#btnleftindexcapture").css("display", "none");
  //         $("#capturedleftindex").css("display", "table-cell");
  //         $("#btnLeftIndexRecap").css("display", "table-cell");
  //         document.getElementById("capturedleftindex").innerHTML = rowarray[11].replace(/\'/g, "", 2);
  //       }
  //       initialcreatenewrow(rowarray, rowcount, rowcount1);
  //       initialtableupdatewithvalues(rowarray, rowcount, rowcount1);
  //     }
  //   }
  // }

  // function initialcreatenewrow(rowarray, rowcount, rowcount1) {
  //   if (rowarray[10] != " '-'") {
  //     var table1 = document.getElementById("myTable1");
  //     var row = table1.insertRow();
  //     var cell1 = row.insertCell(0);
  //     var cell2 = row.insertCell(1);
  //     var cell3 = row.insertCell(2);
  //     var btnhtml = '<button onclick = "showcropper(this)"><i class="fa fa-refresh"></i></button>';
  //     cell3.innerHTML = btnhtml;
  //   }

  //   var table = document.getElementById("myTable");
  //   var row = table.insertRow(rowcount);

  //   for (i = 1; i < 35; i++) {
  //     var cell = row.insertCell(i - 1);
  //     if (i == 34) {
  //       var button = document.createElement('input');
  //       button.setAttribute('type', 'button');
  //       button.setAttribute('value', 'Remove');
  //       button.setAttribute('onclick', 'removeRow(this)');
  //       cell.appendChild(button);
  //     } else if (i == 1) {
  //       cell.innerHTML = count - 1;
  //     }
  //   }

  // }

  // function initialtableupdatewithvalues(rowarray, rowcount, rowcount1) {

  //   if (rowarray[10] != " '-'") {
  //     var myTable1 = document.getElementById('myTable1');
  //     myTable1.rows[rowcount1].cells[0].innerHTML = rowarray[10].replace(/\'/g, "", 2);;
  //   }

  //   var myTable = document.getElementById('myTable');

  //   myTable.rows[rowcount].cells[0].innerHTML = rowarray[0].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[1].innerHTML = rowarray[1].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[2].innerHTML = rowarray[2].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[3].innerHTML = rowarray[3].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[4].innerHTML = rowarray[4].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[5].innerHTML = rowarray[5].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[6].innerHTML = rowarray[6].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[7].innerHTML = rowarray[7].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[8].innerHTML = rowarray[8].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[9].innerHTML = rowarray[9].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[10].innerHTML = rowarray[10].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[11].innerHTML = rowarray[11].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[12].innerHTML = rowarray[12].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[13].innerHTML = rowarray[13].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[14].innerHTML = rowarray[14].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[15].innerHTML = rowarray[15].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[16].innerHTML = rowarray[16].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[17].innerHTML = rowarray[17].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[18].innerHTML = rowarray[18].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[19].innerHTML = rowarray[19].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[20].innerHTML = rowarray[20].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[21].innerHTML = rowarray[21].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[22].innerHTML = rowarray[22].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[23].innerHTML = rowarray[23].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[24].innerHTML = rowarray[24].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[25].innerHTML = rowarray[25].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[26].innerHTML = rowarray[26].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[27].innerHTML = rowarray[27].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[28].innerHTML = rowarray[28].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[29].innerHTML = rowarray[29].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[30].innerHTML = rowarray[30].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[31].innerHTML = rowarray[31].replace(/\'/g, "", 2);
  //   myTable.rows[rowcount].cells[32].innerHTML = rowarray[32].replace(/\'/g, "", 2);

  //   if (rowarray[12].replace(/\'/g, "", 2) == " true") {
  //     var bulidstr = "( header : " + indexcount + ")";
  //     rownumarray.push(bulidstr);
  //     indexcount = indexcount + 1;
  //   } else if (rowarray[15].replace(/\'/g, "", 2) == " true") {
  //     var bulidstr = "( footer : " + indexcount + ")";
  //     rownumarray.push(bulidstr);
  //     indexcount = indexcount + 1;
  //   } else if (rowarray[27].replace(/\'/g, "", 2) == " true") {
  //     var bulidstr = "( leftindex : " + indexcount + ")";
  //     rownumarray.push(bulidstr);
  //     indexcount = indexcount + 1;
  //   } else {
  //     var bulidstr = "(" + rowarray[10].replace(/\'/g, "", 2) + " : " + indexcount + ")";
  //     rownumarray.push(bulidstr);
  //     indexcount = indexcount + 1;
  //   }

  // }

  // function initialtableupdate1(modelname) {
  //   var http1 = new XMLHttpRequest();
  //   var url1 = 'fetchexistingmodelmetadata';
  //   var params1 = 'modelname=' + modelname;
  //   http1.open('POST', url1, true);
  //   http1.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
  //   http1.onreadystatechange = function () {
  //     if (http1.readyState == 4 && http1.status == 200) {
  //       if (http1.status == 200) {
  //         modelsresponse = http1.response;
  //         console.log(modelsresponse);

  //         var array = modelsresponse.split(")");
  //         console.log(array[0]);
  //         row = array[0];
  //         row = row.toString();
  //         row = row.replace("[", "");
  //         row = row.replace("]", "");
  //         row = row.replace(", (", "");
  //         row = row.replace("(", "");

  //         var rowarray = row.split(",");
  //         console.log(rowarray);

  //         var defthre = document.getElementById("defthreinput");
  //         var defcolcut = document.getElementById("defcolcutinput");
  //         var defdilate = document.getElementById("defdilatecutinput");
  //         var deferode = document.getElementById("deferodeinput");
  //         var defeyerangex = document.getElementById("defeyerangex");
  //         var defeyerangey = document.getElementById("defeyerangey");

  //         thre = rowarray[8].replace(/ |'/g, "");
  //         cocut = rowarray[9].replace(/ |'/g, "");
  //         dil = rowarray[15].replace(/ |'/g, "");
  //         ero = rowarray[16].replace(/ |'/g, "");
  //         rangex = rowarray[10].replace(/ |'/g, "");
  //         rangey = rowarray[11].replace(/ |'/g, "");

  //         defthre.value = thre;
  //         defcolcut.value = cocut;
  //         defdilate.value = dil;
  //         deferode.value = ero;
  //         defeyerangex.value = rangex;
  //         defeyerangey.value = rangey;

  //       } else {
  //         alert("failed to get original image size")
  //       }
  //     }
  //   }
  //   http1.send(params1);
  // }


  // $(function () {
  //   $('#closebtn').click(function () {
  //     $('.checkbox').prop("checked", false);
  //     $("input:checkbox").prop("checked", false);
  //     $("p").text("Extracting text...");
  //     $("input:text").val("");
  //     $("#headerdiv").css("display", "block");
  //     $("#footerdiv").css("display", "block");
  //     $("#footeroptions").css("display", "none");
  //     $("#headeroptions").css("display", "none");
  //   });
  // });



  // // retrain button clicked
  // function getnewtable() {
  //   var myTab = document.getElementById('myTable');
  //   for (i = 2; i < myTab.rows.length; i++) {
  //     var objCells = myTab.rows.item(i).cells;

  //     var sno = objCells.item(0).innerHTML;
  //     var xaxisl = objCells.item(1).innerHTML;
  //     var yaxisl = objCells.item(2).innerHTML;
  //     var widthl = objCells.item(3).innerHTML;
  //     var heightl = objCells.item(4).innerHTML;
  //     var rotatel = objCells.item(5).innerHTML;
  //     var scalexl = objCells.item(6).innerHTML;
  //     var scaleyl = objCells.item(7).innerHTML;
  //     var fullwidthl = objCells.item(8).innerHTML;
  //     var fullheightl = objCells.item(9).innerHTML;
  //     var labell = objCells.item(10).innerHTML;
  //     var textl = objCells.item(11).innerHTML;
  //     var headerl = objCells.item(12).innerHTML;
  //     var hpositionl = objCells.item(13).innerHTML;
  //     var htoll = objCells.item(14).innerHTML;
  //     var footerl = objCells.item(15).innerHTML;
  //     var fpositionl = objCells.item(16).innerHTML;
  //     var ftoll = objCells.item(17).innerHTML;
  //     var isthre = objCells.item(18).innerHTML;
  //     var colorcut = objCells.item(19).innerHTML;
  //     var threshold = objCells.item(20).innerHTML;
  //     var textnature = objCells.item(21).innerHTML;
  //     var language = objCells.item(22).innerHTML;
  //     var iskey = objCells.item(23).innerHTML;
  //     var kposition = objCells.item(24).innerHTML;
  //     var ktol = objCells.item(25).innerHTML;
  //     var keyval = objCells.item(26).innerHTML;
  //     var leftindex = objCells.item(27).innerHTML;
  //     var liposition = objCells.item(28).innerHTML;
  //     var litol = objCells.item(29).innerHTML;

  //     if (headerl == "undefined") {
  //       headerl = "-";
  //     }
  //     if (hpositionl == "undefined") {
  //       hpositionl = "-";
  //     }
  //     if (htoll == "undefined") {
  //       htoll = "-";
  //     }
  //     if (footerl == "undefined") {
  //       footerl = "-";
  //     }
  //     if (fpositionl == "undefined") {
  //       fpositionl = "-";
  //     }
  //     if (ftoll == "undefined") {
  //       ftoll = "-";
  //     }
  //     if (colorcut == "undefined") {
  //       colorcut = "-";
  //     }
  //     if (threshold == "undefined") {
  //       threshold = "-";
  //     }
  //     if (liposition == "undefined") {
  //       liposition = "-";
  //     }
  //     if (litol == "undefined") {
  //       litol = "-";
  //     }
  //     if (kposition == "undefined") {
  //       kposition = "-";
  //     }
  //     if (ktol == "undefined") {
  //       ktol = "-";
  //     }
  //     if (keyval == "undefined") {
  //       keyval = "-";
  //     }
  //     console.log(xaxisl + " " + yaxisl + " " + widthl + " " + heightl + " " + labell);

  //     sendnewdata(xaxisl, yaxisl, widthl, heightl, rotatel, scalexl, scaleyl, fullwidthl, fullheightl, labell, textl,
  //       headerl, hpositionl, htoll, footerl, fpositionl, ftoll, isthre, colorcut, threshold, textnature, language,
  //       iskey, kposition, ktol, keyval, leftindex, liposition, litol);

  //   }
  // }

  // function getoldheadandleft(model) {
  //   var http = new XMLHttpRequest();
  //   var url = 'getoldheadleft';
  //   var params = 'model=' + model;
  //   http.open('POST', url, true);

  //   http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

  //   http.onreadystatechange = function () {
  //     if (http.readyState == 4 && http.status == 200) {
  //       if (http.status == 200) {
  //         response = http.responseText;
  //         console.log(response);
  //         // response = http.responseText;
  //         var responseobj = JSON.parse(response);
  //         axes = responseobj.string;
  //         axes = axes.replace("[", "");
  //         axes = axes.replace("]", "");
  //         axes = axes.replace(/'/g, "");
  //         axes = axes.replace(" ", "");
  //         axes = axes.split(",");
  //         headeryaxis = parseInt(axes[0]);
  //         leftindexxaxis = parseInt(axes[1]);
  //         console.log(headeryaxis);
  //         console.log(leftindexxaxis);
  //       } else {
  //         alert("failed to get data")
  //       }
  //     }
  //   }
  //   http.send(params);
  // }

  // function sendnewdata(xaxisl, yaxisl, widthl, heightl, rotatel, scalexl, scaleyl, fullwidthl, fullheightl, labell,
  //   textl, headerl, hpositionl, htoll, footerl, fpositionl, ftoll, isthre, colorcut, threshold, textnature, language,
  //   iskey, kposition, ktol, keyval, leftindex, liposition, litol) {
  //   if (labell != " -") {
  //     var formdata = new FormData();
  //     formdata.append('label', labell);
  //     formdata.append('xaxis', xaxisl);
  //     formdata.append('yaxis', yaxisl);
  //     formdata.append('width', widthl);
  //     formdata.append('height', heightl);

  //     formdata.append('rotate', rotatel);
  //     formdata.append('scalex', scalexl);
  //     formdata.append('scaley', scaleyl);
  //     formdata.append('fullwidth', fullwidthl);
  //     formdata.append('fullheight', fullheightl);

  //     formdata.append('text', textl);
  //     formdata.append('header', headerl);
  //     formdata.append('hposition', hpositionl);
  //     formdata.append('htol', htoll);
  //     formdata.append('footer', footerl);

  //     formdata.append('fposition', fpositionl);
  //     formdata.append('ftol', ftoll);
  //     formdata.append('isthre', isthre);
  //     formdata.append('colorcut', colorcut);
  //     formdata.append('threshold', threshold);

  //     formdata.append('textnature', textnature);
  //     formdata.append('language', language);
  //     formdata.append('iskey', iskey);
  //     formdata.append('kposition', kposition);
  //     formdata.append('ktol', ktol);

  //     formdata.append('keyval', keyval);
  //     formdata.append('leftindex', leftindex);
  //     formdata.append('liposition', liposition);
  //     formdata.append('litol', litol);
  //     formdata.append('model', modelname);

  //     fetch('retrain', {
  //       // mode: 'no-cors',
  //       method: 'POST',
  //       body: formdata
  //     }).then(
  //       function (response) {
  //         if (response.status !== 200) {
  //           console.log('Looks like there was a problem. Status Code: ' + response.status);
  //           return;
  //         } else if (response.status == 200) {
  //           return response.text().then(function (text) {
  //             alert(text);
  //           });
  //         }
  //       }
  //     ).catch(function (err) {
  //       console.log('Fetch Error :-S', err);
  //     });
  //   } else if (headerl == " true") {
  //     var formdata = new FormData();
  //     formdata.append('label', labell);
  //     formdata.append('xaxis', xaxisl);
  //     formdata.append('yaxis', yaxisl);
  //     formdata.append('width', widthl);
  //     formdata.append('height', heightl);

  //     formdata.append('rotate', rotatel);
  //     formdata.append('scalex', scalexl);
  //     formdata.append('scaley', scaleyl);
  //     formdata.append('fullwidth', fullwidthl);
  //     formdata.append('fullheight', fullheightl);

  //     formdata.append('text', textl);
  //     formdata.append('header', headerl);
  //     formdata.append('hposition', hpositionl);
  //     formdata.append('htol', htoll);
  //     formdata.append('footer', footerl);

  //     formdata.append('fposition', fpositionl);
  //     formdata.append('ftol', ftoll);
  //     formdata.append('isthre', isthre);
  //     formdata.append('colorcut', colorcut);
  //     formdata.append('threshold', threshold);

  //     formdata.append('textnature', textnature);
  //     formdata.append('language', language);
  //     formdata.append('iskey', iskey);
  //     formdata.append('kposition', kposition);
  //     formdata.append('ktol', ktol);

  //     formdata.append('keyval', keyval);
  //     formdata.append('leftindex', leftindex);
  //     formdata.append('liposition', liposition);
  //     formdata.append('litol', litol);
  //     formdata.append('model', modelname);

  //     fetch('retrainheader', {
  //       // mode: 'no-cors',
  //       method: 'POST',
  //       body: formdata
  //     }).then(
  //       function (response) {
  //         if (response.status !== 200) {
  //           console.log('Looks like there was a problem. Status Code: ' + response.status);
  //           return;
  //         } else if (response.status == 200) {
  //           return response.text().then(function (text) {
  //             alert(text);
  //           });
  //         }
  //       }
  //     ).catch(function (err) {
  //       console.log('Fetch Error :-S', err);
  //     });
  //   } else if (footerl == " true") {
  //     var formdata = new FormData();
  //     formdata.append('label', labell);
  //     formdata.append('xaxis', xaxisl);
  //     formdata.append('yaxis', yaxisl);
  //     formdata.append('width', widthl);
  //     formdata.append('height', heightl);

  //     formdata.append('rotate', rotatel);
  //     formdata.append('scalex', scalexl);
  //     formdata.append('scaley', scaleyl);
  //     formdata.append('fullwidth', fullwidthl);
  //     formdata.append('fullheight', fullheightl);

  //     formdata.append('text', textl);
  //     formdata.append('header', headerl);
  //     formdata.append('hposition', hpositionl);
  //     formdata.append('htol', htoll);
  //     formdata.append('footer', footerl);

  //     formdata.append('fposition', fpositionl);
  //     formdata.append('ftol', ftoll);
  //     formdata.append('isthre', isthre);
  //     formdata.append('colorcut', colorcut);
  //     formdata.append('threshold', threshold);

  //     formdata.append('textnature', textnature);
  //     formdata.append('language', language);
  //     formdata.append('iskey', iskey);
  //     formdata.append('kposition', kposition);
  //     formdata.append('ktol', ktol);

  //     formdata.append('keyval', keyval);
  //     formdata.append('leftindex', leftindex);
  //     formdata.append('liposition', liposition);
  //     formdata.append('litol', litol);
  //     formdata.append('model', modelname);

  //     fetch('retrainfooter', {
  //       // mode: 'no-cors',
  //       method: 'POST',
  //       body: formdata
  //     }).then(
  //       function (response) {
  //         if (response.status !== 200) {
  //           console.log('Looks like there was a problem. Status Code: ' + response.status);
  //           return;
  //         } else if (response.status == 200) {
  //           return response.text().then(function (text) {
  //             alert(text);
  //           });
  //         }
  //       }
  //     ).catch(function (err) {
  //       console.log('Fetch Error :-S', err);
  //     });
  //   } else if (leftindex == " true") {
  //     var formdata = new FormData();
  //     formdata.append('label', labell);
  //     formdata.append('xaxis', xaxisl);
  //     formdata.append('yaxis', yaxisl);
  //     formdata.append('width', widthl);
  //     formdata.append('height', heightl);

  //     formdata.append('rotate', rotatel);
  //     formdata.append('scalex', scalexl);
  //     formdata.append('scaley', scaleyl);
  //     formdata.append('fullwidth', fullwidthl);
  //     formdata.append('fullheight', fullheightl);

  //     formdata.append('text', textl);
  //     formdata.append('header', headerl);
  //     formdata.append('hposition', hpositionl);
  //     formdata.append('htol', htoll);
  //     formdata.append('footer', footerl);

  //     formdata.append('fposition', fpositionl);
  //     formdata.append('ftol', ftoll);
  //     formdata.append('isthre', isthre);
  //     formdata.append('colorcut', colorcut);
  //     formdata.append('threshold', threshold);

  //     formdata.append('textnature', textnature);
  //     formdata.append('language', language);
  //     formdata.append('iskey', iskey);
  //     formdata.append('kposition', kposition);
  //     formdata.append('ktol', ktol);

  //     formdata.append('keyval', keyval);
  //     formdata.append('leftindex', leftindex);
  //     formdata.append('liposition', liposition);
  //     formdata.append('litol', litol);
  //     formdata.append('model', modelname);

  //     fetch('retrainleftindex', {
  //       // mode: 'no-cors',
  //       method: 'POST',
  //       body: formdata
  //     }).then(
  //       function (response) {
  //         if (response.status !== 200) {
  //           console.log('Looks like there was a problem. Status Code: ' + response.status);
  //           return;
  //         } else if (response.status == 200) {
  //           return response.text().then(function (text) {
  //             alert(text);
  //           });
  //         }
  //       }
  //     ).catch(function (err) {
  //       console.log('Fetch Error :-S', err);
  //     });
  //   }
  // }

  // // toggle options
  // function showheaderoptions(obj) {
  //   if ($(obj).is(":checked")) {
  //     $("#headeroptions").css("display", "inline");
  //     $("#footerdiv").css("display", "none");
  //     $("#page-header-inner").addClass("sticky");
  //   } else {
  //     $("#headeroptions").css("display", "none");
  //     $("#footerdiv").css("display", "block");
  //   }
  // }

  // function showfooteroptions(obj) {
  //   if ($(obj).is(":checked")) {
  //     $("#footeroptions").css("display", "inline");
  //     $("#page-header-inner").addClass("sticky");
  //     $("#headerdiv").css("display", "none");
  //   } else {
  //     $("#footeroptions").css("display", "none");
  //     $("#headerdiv").css("display", "block");
  //   }
  // }

  // function showkeyoptions(obj) {
  //   if ($(obj).is(":checked")) {
  //     $("#keyoptions").css("display", "inline");
  //   } else {
  //     $("#keyoptions").css("display", "none");
  //     $("#keydiv").css("display", "block");
  //   }
  // }

  // function showthreoptions(obj) {
  //   if ($(obj).is(":checked")) {
  //     $("#threoptions").css("display", "none");
  //     $("#thrediv").css("display", "block");

  //     $("#threoptionsheader").css("display", "none");
  //     $("#thredivheader").css("display", "block");

  //     $("#threoptionsfooter").css("display", "none");
  //     $("#thredivfooter").css("display", "block");

  //     $("#threoptionsleftindex").css("display", "none");
  //     $("#thredivleftindex").css("display", "block");
  //   } else {
  //     $("#threoptions").css("display", "inline");
  //     $("#threoptionsheader").css("display", "inline");
  //     $("#threoptionsfooter").css("display", "inline");
  //     $("#threoptionsleftindex").css("display", "inline");
  //   }
  // }

  // // recapture button clicked
  // function showcropper(fullrow) {
  //    try {
  //       closecropper();
  //     } catch (error) {
  //       console.log("no cropper to close");
  //     }

  //     $("#btnCrop").css("display", "inline");
  //     $("#btnCloseCropper").css("display", "inline");
  //     $("#btnCreateModel").css("display", "none");

  //     row = fullrow.parentNode.parentNode.rowIndex;
  //     if (row > 2) {
  //       var label = document.getElementById("myTable1").rows[row].cells.item(0).innerHTML;
  //       updateImageDisplay("parameter", label, row)
  //     }
  //   // row = fullrow.parentNode.parentNode.rowIndex;
  //   // if (row > 2) {
  //   //   var label = document.getElementById("myTable1").rows[row].cells.item(0).innerHTML;
  //   //   updateImageDisplay("parameter", label, row)
  //   // }
  // }

  // function updateImageDisplay(indent, label, row) {

  //   var image = new Image();
  //   image.width = originalwidth;
  //   image.height = originalheight;

  //   image = document.getElementById('output');

  //   console.log(row);
  //   row = parseInt(row)-1;
  //   console.log(row);

  //   var mainTable = document.getElementById('myTable');
  //   // label = mainTable.rows[parseInt(row)];

  //   originalx = parseInt($('#myTable tr:eq(' + row + ') td:eq(1)').text());
  //   originaly = parseInt($('#myTable tr:eq(' + row + ') td:eq(2)').text());
  //   originalw = parseInt($('#myTable tr:eq(' + row + ') td:eq(3)').text());
  //   originalh = parseInt($('#myTable tr:eq(' + row + ') td:eq(4)').text());

  //   // var val1 =$(t).find('tr:eq(2) td:eq(4)').text();
  //   // alert(val1);

  //   // console.log(label);

  //   cropper = new Cropper(image, {
  //     data:{
  //       x: originalx,
  //       y: originaly,
  //       width: originalw,
  //       height: originalh,
  //     },
  //     crop(event) {
  //       cropper.width = originalwidth;
  //       cropper.height = originalheight;
  //       xaxis = event.detail.x;
  //       yaxis = event.detail.y;
  //       width = event.detail.width;
  //       height = event.detail.height;
  //       rotate = event.detail.rotate;
  //       scaleX = event.detail.scaleX;
  //       scaleY = event.detail.scaleY;
  //     }
  //   });

  //   // data = {"left":100,"top":50,"width":200,"height":20};

  //   // data:{width : 240, height : 507, },

  //   // cropper.setCropBoxData({width : 100, height : 100, });

  //   document.getElementById("btnCrop").onclick = function (event) {
  //     fullwidth = image.width;
  //     fullheight = image.height;
  //     cropperforenhance = cropper;
  //     getcroppedpicenhanced(cropper, fullheight, fullwidth, indent, label, row);
  //   }
  //   // var image = new Image();
  //   // image.width = originalwidth;
  //   // image.height = originalheight;

  //   // image = document.getElementById('output');
  //   // cropper = new Cropper(image, {
  //   //   crop(event) {
  //   //     cropper.width = originalwidth;
  //   //     cropper.height = originalheight;
  //   //     xaxis = event.detail.x;
  //   //     yaxis = event.detail.y;
  //   //     width = event.detail.width;
  //   //     height = event.detail.height;
  //   //     rotate = event.detail.rotate;
  //   //     scaleX = event.detail.scaleX;
  //   //     scaleY = event.detail.scaleY;
  //   //   }
  //   // });

  //   // document.getElementById("btnCrop").onclick = function (event) {
  //   //   fullwidth = image.width;
  //   //   fullheight = image.height;
  //   //   cropperforenhance = cropper;
  //   //   getcroppedpicenhanced(cropper, fullheight, fullwidth, indent, label, row);
  //   // }

  // }

  // function getcroppedpicenhanced(cropper, fullheight, fullwidth, indent, label, row) {
  //   var imageData = cropper.getCroppedCanvas();
  //   var croppedimg = imageData.toDataURL("image/png");
  //   var foundstr;
  //   var xhr = new XMLHttpRequest();

  //   xhr.open('POST', 'processcroppedimg', true);
  //   xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //   xhr.send(JSON.stringify({
  //     "thumbnail": croppedimg,
  //     "threshold": 125,
  //     "colorcut": 100
  //   }));
  //   xhr.onreadystatechange = function () {
  //     if (xhr.readyState != 4) return;
  //     if (xhr.status != 200) {
  //       console.log("Status: " + xhr.status);
  //     } else {
  //       // console.log(xhr.responseText);
  //       response = xhr.responseText;
  //       var responseobj = JSON.parse(response);
  //       imagestr = responseobj.imagestring;
  //       // console.log(imagestr);
  //       if (indent == "header") {
  //         showheadermodal(imagestr, fullheight, fullwidth, cropper);
  //       } else if (indent == "footer") {
  //         showfootermodal(imagestr, fullheight, fullwidth, cropper);
  //       } else if (indent == "leftindex") {
  //         showleftindexmodal(imagestr, fullheight, fullwidth, cropper);
  //       } else if (indent == "parameter") {
  //         showmodal(imagestr, fullheight, fullwidth, cropper, label, row);
  //       }
  //     }
  //   };

  // }

  // // recapturing a parameter
  // function showmodal(enhancedpic, fullheight, fullwidth, cropper, label, row) {
  //   document.getElementById("threcheckbox").checked = "true";
  //   cropper = cropperforenhance;
  //   $("#myModal").modal();
  //   $("myModal").ready(function () {

  //     $("#keyfields").css("display", "none");
  //     $("#croppedimg").attr("src", "data:image/jpg;base64," + enhancedpic);
  //     $("#labeltxt").val(label);
  //     var foundstr;
  //     var xhr = new XMLHttpRequest();

  //     xhr.open('POST', 'extracttext', true);
  //     xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //     xhr.send(JSON.stringify({
  //       "thumbnail": enhancedpic
  //     }));
  //     xhr.onreadystatechange = function () {
  //       if (xhr.readyState != 4) return;
  //       if (xhr.status != 200) {
  //         console.log("Status: " + xhr.status);
  //       } else {
  //         response = xhr.responseText;
  //         str = response.substring(response.indexOf("string\":"));
  //         str1 = str.substring(str.indexOf(":") + 3);
  //         str2 = str1.slice(0, -4);
  //         foundstr = str2;
  //         if (str2 == "") {
  //           $('#foundtxt').val("Cannot extract text from this image");
  //         } else {
  //           $('#foundtxt').val(str2);
  //         }

  //       }
  //     };

  //   });
  //   document.getElementById("savedata").onclick = function (event) {
  //     var label = $('#labeltxt').val();
  //     var foundstring = $("#foundtxt").val();
  //     var ishead;
  //     var isfoot;
  //     var selhposition;
  //     var selhtol;
  //     var selfposition;
  //     var selftol;
  //     var textnature;
  //     var language;
  //     var iskey;
  //     var isleftindex = "-";
  //     var selliposition = "-";
  //     var sellitol = "-";

  //     if ($("#headercheckbox").prop('checked') == true) {
  //       ishead = true;
  //       selhposition = $("#hposition option:selected").val();
  //       selhtol = $("#htol option:selected").val();
  //     }
  //     if ($("#footercheckbox").prop('checked') == true) {
  //       isfoot = true;
  //       selfposition = $("#fposition option:selected").val();
  //       selftol = $("#ftol option:selected").val();
  //     }

  //     if ($("#threcheckbox").prop('checked') == true) {
  //       isthre = true;
  //       var colorcut = "-";
  //       var threshold = "-";
  //     } else {
  //       isthre = false;
  //       var colorcut = document.getElementById("colorcut").value;
  //       var threshold = document.getElementById("threshold").value;
  //     }

  //     textnature = $("#textnature option:selected").val();
  //     language = $("#language option:selected").val();

  //     if ($("#keycheckbox").prop('checked') == true) {
  //       iskey = true;
  //       var keyval = $('#foundkeytxt').val();

  //       var kpositionDropDown = document.getElementById("kposition");
  //       var kposition = kpositionDropDown.options[kpositionDropDown.selectedIndex].value;

  //       var ktolDropDown = document.getElementById("ktol");
  //       var ktol = ktolDropDown.options[ktolDropDown.selectedIndex].value;
  //     } else {
  //       iskey = false;
  //     }

  //     if (label == "") {
  //       alert("Enter a label");
  //     } else if (label != "") {
  //       updateTable(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot,
  //         selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature,
  //         language, iskey, kposition, ktol, keyval, row);
  //       $('.checkbox').prop("checked", false);
  //       $("input:checkbox").prop("checked", false);
  //       $("p").text("Extracting text...");
  //       $("input:text").val("");
  //       $("#headerdiv").css("display", "block");
  //       $("#footerdiv").css("display", "block");
  //       $("#keyoptions").css("display", "none");
  //       $("#footeroptions").css("display", "none");
  //       $("#headeroptions").css("display", "none");
  //       $('#myModal').modal('toggle');
  //       $("#keycapturebtn").css("display", "none");
  //       $("#btnCrop").css("display", "inline");
  //       $("#btnCreateModel").css("display", "inline");
  //       document.getElementById("threcheckbox").checked = "true";
  //       $("#threoptions").css("display", "none");
  //       cropper.destroy();

  //       var defthre = document.getElementById("defthreinput");
  //       var defcolcut = document.getElementById("defcolcutinput");
  //       var defdilate = document.getElementById("defdilatecutinput");
  //       var deferode = document.getElementById("deferodeinput");
  //       var defeyerangex = document.getElementById("defeyerangex");
  //       var defeyerangey = document.getElementById("defeyerangey");

  //       defthre.value = thre;
  //       defcolcut.value = cocut;
  //       defdilate.value = dil;
  //       deferode.value = ero;
  //       defeyerangex.value = rangex;
  //       defeyerangey.value = rangey;

  //     }
  //   }
  // }

  // function updateTable(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot,
  //   selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature, language,
  //   iskey, kposition, ktol, keyval, row) {

  //   var myTable1 = document.getElementById('myTable1');
  //   myTable1.rows[row].cells[0].innerHTML = label;
  //   for (i in rownumarray) {
  //     var keylist = rownumarray[i];

  //     keyind = keylist.substring(keylist.indexOf(":") + 1);
  //     keyind = keyind.replace(")", "");
  //     keyind = parseInt(keyind) + 1;

  //     keyvalue = keylist.substring(keylist.indexOf("(") + 1);
  //     keyvalue = keyvalue.substring(0, keyvalue.indexOf(' :'));

  //     if (keyvalue == label) {
  //       console.log(keyind);
  //       var myTab = document.getElementById('myTable');
  //       var objCells = myTab.rows.item(keyind).cells;
  //       var sno = objCells.item(0).innerHTML;
  //       var xaxisl = objCells.item(1).innerHTML;
  //       var yaxisl = objCells.item(2).innerHTML;
  //       var widthl = objCells.item(3).innerHTML;
  //       var heightl = objCells.item(4).innerHTML;
  //       var rotatel = objCells.item(5).innerHTML;
  //       var scalexl = objCells.item(6).innerHTML;
  //       var scaleyl = objCells.item(7).innerHTML;
  //       var fullwidthl = objCells.item(8).innerHTML;
  //       var fullheightl = objCells.item(9).innerHTML;
  //       var labell = objCells.item(10).innerHTML;
  //       var textl = objCells.item(11).innerHTML;
  //       var headerl = objCells.item(12).innerHTML;
  //       var hpositionl = objCells.item(13).innerHTML;
  //       var htoll = objCells.item(14).innerHTML;
  //       var footerl = objCells.item(15).innerHTML;
  //       var fpositionl = objCells.item(16).innerHTML;
  //       var ftoll = objCells.item(17).innerHTML;
  //       var ThreColl = objCells.item(18).innerHTML;
  //       var ColVall = objCells.item(19).innerHTML;
  //       var ThreVall = objCells.item(20).innerHTML;
  //       var Naturel = objCells.item(21).innerHTML;
  //       var Langl = objCells.item(22).innerHTML;
  //       var Keymappedl = objCells.item(23).innerHTML;
  //       var KeyVall = objCells.item(24).innerHTML;
  //       var KeySidel = objCells.item(25).innerHTML;
  //       var KeyToll = objCells.item(26).innerHTML;
  //       var leftindexl = objCells.item(27).innerHTML;
  //       var lipositionl = objCells.item(28).innerHTML;
  //       var litoll = objCells.item(29).innerHTML;

  //       var xaxisc = Math.round(xaxis);
  //       var yaxisc = Math.round(yaxis);
  //       var widthc = Math.round(width);
  //       var heightc = Math.round(height);

  //       console.log(headeryaxis);
  //       console.log(leftindexxaxis);

  //       if (headeryaxis != 0) {
  //         console.log("first yaxis - " + yaxisc.toString());
  //         yaxisc = parseInt(yaxisc) - parseInt(headeryaxis);
  //         console.log("second yaxis - " + yaxisc.toString());
  //       }

  //       if (leftindexxaxis != 0) {
  //         console.log("second xaxis - " + xaxisc.toString());
  //         xaxisc = parseInt(xaxisc) - parseInt(leftindexxaxis);
  //         console.log("second xaxis - " + xaxisc.toString());
  //       }

  //       if (yaxisc < 0) {
  //         yaxisc = 0
  //       }

  //       if (xaxisc < 0) {
  //         xaxisc = 0
  //       }

  //       var xaxisupdated = (parseInt(xaxisl) + parseInt(xaxisc)) / 2;
  //       var yaxisupdated = (parseInt(yaxisl) + parseInt(yaxisc)) / 2;
  //       var widthupdated = (parseInt(widthl) + parseInt(widthc)) / 2;
  //       var heightupdated = (parseInt(heightl) + parseInt(heightc)) / 2;

  //       ThreColl = ThreColl.replace(/^\s+|\s+$/g, '');

  //       if (isthre == false) {
  //         console.log("here");
  //         console.log(ThreColl);
  //         if (ThreColl == "false") {
  //           console.log("thre unchecked")
  //           var thresholdupdated = (parseInt(threshold) + parseInt(ThreVall)) / 2;
  //           var colorcutupdated = (parseInt(colorcut) + parseInt(ColVall)) / 2;
  //         } else if (ThreColl == "true") {
  //           console.log("thre checked")
  //           var thresholdupdated = threshold;
  //           var colorcutupdated = colorcut;
  //         }
  //       }
  //       updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring,
  //         isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
  //     }
  //   }
  //   myTable1.rows[row].cells[1].innerHTML = foundstring;
  //   count = count + 1;
  // }

  // function updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring,
  //   isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval) {

  //   keyind = parseInt(keyind);
  //   var myTable = document.getElementById('myTable');

  //   myTable.rows[keyind].cells[1].innerHTML = xaxisupdated;
  //   myTable.rows[keyind].cells[2].innerHTML = yaxisupdated;
  //   myTable.rows[keyind].cells[3].innerHTML = widthupdated;
  //   myTable.rows[keyind].cells[4].innerHTML = heightupdated;
  //   myTable.rows[keyind].cells[10].innerHTML = label;
  //   myTable.rows[keyind].cells[11].innerHTML = foundstring;
  //   myTable.rows[keyind].cells[18].innerHTML = isthre;
  //   myTable.rows[keyind].cells[19].innerHTML = colorcutupdated;
  //   myTable.rows[keyind].cells[20].innerHTML = thresholdupdated;
  //   myTable.rows[keyind].cells[21].innerHTML = textnature;
  //   myTable.rows[keyind].cells[22].innerHTML = language;
  //   myTable.rows[keyind].cells[23].innerHTML = iskey;
  //   myTable.rows[keyind].cells[25].innerHTML = kposition;
  //   myTable.rows[keyind].cells[26].innerHTML = ktol;
  //   myTable.rows[keyind].cells[24].innerHTML = keyval;
  // }

  // // recapturing header
  // function updateImageDisplayHeader(indent) {
  //   var image = document.getElementById('output');
  //   cropper1 = new Cropper(image, {
  //     crop(event) {
  //       xaxis = event.detail.x;
  //       yaxis = event.detail.y;
  //       width = event.detail.width;
  //       height = event.detail.height;
  //       rotate = event.detail.rotate;
  //       scaleX = event.detail.scaleX;
  //       scaleY = event.detail.scaleY;
  //     }
  //   });

  //   var image = document.getElementById('output');
  //   document.getElementById("btnCrop").onclick = function (event) {
  //     fullwidth = image.width;
  //     fullheight = image.height;
  //     getcroppedpicenhanced(cropper1, fullheight, fullwidth, "header", "label", "row");
  //   }
  // }

  // function showheadermodal(enhancedpic, fullheight, fullwidth, cropper) {
  //   document.getElementById("threcheckboxheader").checked = "true";
  //   $("#threoptionsheader").css("display", "none");
  //   cropper = cropperforenhance;
  //   $("#headerModal").modal();
  //   $("headerModal").ready(function () {
  //     $("#croppedimgheader").attr("src", "data:image/jpg;base64," + enhancedpic);
  //     var foundstr;
  //     var xhr = new XMLHttpRequest();

  //     xhr.open('POST', 'extracttext', true);
  //     xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //     xhr.send(JSON.stringify({
  //       "thumbnail": enhancedpic
  //     }));
  //     xhr.onreadystatechange = function () {
  //       if (xhr.readyState != 4) return;
  //       if (xhr.status != 200) {
  //         console.log("Status: " + xhr.status);
  //       } else {
  //         console.log(xhr.responseText);
  //         response = xhr.responseText;
  //         str = response.substring(response.indexOf("string\":"));
  //         str1 = str.substring(str.indexOf(":") + 3);
  //         str2 = str1.slice(0, -4);
  //         console.log(str2);
  //         foundstr = str2;
  //         if (str2 == "") {
  //           $('#foundtxtheader').val("Cannot extract text from this image");
  //         } else {
  //           $('#foundtxtheader').val(str2);
  //         }

  //       }
  //     };

  //   });

  //   document.getElementById("savedataheader").onclick = function (event) {
  //     var label = "-";
  //     var foundstring = $("#foundtxtheader").val();
  //     var ishead = "true";
  //     var isfoot = "-";
  //     var selhposition = "-";
  //     var selhtol = "-";
  //     var selfposition = "-";
  //     var selftol = "-";
  //     var textnature;
  //     var language;
  //     var iskey = "-";
  //     var keyval = "-";
  //     var isthre;
  //     var isleftindex = "-";
  //     var selliposition = "-";
  //     var sellitol = "-";
  //     var kposition = "-";
  //     var ktol = "-";

  //     if ($("#threcheckboxheader").prop('checked') == true) {
  //       isthre = true;
  //       var colorcut = "-";
  //       var threshold = "-";
  //     } else {
  //       isthre = false;
  //       var colorcut = document.getElementById("colorcutheader").value;
  //       var threshold = document.getElementById("thresholdheader").value;
  //     }

  //     textnature = $("#textnatureheader option:selected").val();
  //     language = $("#languageheader option:selected").val();

  //     selhposition = $("#hposition option:selected").val();
  //     selhtol = $("#htol option:selected").val();

  //     updateTableforheader(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot,
  //       selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature,
  //       language, iskey, kposition, ktol, keyval);
  //     $('.checkbox').prop("checked", false);
  //     $("input:checkbox").prop("checked", false);
  //     $("p").text("Extracting text...");
  //     $("input:text").val("");
  //     $('#headerModal').modal('toggle');
  //     $("#btnCrop").css("display", "inline");
  //     $("#btnCreateModel").css("display", "inline");
  //     document.getElementById("threcheckboxheader").checked = "true";
  //     $("#threoptionsheader").css("display", "none");
  //     cropper1.destroy();

  //     var defthre = document.getElementById("defthreinput");
  //     var defcolcut = document.getElementById("defcolcutinput");
  //     var defdilate = document.getElementById("defdilatecutinput");
  //     var deferode = document.getElementById("deferodeinput");
  //     var defeyerangex = document.getElementById("defeyerangex");
  //     var defeyerangey = document.getElementById("defeyerangey");

  //     defthre.value = thre;
  //     defcolcut.value = cocut;
  //     defdilate.value = dil;
  //     deferode.value = ero;
  //     defeyerangex.value = rangex;
  //     defeyerangey.value = rangey;

  //   }
  // }

  // function updateTableforheader(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol,
  //   isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature,
  //   language, iskey, kposition, ktol, keyval) {

  //   document.getElementById("capturedHead").innerHTML = foundstring;

  //   console.log(rownumarray);

  //   var headerdone = false;

  //   for (i in rownumarray) {
  //     var keylist = rownumarray[i];

  //     keyvalue = keylist.substring(keylist.indexOf("(") + 1);
  //     keyvalue = keyvalue.substring(0, keyvalue.indexOf(' :'));

  //     keyind = keylist.substring(keylist.indexOf(":") + 1);
  //     keyind = keyind.replace(")", "");
  //     keyind = parseInt(keyind) + 1;

  //     console.log(keyind);

  //     if (keyvalue == " header") {
  //       console.log(keyind);
  //       var myTab = document.getElementById('myTable');
  //       var objCells = myTab.rows.item(keyind).cells;
  //       var sno = objCells.item(0).innerHTML;
  //       var xaxisl = objCells.item(1).innerHTML;
  //       var yaxisl = objCells.item(2).innerHTML;
  //       var widthl = objCells.item(3).innerHTML;
  //       var heightl = objCells.item(4).innerHTML;
  //       var rotatel = objCells.item(5).innerHTML;
  //       var scalexl = objCells.item(6).innerHTML;
  //       var scaleyl = objCells.item(7).innerHTML;
  //       var fullwidthl = objCells.item(8).innerHTML;
  //       var fullheightl = objCells.item(9).innerHTML;
  //       var labell = objCells.item(10).innerHTML;
  //       var textl = objCells.item(11).innerHTML;
  //       var headerl = objCells.item(12).innerHTML;
  //       var hpositionl = objCells.item(13).innerHTML;
  //       var htoll = objCells.item(14).innerHTML;
  //       var footerl = objCells.item(15).innerHTML;
  //       var fpositionl = objCells.item(16).innerHTML;
  //       var ftoll = objCells.item(17).innerHTML;
  //       var ThreColl = objCells.item(18).innerHTML;
  //       var ColVall = objCells.item(19).innerHTML;
  //       var ThreVall = objCells.item(20).innerHTML;
  //       var Naturel = objCells.item(21).innerHTML;
  //       var Langl = objCells.item(22).innerHTML;
  //       var Keymappedl = objCells.item(23).innerHTML;
  //       var KeyVall = objCells.item(24).innerHTML;
  //       var KeySidel = objCells.item(25).innerHTML;
  //       var KeyToll = objCells.item(26).innerHTML;
  //       var leftindexl = objCells.item(27).innerHTML;
  //       var lipositionl = objCells.item(28).innerHTML;
  //       var litoll = objCells.item(29).innerHTML;

  //       var xaxisc = Math.round(xaxis);
  //       var yaxisc = Math.round(yaxis);
  //       var widthc = Math.round(width);
  //       var heightc = Math.round(height);

  //       var xaxisupdated = (parseInt(xaxisl) + parseInt(xaxisc)) / 2;
  //       var yaxisupdated = (parseInt(yaxisl) + parseInt(yaxisc)) / 2;
  //       var widthupdated = (parseInt(widthl) + parseInt(widthc)) / 2;
  //       var heightupdated = (parseInt(heightl) + parseInt(heightc)) / 2;

  //       ThreColl = ThreColl.replace(/^\s+|\s+$/g, '');

  //       if (isthre == false) {
  //         console.log("here");
  //         console.log(ThreColl);
  //         if (ThreColl == "false") {
  //           console.log("thre unchecked")
  //           var thresholdupdated = (parseInt(threshold) + parseInt(ThreVall)) / 2;
  //           var colorcutupdated = (parseInt(colorcut) + parseInt(ColVall)) / 2;
  //         } else if (ThreColl == "true") {
  //           console.log("thre checked")
  //           var thresholdupdated = threshold;
  //           var colorcutupdated = colorcut;
  //         }
  //       }
  //       updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring,
  //         isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
  //       headerdone = true;
  //     }

  //   }
  //   if (headerdone = false) {
  //     var label = "-";
  //     // var foundstring = $("#foundtxtheader").html();
  //     var foundstring = $('#foundtxtheader').val();
  //     var ishead = "true";
  //     var isfoot = "-";
  //     var selhposition = "-";
  //     var selhtol = "-";
  //     var selfposition = "-";
  //     var selftol = "-";
  //     var textnature;
  //     var language;
  //     var iskey = "-";
  //     var keyval = "-";
  //     var isthre;
  //     var isleftindex = "-";
  //     var selliposition = "-";
  //     var sellitol = "-";
  //     var kposition = "-";
  //     var ktol = "-";
  //     var kori = "-";
  //     var koriper = "-";

  //     if ($("#threcheckboxheader").prop('checked') == true) {
  //       isthre = true;
  //       var colorcut = "-";
  //       var threshold = "-";
  //     } else {
  //       isthre = false;
  //       var colorcut = document.getElementById("colorcutheader").value;
  //       var threshold = document.getElementById("thresholdheader").value;
  //     }

  //     textnature = $("#textnatureheader option:selected").val();
  //     language = $("#languageheader option:selected").val();
  //     selhposition = $("#hposition option:selected").val();
  //     selhtol = $("#htol option:selected").val();

  //     if (headerRowId != "null") {
  //       document.getElementById("myTable").deleteRow(headerRowId);
  //       count = count - 1;
  //     }

  //     var rowcount = parseInt(document.getElementById("myTable").rows.length);

  //     updatenewvaluestotable(rowcount + 1, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring,
  //       isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
  //     $('.checkbox').prop("checked", false);
  //     $("input:checkbox").prop("checked", false);
  //     $("p").text("Extracting text...");
  //     $("#foundtxtheader").val("");
  //     $('#headerModal').modal('toggle');
  //     $("#btnCrop").css("display", "inline");
  //     $("#btnCreateModel").css("display", "inline");
  //     document.getElementById("threcheckboxheader").checked = "true";
  //     $("#threoptionsheader").css("display", "none");
  //     cropper1.destroy();
  //   }
  // }

  // // recapturing footer
  // function updateImageDisplayFooter(indent) {
  //   var image = document.getElementById('output');
  //   cropper2 = new Cropper(image, {
  //     crop(event) {
  //       xaxis = event.detail.x;
  //       yaxis = event.detail.y;
  //       width = event.detail.width;
  //       height = event.detail.height;
  //       rotate = event.detail.rotate;
  //       scaleX = event.detail.scaleX;
  //       scaleY = event.detail.scaleY;
  //     }
  //   });

  //   var image = document.getElementById('output');
  //   document.getElementById("btnCrop").onclick = function (event) {
  //     fullwidth = image.width;
  //     fullheight = image.height;
  //     getcroppedpicenhanced(cropper2, fullheight, fullwidth, "footer", "label", "row");
  //   }
  // }

  // function showfootermodal(enhancedpic, fullheight, fullwidth, cropper) {
  //   document.getElementById("threcheckboxfooter").checked = "true";
  //   $("#threoptionsfooter").css("display", "none");
  //   cropper = cropperforenhance;
  //   $("#footerModal").modal();
  //   $("footerModal").ready(function () {

  //     $("#croppedimgfooter").attr("src", "data:image/jpg;base64," + enhancedpic);
  //     var foundstr;
  //     var xhr = new XMLHttpRequest();

  //     xhr.open('POST', 'extracttext', true);
  //     xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //     xhr.send(JSON.stringify({
  //       "thumbnail": enhancedpic
  //     }));
  //     xhr.onreadystatechange = function () {
  //       if (xhr.readyState != 4) return;
  //       if (xhr.status != 200) {
  //         console.log("Status: " + xhr.status);
  //       } else {
  //         console.log(xhr.responseText);
  //         response = xhr.responseText;
  //         str = response.substring(response.indexOf("string\":"));
  //         str1 = str.substring(str.indexOf(":") + 3);
  //         str2 = str1.slice(0, -4);
  //         console.log(str2);
  //         foundstr = str2;
  //         if (str2 == "") {
  //           $('#foundtxtfooter').val("Cannot extract text from this image");
  //         } else {
  //           $('#foundtxtfooter').val(str2);
  //         }

  //       }
  //     };

  //   });

  //   document.getElementById("savedatafooter").onclick = function (event) {
  //     var label = "-";
  //     var foundstring = $("#foundtxtfooter").val();
  //     var ishead = "-";
  //     var isfoot = "true";
  //     var selhposition = "-";
  //     var selhtol = "-";
  //     var selfposition = "-";
  //     var selftol = "-";
  //     var textnature;
  //     var language;
  //     var iskey = "-";
  //     var keyval = "-";
  //     var isthre;
  //     var isleftindex = "-";
  //     var selliposition = "-";
  //     var sellitol = "-";
  //     var kposition = "-";
  //     var ktol = "-";

  //     if ($("#threcheckboxfooter").prop('checked') == true) {
  //       isthre = true;
  //       var colorcut = "-";
  //       var threshold = "-";
  //     } else {
  //       isthre = false;
  //       var colorcut = document.getElementById("colorcutfooter").value;
  //       var threshold = document.getElementById("thresholdfooter").value;
  //     }

  //     textnature = $("#textnaturefooter option:selected").val();
  //     language = $("#languagefooter option:selected").val();

  //     selfposition = $("#fposition option:selected").val();
  //     selftol = $("#ftol option:selected").val();

  //     updateTableforfooter(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol, isfoot,
  //       selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature,
  //       language, iskey, kposition, ktol, keyval);
  //     $('.checkbox').prop("checked", false);
  //     $("input:checkbox").prop("checked", false);
  //     $("p").text("Extracting text...");
  //     $("input:text").val("");
  //     $('#footerModal').modal('toggle');
  //     $("#btnCrop").css("display", "inline");
  //     $("#btnCreateModel").css("display", "inline");
  //     document.getElementById("threcheckboxfooter").checked = "true";
  //     $("#threoptionsfooter").css("display", "none");
  //     cropper2.destroy();

  //     var defthre = document.getElementById("defthreinput");
  //     var defcolcut = document.getElementById("defcolcutinput");
  //     var defdilate = document.getElementById("defdilatecutinput");
  //     var deferode = document.getElementById("deferodeinput");
  //     var defeyerangex = document.getElementById("defeyerangex");
  //     var defeyerangey = document.getElementById("defeyerangey");

  //     defthre.value = thre;
  //     defcolcut.value = cocut;
  //     defdilate.value = dil;
  //     deferode.value = ero;
  //     defeyerangex.value = rangex;
  //     defeyerangey.value = rangey;

  //   }
  // }

  // function updateTableforfooter(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol,
  //   isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature,
  //   language, iskey, kposition, ktol, keyval) {

  //   document.getElementById("capturedFoot").innerHTML = foundstring;

  //   console.log(rownumarray);
  //   for (i in rownumarray) {
  //     var keylist = rownumarray[i];

  //     keyvalue = keylist.substring(keylist.indexOf("(") + 1);
  //     keyvalue = keyvalue.substring(0, keyvalue.indexOf(' :'));
  //     keyind = keylist.substring(keylist.indexOf(":") + 1);
  //     keyind = keyind.replace(")", "");
  //     keyind = parseInt(keyind) + 1;

  //     if (keyvalue == " footer") {
  //       console.log(keyind);
  //       var myTab = document.getElementById('myTable');
  //       var objCells = myTab.rows.item(keyind).cells;
  //       var sno = objCells.item(0).innerHTML;
  //       var xaxisl = objCells.item(1).innerHTML;
  //       var yaxisl = objCells.item(2).innerHTML;
  //       var widthl = objCells.item(3).innerHTML;
  //       var heightl = objCells.item(4).innerHTML;
  //       var rotatel = objCells.item(5).innerHTML;
  //       var scalexl = objCells.item(6).innerHTML;
  //       var scaleyl = objCells.item(7).innerHTML;
  //       var fullwidthl = objCells.item(8).innerHTML;
  //       var fullheightl = objCells.item(9).innerHTML;
  //       var labell = objCells.item(10).innerHTML;
  //       var textl = objCells.item(11).innerHTML;
  //       var headerl = objCells.item(12).innerHTML;
  //       var hpositionl = objCells.item(13).innerHTML;
  //       var htoll = objCells.item(14).innerHTML;
  //       var footerl = objCells.item(15).innerHTML;
  //       var fpositionl = objCells.item(16).innerHTML;
  //       var ftoll = objCells.item(17).innerHTML;
  //       var ThreColl = objCells.item(18).innerHTML;
  //       var ColVall = objCells.item(19).innerHTML;
  //       var ThreVall = objCells.item(20).innerHTML;
  //       var Naturel = objCells.item(21).innerHTML;
  //       var Langl = objCells.item(22).innerHTML;
  //       var Keymappedl = objCells.item(23).innerHTML;
  //       var KeyVall = objCells.item(24).innerHTML;
  //       var KeySidel = objCells.item(25).innerHTML;
  //       var KeyToll = objCells.item(26).innerHTML;
  //       var leftindexl = objCells.item(27).innerHTML;
  //       var lipositionl = objCells.item(28).innerHTML;
  //       var litoll = objCells.item(29).innerHTML;

  //       var xaxisc = Math.round(xaxis);
  //       var yaxisc = Math.round(yaxis);
  //       var widthc = Math.round(width);
  //       var heightc = Math.round(height);

  //       var xaxisupdated = (parseInt(xaxisl) + parseInt(xaxisc)) / 2;
  //       var yaxisupdated = (parseInt(yaxisl) + parseInt(yaxisc)) / 2;
  //       var widthupdated = (parseInt(widthl) + parseInt(widthc)) / 2;
  //       var heightupdated = (parseInt(heightl) + parseInt(heightc)) / 2;

  //       ThreColl = ThreColl.replace(/^\s+|\s+$/g, '');

  //       if (isthre == false) {
  //         console.log("here");
  //         console.log(ThreColl);
  //         if (ThreColl == "false") {
  //           console.log("thre unchecked")
  //           var thresholdupdated = (parseInt(threshold) + parseInt(ThreVall)) / 2;
  //           var colorcutupdated = (parseInt(colorcut) + parseInt(ColVall)) / 2;
  //         } else if (ThreColl == "true") {
  //           console.log("thre checked")
  //           var thresholdupdated = threshold;
  //           var colorcutupdated = colorcut;
  //         }
  //       }
  //       updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring,
  //         isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
  //     }
  //   }
  // }

  // // recapturing left index
  // function updateImageDisplayLeftIndex(indent) {
  //   var image = document.getElementById('output');
  //   cropper3 = new Cropper(image, {
  //     crop(event) {
  //       xaxis = event.detail.x;
  //       yaxis = event.detail.y;
  //       width = event.detail.width;
  //       height = event.detail.height;
  //       rotate = event.detail.rotate;
  //       scaleX = event.detail.scaleX;
  //       scaleY = event.detail.scaleY;
  //     }
  //   });

  //   var image = document.getElementById('output');
  //   document.getElementById("btnCrop").onclick = function (event) {
  //     fullwidth = image.width;
  //     fullheight = image.height;
  //     getcroppedpicenhanced(cropper3, fullheight, fullwidth, "leftindex", "label", "row");
  //   }
  // }

  // function showleftindexmodal(enhancedpic, fullheight, fullwidth, cropper) {
  //   document.getElementById("threcheckboxleftindex").checked = "true";
  //   $("#threoptionsleftindex").css("display", "none");
  //   cropper = cropperforenhance;
  //   $("#leftindexModal").modal();
  //   $("leftindexModal").ready(function () {

  //     $("#croppedimgleftindex").attr("src", "data:image/jpg;base64," + enhancedpic);
  //     var foundstr;
  //     var xhr = new XMLHttpRequest();

  //     xhr.open('POST', 'extracttext', true);
  //     xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //     xhr.send(JSON.stringify({
  //       "thumbnail": enhancedpic
  //     }));
  //     xhr.onreadystatechange = function () {
  //       if (xhr.readyState != 4) return;
  //       if (xhr.status != 200) {
  //         console.log("Status: " + xhr.status);
  //       } else {
  //         console.log(xhr.responseText);
  //         response = xhr.responseText;
  //         str = response.substring(response.indexOf("string\":"));
  //         str1 = str.substring(str.indexOf(":") + 3);
  //         str2 = str1.slice(0, -4);
  //         console.log(str2);
  //         foundstr = str2;
  //         if (str2 == "") {
  //           $('#foundtxtleftindex').val("Cannot extract text from this image");
  //         } else {
  //           $('#foundtxtleftindex').val(str2);
  //         }

  //       }
  //     };

  //   });

  //   document.getElementById("savedataleftindex").onclick = function (event) {
  //     var label = "-";
  //     var foundstring = $("#foundtxtleftindex").val();
  //     var ishead = "-";
  //     var isfoot = "-";
  //     var selhposition = "-";
  //     var selhtol = "-";
  //     var selfposition = "-";
  //     var selftol = "-";
  //     var textnature;
  //     var language;
  //     var iskey = "-";
  //     var keyval = "-";
  //     var isthre;
  //     var isleftindex = "true";
  //     var selliposition;
  //     var sellitol;
  //     var kposition = "-";
  //     var ktol = "-";

  //     if ($("#threcheckboxleftindex").prop('checked') == true) {
  //       isthre = true;
  //       var colorcut = "-";
  //       var threshold = "-";
  //     } else {
  //       isthre = false;
  //       var colorcut = document.getElementById("colorcutleftindex").value;
  //       var threshold = document.getElementById("colorcutleftindex").value;
  //     }

  //     textnature = $("#textnatureleftindex option:selected").val();
  //     language = $("#languageleftindex option:selected").val();

  //     selliposition = $("#liposition option:selected").val();
  //     sellitol = $("#litol option:selected").val();

  //     // alert(headerRowId);

  //     if (leftindexRowId != "null") {
  //       document.getElementById("myTable").deleteRow(leftindexRowId);
  //       count = count - 1;
  //     }


  //     updateTableforleftindex(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol,
  //       isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold,
  //       textnature, language, iskey, kposition, ktol, keyval);
  //     $('.checkbox').prop("checked", false);
  //     $("input:checkbox").prop("checked", false);
  //     $("p").text("Extracting text...");
  //     $("input:text").val("");
  //     $('#leftindexModal').modal('toggle');
  //     $("#btnCrop").css("display", "inline");
  //     $("#btnCreateModel").css("display", "inline");
  //     document.getElementById("threcheckboxleftindex").checked = "true";
  //     $("#threoptionsleftindex").css("display", "none");
  //     cropper3.destroy();

  //     var defthre = document.getElementById("defthreinput");
  //     var defcolcut = document.getElementById("defcolcutinput");
  //     var defdilate = document.getElementById("defdilatecutinput");
  //     var deferode = document.getElementById("deferodeinput");
  //     var defeyerangex = document.getElementById("defeyerangex");
  //     var defeyerangey = document.getElementById("defeyerangey");

  //     defthre.value = thre;
  //     defcolcut.value = cocut;
  //     defdilate.value = dil;
  //     deferode.value = ero;
  //     defeyerangex.value = rangex;
  //     defeyerangey.value = rangey;

  //   }
  // }

  // function updateTableforleftindex(cropper, fullheight, fullwidth, label, foundstring, ishead, selhposition, selhtol,
  //   isfoot, selfposition, selftol, isleftindex, selliposition, sellitol, isthre, colorcut, threshold, textnature,
  //   language, iskey, kposition, ktol, keyval) {
  //   document.getElementById("capturedleftindex").innerHTML = foundstring;

  //   console.log(rownumarray);
  //   for (i in rownumarray) {
  //     var keylist = rownumarray[i];
  //     // console.log(label);

  //     keyvalue = keylist.substring(keylist.indexOf("(") + 1);
  //     keyvalue = keyvalue.substring(0, keyvalue.indexOf(' :'));

  //     keyind = keylist.substring(keylist.indexOf(":") + 1);
  //     keyind = keyind.replace(")", "");
  //     keyind = parseInt(keyind) + 1;

  //     if (keyvalue == " leftindex") {
  //       console.log(keyind);
  //       var myTab = document.getElementById('myTable');
  //       var objCells = myTab.rows.item(keyind).cells;
  //       var sno = objCells.item(0).innerHTML;
  //       var xaxisl = objCells.item(1).innerHTML;
  //       var yaxisl = objCells.item(2).innerHTML;
  //       var widthl = objCells.item(3).innerHTML;
  //       var heightl = objCells.item(4).innerHTML;
  //       var rotatel = objCells.item(5).innerHTML;
  //       var scalexl = objCells.item(6).innerHTML;
  //       var scaleyl = objCells.item(7).innerHTML;
  //       var fullwidthl = objCells.item(8).innerHTML;
  //       var fullheightl = objCells.item(9).innerHTML;
  //       var labell = objCells.item(10).innerHTML;
  //       var textl = objCells.item(11).innerHTML;
  //       var headerl = objCells.item(12).innerHTML;
  //       var hpositionl = objCells.item(13).innerHTML;
  //       var htoll = objCells.item(14).innerHTML;
  //       var footerl = objCells.item(15).innerHTML;
  //       var fpositionl = objCells.item(16).innerHTML;
  //       var ftoll = objCells.item(17).innerHTML;
  //       var ThreColl = objCells.item(18).innerHTML;
  //       var ColVall = objCells.item(19).innerHTML;
  //       var ThreVall = objCells.item(20).innerHTML;
  //       var Naturel = objCells.item(21).innerHTML;
  //       var Langl = objCells.item(22).innerHTML;
  //       var Keymappedl = objCells.item(23).innerHTML;
  //       var KeyVall = objCells.item(24).innerHTML;
  //       var KeySidel = objCells.item(25).innerHTML;
  //       var KeyToll = objCells.item(26).innerHTML;
  //       var leftindexl = objCells.item(27).innerHTML;
  //       var lipositionl = objCells.item(28).innerHTML;
  //       var litoll = objCells.item(29).innerHTML;

  //       var xaxisc = Math.round(xaxis);
  //       var yaxisc = Math.round(yaxis);
  //       var widthc = Math.round(width);
  //       var heightc = Math.round(height);

  //       var xaxisupdated = (parseInt(xaxisl) + parseInt(xaxisc)) / 2;
  //       var yaxisupdated = (parseInt(yaxisl) + parseInt(yaxisc)) / 2;
  //       var widthupdated = (parseInt(widthl) + parseInt(widthc)) / 2;
  //       var heightupdated = (parseInt(heightl) + parseInt(heightc)) / 2;

  //       ThreColl = ThreColl.replace(/^\s+|\s+$/g, '');

  //       if (isthre == false) {
  //         console.log("here");
  //         console.log(ThreColl);
  //         if (ThreColl == "false") {
  //           console.log("thre unchecked")
  //           var thresholdupdated = (parseInt(threshold) + parseInt(ThreVall)) / 2;
  //           var colorcutupdated = (parseInt(colorcut) + parseInt(ColVall)) / 2;
  //         } else if (ThreColl == "true") {
  //           console.log("thre checked")
  //           var thresholdupdated = threshold;
  //           var colorcutupdated = colorcut;
  //         }
  //       }
  //       updatenewvaluestotable(keyind, xaxisupdated, yaxisupdated, widthupdated, heightupdated, label, foundstring,
  //         isthre, colorcutupdated, thresholdupdated, textnature, language, iskey, kposition, ktol, keyval);
  //     }
  //   }
  // }


  // // preview image button clicked
  // function getupdatedimage() {
  //   $('#foundtxt').val("Extracting updated text...");
  //   var inputthreshold = document.getElementById("colorcut").value;
  //   var inputcolorcut = document.getElementById("threshold").value;
  //   var imageData = cropperforenhance.getCroppedCanvas();
  //   var croppedimg = imageData.toDataURL("image/png");
  //   var foundstr;
  //   var xhr = new XMLHttpRequest();

  //   xhr.open('POST', 'processcroppedimg', true);
  //   xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //   xhr.send(JSON.stringify({
  //     "thumbnail": croppedimg,
  //     "threshold": inputthreshold,
  //     "colorcut": inputcolorcut
  //   }));
  //   xhr.onreadystatechange = function () {
  //     if (xhr.readyState != 4) return;
  //     if (xhr.status != 200) {
  //       console.log("Status: " + xhr.status);
  //     } else {
  //       response = xhr.responseText;
  //       var responseobj = JSON.parse(response);
  //       imagestr = responseobj.imagestring;
  //       updatedstr = responseobj.updatedresultstring;
  //       $("#croppedimg").attr("src", "data:image/jpg;base64," + imagestr);
  //       $('#foundtxt').val(updatedstr);
  //     }
  //   };
  // }

  // function getupdatedimageforheader() {
  //   $('#foundtxtheader').val("Extracting updated text...");
  //   var inputthreshold = document.getElementById("colorcutheader").value;
  //   var inputcolorcut = document.getElementById("thresholdheader").value;
  //   var imageData = cropper1.getCroppedCanvas();
  //   var croppedimg = imageData.toDataURL("image/png");
  //   var foundstr;
  //   var xhr = new XMLHttpRequest();

  //   xhr.open('POST', 'processcroppedimg', true);
  //   xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //   xhr.send(JSON.stringify({
  //     "thumbnail": croppedimg,
  //     "threshold": inputthreshold,
  //     "colorcut": inputcolorcut
  //   }));
  //   xhr.onreadystatechange = function () {
  //     if (xhr.readyState != 4) return;
  //     if (xhr.status != 200) {
  //       console.log("Status: " + xhr.status);
  //     } else {
  //       response = xhr.responseText;
  //       var responseobj = JSON.parse(response);
  //       imagestr = responseobj.imagestring;
  //       updatedstr = responseobj.updatedresultstring;
  //       $("#croppedimgheader").attr("src", "data:image/jpg;base64," + imagestr);
  //       $('#foundtxtheader').val(updatedstr);
  //     }
  //   };
  // }

  // function getupdatedimageforfooter() {
  //   $('#foundtxtfooter').val("Extracting updated text...");
  //   var inputthreshold = document.getElementById("colorcutfooter").value;
  //   var inputcolorcut = document.getElementById("thresholdfooter").value;
  //   var imageData = cropper2.getCroppedCanvas();
  //   var croppedimg = imageData.toDataURL("image/png");
  //   var foundstr;
  //   var xhr = new XMLHttpRequest();

  //   xhr.open('POST', 'processcroppedimg', true);
  //   xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //   xhr.send(JSON.stringify({
  //     "thumbnail": croppedimg,
  //     "threshold": inputthreshold,
  //     "colorcut": inputcolorcut
  //   }));
  //   xhr.onreadystatechange = function () {
  //     if (xhr.readyState != 4) return;
  //     if (xhr.status != 200) {
  //       console.log("Status: " + xhr.status);
  //     } else {
  //       response = xhr.responseText;
  //       var responseobj = JSON.parse(response);
  //       imagestr = responseobj.imagestring;
  //       updatedstr = responseobj.updatedresultstring;
  //       $("#croppedimgfooter").attr("src", "data:image/jpg;base64," + imagestr);
  //       $('#foundtxtfooter').val(updatedstr);
  //     }
  //   };
  // }

  // function getupdatedimageforleftindex() {
  //   $('#foundtxtleftindex').val("Extracting updated text...");
  //   var inputthreshold = document.getElementById("colorcutleftindex").value;
  //   var inputcolorcut = document.getElementById("thresholdleftindex").value;
  //   // alert(inputcolorcut + "-------" + inputthreshold);
  //   var imageData = cropper3.getCroppedCanvas();
  //   var croppedimg = imageData.toDataURL("image/png");
  //   // console.log(croppedimg);

  //   var foundstr;
  //   var xhr = new XMLHttpRequest();

  //   xhr.open('POST', 'processcroppedimg', true);
  //   xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //   xhr.send(JSON.stringify({
  //     "thumbnail": croppedimg,
  //     "threshold": inputthreshold,
  //     "colorcut": inputcolorcut
  //   }));
  //   xhr.onreadystatechange = function () {
  //     if (xhr.readyState != 4) return;
  //     if (xhr.status != 200) {
  //       console.log("Status: " + xhr.status);
  //     } else {
  //       response = xhr.responseText;
  //       var responseobj = JSON.parse(response);
  //       imagestr = responseobj.imagestring;
  //       updatedstr = responseobj.updatedresultstring;
  //       $("#croppedimgleftindex").attr("src", "data:image/jpg;base64," + imagestr);
  //       $('#foundtxtleftindex').val(updatedstr);
  //     }
  //   };
  // }


  // function removeRow(oButton) {
  //   var empTab = document.getElementById('myTable');
  //   empTab.deleteRow(oButton.parentNode.parentNode.rowIndex);
  //   var empTab1 = document.getElementById('myTable1');
  //   empTab1.deleteRow(oButton.parentNode.parentNode.rowIndex);

  //   count = count - 1;
  // }

  // function sendtoinitialimageprocess(file) {
  //   var threshold = parseInt(document.getElementById("defthreinput").value);
  //   var colorcut = parseInt(document.getElementById("defcolcutinput").value);
  //   var dilate = parseInt(document.getElementById("defdilatecutinput").value);
  //   var erode = parseInt(document.getElementById("deferodeinput").value);

  //   imagefile = file;

  //   base64(file, function (data) {
  //     var imagestring = data.base64;
  //     var foundstr;
  //     var xhr = new XMLHttpRequest();

  //     xhr.open('POST', 'initialimageprocess', true);
  //     xhr.setRequestHeader('Content-Type', "application/json;charset=UTF-8");
  //     xhr.send(JSON.stringify({
  //       "thumbnail": imagestring,
  //       "threshold": threshold,
  //       "colorcut": colorcut,
  //       "dilate": dilate,
  //       "erode": erode
  //     }));
  //     xhr.onreadystatechange = function () {
  //       if (xhr.readyState != 4) return;
  //       if (xhr.status != 200) {
  //         console.log(xhr.responseText);
  //         console.log("Status: " + xhr.status);
  //       } else {
  //         response = xhr.responseText;
  //         var responseobj = JSON.parse(response);
  //         imagestr = responseobj.imagestring;
  //         withboxesimagestr = responseobj.withboxes;

  //         $("#output").attr("src", "data:image/jpg;base64," + imagestr);
  //         $("#output2").attr("src", "data:image/jpg;base64," + withboxesimagestr);
  //         $("#output").attr("width", originalwidth);
  //         $("#output").attr("height", originalheight);
  //         $("#output2").attr("width", originalwidth);
  //         $("#output2").attr("height", originalheight);
  //       }
  //     };
  //   })
  // }

  // function base64(file, callback) {
  //   var coolFile = {};

  //   function readerOnload(e) {
  //     var base64 = btoa(e.target.result);
  //     coolFile.base64 = base64;
  //     callback(coolFile)
  //   };

  //   var reader = new FileReader();
  //   reader.onload = readerOnload;

  //   coolFile.filetype = file.type;
  //   coolFile.size = file.size;
  //   coolFile.filename = file.name;
  //   reader.readAsBinaryString(file);
  // }

  // function toggleboxes() {
  //   if ($("#toggleboxescheckbox").prop('checked') == true) {
  //     console.log("show")
  //     var output = document.getElementById('imgoutput');
  //     var output2 = document.getElementById('imgoutput2');
  //     output2.style.display = "inline";
  //     output.style.display = "none";
  //   } else {
  //     console.log("hide")
  //     var output = document.getElementById('imgoutput');
  //     var output2 = document.getElementById('imgoutput2');
  //     output2.style.display = "none";
  //     output.style.display = "inline";
  //   }
  // }

  // function imageupdatebtn() {
  //   sendtoinitialimageprocess(imagefile)
  // }

  // // load last image used to train model
  // function loadlastimageusedtotrain() {
  //   $("#output").attr("src", "static/imagesusedfortraining/" + modelname + "/withoutboxes.jpg");
  //   $("#output2").attr("src", "static/imagesusedfortraining/" + modelname + "/withboxes.jpg");
  // }

  // function closecropper(){
  //   try {
  //     $("#btnCrop").css("display", "none");
  //     $("#btnCloseCropper").css("display", "none");
  //     $("#btnCreateModel").css("display", "inline");

  //     cropper.destroy();
  //     cropper1.destroy();
  //     cropper2.destroy();
  //     cropper3.destroy();
  //   } catch (error) {
  //     console.log(error);
  //   }
    
  // }

  setActiveMenuItem('#model-store-train-menu')
</script>
{% endblock %}